{"version":3,"sources":["webpack:///./node_modules/@vaadin/vaadin-checkbox/vaadin-checkbox.js","webpack:///./node_modules/@vaadin/vaadin-grid/theme/lumo/vaadin-grid-tree-toggle-styles.js","webpack:///./node_modules/@vaadin/vaadin-grid/src/vaadin-grid-tree-toggle.js","webpack:///./components/views/character/dnd-character-builder-equipment.js"],"names":["$_documentContainer","document","head","appendChild","content","createElement","innerHTML","level","type","Number","value","observer","leaf","Boolean","reflectToAttribute","expanded","notify","super","ready","this","addEventListener","e","_onClick","preventDefault","toString","style","_debouncerUpdateLevel","debounce","updateStyles","customElements","define","is","inventory","Array","isEditMode","character","Object","expandedItems","expandedIds","length","filter","item","map","uniqueId","console","error","openedItemID","$","grid","closeItemDetails","undefined","window","scrollTo","originalScrollHeight","scrollY","connectedCallback","characterChangeHandler","detail","updateFromCharacter","editModeHandler","setTimeout","notifyResize","disconnectedCallback","removeEventListener","draggedItem","rowDetailsRenderer","root","rowData","detailsOpened","firstElementChild","detailEl","unique","Date","now","querySelector","bind","draggedItems","dropMode","dropTargetItem","isChild","container","removeId","storedItem","itemCounter","dropLocation","children","push","dropTargetId","id","finalAddIndex","parseInt","substring","lastIndexOf","parentItemREF","splice","dataProvider","params","callback","startIndex","page","pageSize","parentItem","slice","clearCache","openedItem","openItemDetails","dispatchEvent","CustomEvent","bubbles","composed","data","model","__data","stayClosed","detailsOpenedItems","indexOf","checkboxEl","classList","add","remove","stopPropagation","itemModel","isEquipped","checkbox","target","_flashCheckbox","isAttuned","log","getEventContext","newQuantity","quantity","isNaN","bools","bool","rarity"],"mappings":"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","file":"11.bundle.js","sourcesContent":["import './theme/lumo/vaadin-checkbox.js';\nexport * from './src/vaadin-checkbox.js';\n","import '@vaadin/vaadin-lumo-styles/color.js';\nimport '@vaadin/vaadin-lumo-styles/spacing.js';\nimport { html } from '@polymer/polymer/lib/utils/html-tag.js';\n\nconst $_documentContainer = html`<dom-module id=\"lumo-grid-tree-toggle\" theme-for=\"vaadin-grid-tree-toggle\">\n  <template>\n    <style>\n      :host {\n        --vaadin-grid-tree-toggle-level-offset: 2em;\n        align-items: center;\n        vertical-align: middle;\n        margin-left: calc(var(--lumo-space-s) * -1);\n        -webkit-tap-highlight-color: transparent;\n      }\n\n      :host(:not([leaf])) {\n        cursor: default;\n      }\n\n      [part=\"toggle\"] {\n        display: inline-block;\n        font-size: 1.5em;\n        line-height: 1;\n        width: 1em;\n        height: 1em;\n        text-align: center;\n        color: var(--lumo-contrast-50pct);\n        /* Increase touch target area */\n        padding: calc(1em / 3);\n        margin: calc(1em / -3);\n      }\n\n      :host(:not([dir=\"rtl\"])) [part=\"toggle\"] {\n        margin-right: 0;\n      }\n\n      @media (hover: hover) {\n        :host(:hover) [part=\"toggle\"] {\n          color: var(--lumo-contrast-80pct);\n        }\n      }\n\n      [part=\"toggle\"]::before {\n        font-family: \"lumo-icons\";\n        display: inline-block;\n        height: 100%;\n      }\n\n      :host(:not([expanded])) [part=\"toggle\"]::before {\n        content: var(--lumo-icons-angle-right);\n      }\n\n      :host([expanded]) [part=\"toggle\"]::before {\n        content: var(--lumo-icons-angle-right);\n        transform: rotate(90deg);\n      }\n\n      /* Experimental support for hierarchy connectors, using an unsupported selector */\n      :host([theme~=\"connectors\"]) #level-spacer {\n        position: relative;\n        z-index: -1;\n        font-size: 1em;\n        height: 1.5em;\n      }\n\n      :host([theme~=\"connectors\"]) #level-spacer::before {\n        display: block;\n        content: \"\";\n        margin-top: calc(var(--lumo-space-m) * -1);\n        height: calc(var(--lumo-space-m) + 3em);\n        background-image: linear-gradient(to right, transparent calc(var(--vaadin-grid-tree-toggle-level-offset) - 1px), var(--lumo-contrast-10pct) calc(var(--vaadin-grid-tree-toggle-level-offset) - 1px));\n        background-size: var(--vaadin-grid-tree-toggle-level-offset) var(--vaadin-grid-tree-toggle-level-offset);\n        background-position: calc(var(--vaadin-grid-tree-toggle-level-offset) / 2 - 2px) 0;\n      }\n\n      /* RTL specific styles */\n\n      :host([dir=\"rtl\"]) {\n        margin-left: 0;\n        margin-right: calc(var(--lumo-space-s) * -1);\n      }\n\n      :host([dir=\"rtl\"]) [part=\"toggle\"] {\n        margin-left: 0;\n      }\n\n      :host([dir=\"rtl\"][expanded]) [part=\"toggle\"]::before {\n        transform: rotate(-90deg);\n      }\n\n      :host([dir=\"rtl\"][theme~=\"connectors\"]) #level-spacer::before {\n        background-image: linear-gradient(to left, transparent calc(var(--vaadin-grid-tree-toggle-level-offset) - 1px), var(--lumo-contrast-10pct) calc(var(--vaadin-grid-tree-toggle-level-offset) - 1px));\n        background-position: calc(100% - (var(--vaadin-grid-tree-toggle-level-offset) / 2 - 2px)) 0;\n      }\n\n      :host([dir=\"rtl\"]:not([expanded])) [part=\"toggle\"]::before,\n      :host([dir=\"rtl\"][expanded]) [part=\"toggle\"]::before {\n        content: var(--lumo-icons-angle-left);\n      }\n    </style>\n  </template>\n</dom-module>`;\n\ndocument.head.appendChild($_documentContainer.content);\n","/**\n@license\nCopyright (c) 2017 Vaadin Ltd.\nThis program is available under Apache License Version 2.0, available at https://vaadin.com/license/\n*/\nimport { PolymerElement } from '@polymer/polymer/polymer-element.js';\n\nimport '@polymer/polymer/lib/elements/custom-style.js';\nimport { Debouncer } from '@polymer/polymer/lib/utils/debounce.js';\nimport { ThemableMixin } from '@vaadin/vaadin-themable-mixin/vaadin-themable-mixin.js';\nimport { DirMixin } from '@vaadin/vaadin-element-mixin/vaadin-dir-mixin.js';\nimport { html } from '@polymer/polymer/lib/utils/html-tag.js';\nimport { microTask } from '@polymer/polymer/lib/utils/async.js';\nconst $_documentContainer = document.createElement('template');\n\n$_documentContainer.innerHTML = `<custom-style>\n  <style>\n    @font-face {\n      font-family: \"vaadin-grid-tree-icons\";\n      src: url(data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAAAQkAA0AAAAABrwAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABGRlRNAAAECAAAABoAAAAcgHwa6EdERUYAAAPsAAAAHAAAAB4AJwAOT1MvMgAAAZQAAAA/AAAAYA8TBIJjbWFwAAAB8AAAAFUAAAFeGJvXWmdhc3AAAAPkAAAACAAAAAgAAAAQZ2x5ZgAAAlwAAABLAAAAhIrPOhFoZWFkAAABMAAAACsAAAA2DsJI02hoZWEAAAFcAAAAHQAAACQHAgPHaG10eAAAAdQAAAAZAAAAHAxVAgBsb2NhAAACSAAAABIAAAASAIAAVG1heHAAAAF8AAAAGAAAACAACgAFbmFtZQAAAqgAAAECAAACTwflzbdwb3N0AAADrAAAADYAAABZQ7Ajh3icY2BkYGAA4twv3Vfi+W2+MnCzMIDANSOmbGSa2YEZRHEwMIEoAAoiB6sAeJxjYGRgYD7w/wADAwsDCDA7MDAyoAI2AFEEAtIAAAB4nGNgZGBg4GBgZgDRDAxMDGgAAAGbABB4nGNgZp7JOIGBlYGBaSbTGQYGhn4IzfiawZiRkwEVMAqgCTA4MDA+38d84P8BBgdmIAapQZJVYGAEAGc/C54AeJxjYYAAxlAIzQTELAwMBxgZGB0ACy0BYwAAAHicY2BgYGaAYBkGRgYQiADyGMF8FgYbIM3FwMHABISMDArP9/3/+/8/WJXC8z0Q9v8nEp5gHVwMMMAIMo+RDYiZoQJMQIKJARUA7WBhGN4AACFKDtoAAAAAAAAAAAgACAAQABgAJgA0AEIAAHichYvBEYBADAKBVHBjBT4swl9KS2k05o0XHd/yW1hAfBFwCv9sIlJu3nZaNS3PXAaXXHI8Lge7DlzF7C1RgXc7xkK6+gvcD2URmQB4nK2RQWoCMRiFX3RUqtCli65yADModOMBLLgQSqHddRFnQghIAnEUvEA3vUUP0LP0Fj1G+yb8R5iEhO9/ef/7FwFwj28o9EthiVp4hBlehcfUP4Ur8o/wBAv8CU+xVFvhOR7UB7tUdUdlVRJ6HnHWTnhM/V24In8JT5j/KzzFSi2E53hUz7jCcrcIiDDwyKSW1JEct2HdIPH1DFytbUM0PofWdNk5E5oUqb/Q6HHBiVGZpfOXkyUMEj5IyBuNmYZQjBobfsuassvnkKLe1OuBBj0VQ8cRni2xjLWsHaM0jrjx3peYA0/vrdmUYqe9iy7bzrX6eNP7Jh1SijX+AaUVbB8AAHicY2BiwA84GBgYmRiYGJkZmBlZGFkZ2djScyoLMgzZS/MyDQwMwLSruZMzlHaB0q4A76kLlwAAAAEAAf//AA94nGNgZGBg4AFiMSBmYmAEQnYgZgHzGAAD6wA2eJxjYGBgZACCKxJigiD6mhFTNowGACmcA/8AAA==) format('woff');\n      font-weight: normal;\n      font-style: normal;\n    }\n  </style>\n</custom-style>`;\n\ndocument.head.appendChild($_documentContainer.content);\n/**\n * `<vaadin-grid-tree-toggle>` is a helper element for the `<vaadin-grid>`\n * that provides toggle and level display functionality for the item tree.\n *\n * #### Example:\n * ```html\n * <vaadin-grid-column>\n *   <template class=\"header\">Package name</template>\n *   <template>\n *     <vaadin-grid-tree-toggle\n *         leaf=\"[[!item.hasChildren]]\"\n *         expanded=\"{{expanded}}\"\n *         level=\"[[level]]\">\n *       [[item.name]]\n *     </vaadin-grid-tree-toggle>\n *   </template>\n * </vaadin-grid-column>\n * ```\n *\n * ### Styling\n *\n * The following shadow DOM parts are available for styling:\n *\n * Part name | Description\n * ---|---\n * `toggle` | The tree toggle icon\n *\n * The following state attributes are available for styling:\n *\n * Attribute    | Description | Part name\n * ---|---|---\n * `expanded` | When present, the toggle is expanded | :host\n * `leaf` | When present, the toggle is not expandable, i. e., the current item is a leaf | :host\n *\n * The following custom CSS properties are available on\n * the `<vaadin-grid-tree-toggle>` element:\n *\n * Custom CSS property | Description | Default\n * ---|---|---\n * `--vaadin-grid-tree-toggle-level-offset` | Visual offset step for each tree sublevel | `1em`\n *\n * @extends PolymerElement\n * @mixes ThemableMixin\n */\nclass GridTreeToggleElement extends ThemableMixin(DirMixin(PolymerElement)) {\n  static get template() {\n    return html`\n    <style>\n      :host {\n        display: inline-flex;\n        align-items: baseline;\n\n        /* CSS API for :host */\n        --vaadin-grid-tree-toggle-level-offset: 1em;\n\n        /*\n          ShadyCSS seems to polyfill :dir(rtl) only for :host, thus using\n          a host custom CSS property for ltr/rtl toggle icon choice.\n         */\n        ---collapsed-icon: \"\\\\e7be\\\\00a0\";\n      }\n\n      :host(:dir(rtl)) {\n        ---collapsed-icon: \"\\\\e7bd\\\\00a0\";\n      }\n\n      :host([hidden]) {\n        display: none !important;\n      }\n\n      :host(:not([leaf])) {\n        cursor: pointer;\n      }\n\n      #level-spacer,\n      [part=\"toggle\"] {\n        flex: none;\n      }\n\n      #level-spacer {\n        display: inline-block;\n        width: calc(var(---level, '0') * var(--vaadin-grid-tree-toggle-level-offset));\n      }\n\n      [part=\"toggle\"]::before {\n        font-family: \"vaadin-grid-tree-icons\";\n        line-height: 1em; /* make icon font metrics not affect baseline */\n      }\n\n      :host(:not([expanded])) [part=\"toggle\"]::before {\n        content: var(---collapsed-icon);\n      }\n\n      :host([expanded]) [part=\"toggle\"]::before {\n        content: \"\\\\e7bc\\\\00a0\"; /* icon glyph + single non-breaking space */\n      }\n\n      :host([leaf]) [part=\"toggle\"] {\n        visibility: hidden;\n      }\n    </style>\n\n    <span id=\"level-spacer\"></span>\n    <span part=\"toggle\"></span>\n    <slot></slot>\n`;\n  }\n\n  static get is() {\n    return 'vaadin-grid-tree-toggle';\n  }\n\n  static get properties() {\n    return {\n      /**\n       * Current level of the tree represented with a horizontal offset\n       * of the toggle button.\n       */\n      level: {\n        type: Number,\n        value: 0,\n        observer: '_levelChanged'\n      },\n\n      /**\n       * Hides the toggle icon and disables toggling a tree sublevel.\n       */\n      leaf: {\n        type: Boolean,\n        value: false,\n        reflectToAttribute: true\n      },\n\n      /**\n       * Sublevel toggle state.\n       */\n      expanded: {\n        type: Boolean,\n        value: false,\n        reflectToAttribute: true,\n        notify: true\n      }\n    };\n  }\n\n  ready() {\n    super.ready();\n\n    this.addEventListener('click', e => this._onClick(e));\n  }\n\n  _onClick(e) {\n    if (this.leaf) {\n      return;\n    }\n\n    e.preventDefault();\n    this.expanded = !this.expanded;\n  }\n\n  _levelChanged(level) {\n    const value = Number(level).toString();\n    this.style['---level'] = value;\n    // Async is to make DOM updates applied before evaluating the style\n    // update, required for polyfilled RTL support in MSIE and Edge.\n    this._debouncerUpdateLevel = Debouncer.debounce(\n      this._debouncerUpdateLevel,\n      microTask,\n      () => this.updateStyles({'---level': value})\n    );\n  }\n}\n\ncustomElements.define(GridTreeToggleElement.is, GridTreeToggleElement);\n\nexport { GridTreeToggleElement };\n","import { PolymerElement, html } from \"@polymer/polymer\";\nimport { \n  getCharacterChannel,\n  getSelectedCharacter,\n  getItems,\n  removeItem,\n  canAttuneItem,\n  canEquipItem,\n  toggleItemEquipped,\n  toggleItemAttuned,\n  setItem,\n  spliceItems,\n  isChildItem,\n  getItemAtId,\n  addItem\n} from \"../../../util/charBuilder\";\nimport { getEditModeChannel, isEditMode } from \"../../../util/editMode\";\nimport \"@vaadin/vaadin-checkbox\";\nimport \"@vaadin/vaadin-grid\";\nimport \"@vaadin/vaadin-grid/vaadin-grid-tree-toggle\";\nimport \"@vaadin/vaadin-grid/vaadin-grid-column\";\nimport \"./dnd-character-builder-equipment-item-detail\";\n\n\n// TODO:\n// https://www.google.com/maps/place/7143+Billy+Goat+Dr,+New+Albany,+OH+43054/@40.1050273,-82.8250067,3a,18.1y,193.97h,87.13t/data=!3m7!1e1!3m5!1slpGo1R5kmFJTnA3yjtJYlQ!2e0!5s20151001T000000!7i13312!8i6656!4m7!3m6!1s0x88385e0b74c51a19:0x75954c845587a43b!8m2!3d40.1048551!4d-82.8250649!14m1!1BCgIgAQ\n// http://www.brosco.com/uploads/Price%20Pages%20and%20Forms/Doors/Larson1.pdf\n// Equipment choices from class\n// Parse equipment packs\n// Money counter\n// Ammunition / Potion / Other consumable counts\n// Magic Weapon modifier in entries\n// \nclass DndCharacterBuilderEquipment extends PolymerElement {\n  \n  static get properties() {\n    return {\n      inventory: {\n        type: Array\n      },\n      isEditMode: {\n        type: Boolean,\n        value: false\n      },\n      character: {\n        type: Object,\n      },\n      expandedItems: {\n        type: Array\n      },\n      expandedIds: {\n        type: Array\n      }\n    };\n  }\n\n  static get observers() {\n    return [\n      '_expandedItemsChange(expandedItems.*)'\n    ]\n  }\n\n  _expandedItemsChange() {\n    if (this.expandedItems && this.expandedItems.length) {\n      this.expandedIds = this.expandedItems.filter(item => !!item).map((item) => item.uniqueId);\n      console.error(this.expandedIds);\n\n      if (this.openedItemID) {\n        this.$.grid.closeItemDetails(this.openedItemID);\n        this.openedItemID = undefined;\n      }\n    }\n    window.scrollTo(0, this.originalScrollHeight);\n  }\n\n  _recordScrollHeight() {\n    // Fix reposition issue after tree expand/collapse toggle\n    this.originalScrollHeight = window.scrollY;\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n\n    this.characterChangeHandler = (e) => {\n      let character = e.detail.character;\n      this.updateFromCharacter(character);\n    };\n    \n    this.updateFromCharacter(getSelectedCharacter());\n    getCharacterChannel().addEventListener(\"character-selected\", this.characterChangeHandler);\n\n    this.editModeHandler = (e) => {\n      this.isEditMode = e.detail.isEditMode;\n      if (this.$.grid) {\n        setTimeout(() => {\n          this.$.grid.notifyResize();\n        }, 0);\n      }\n    }\n    getEditModeChannel().addEventListener('editModeChange', this.editModeHandler);\n    this.isEditMode = isEditMode();\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n\n    getCharacterChannel().removeEventListener(\"character-selected\", this.characterChangeHandler);\n    getEditModeChannel().removeEventListener('editModeChange', this.editModeHandler);\n  }\n\n  ready() {\n    super.ready();\n    \n    setTimeout(() => {\n      const grid = this.$.grid;\n\n      // Define Row Details\n      grid.rowDetailsRenderer = ((root, grid, rowData) => {\n        if (rowData.detailsOpened) {\n          if (!root.firstElementChild) {\n            root.innerHTML = '<div class=\"details\" id=\"stats\"></div>';\n          }\n          if (!this.detailEl) {\n            this.detailEl = document.createElement('dnd-character-builder-equipment-item-detail');\n            this.detailEl.unique = Date.now();\n          }\n          root.querySelector('.details').appendChild(this.detailEl);\n          this.detailEl.item = rowData.item;\n        }\n      }).bind(this);\n\n      // Add Drag and Drop\n      let draggedItem;\n\n      grid.addEventListener('grid-dragstart', function(e) {\n        draggedItem = e.detail.draggedItems[0];\n        grid.dropMode = 'on-top-or-between';\n      });\n\n      grid.addEventListener('grid-dragend', function(e) {\n        draggedItem = grid.dropMode = null;\n      });\n\n      grid.addEventListener('grid-drop', (e) => {\n        const dropTargetItem = e.detail.dropTargetItem;\n        if (draggedItem && draggedItem !== dropTargetItem) {\n\n          // Prevent loops\n          const isChild = isChildItem(draggedItem, dropTargetItem.uniqueId);\n          if (draggedItem.container && isChild) {\n            return;\n          }\n\n          const removeId = draggedItem.storedItem.uniqueId;\n          draggedItem.storedItem.uniqueId = this.character.itemCounter ++;\n\n          // Dropping into container\n          if (e.detail.dropLocation === 'on-top') {\n            if (dropTargetItem.container) {\n              if (dropTargetItem.storedItem && dropTargetItem.storedItem.children) {\n                // Add child item\n                dropTargetItem.storedItem.children.push(draggedItem.storedItem);\n                setItem(dropTargetItem, undefined, true);\n                // Remove original\n                removeItem(removeId);\n              }\n              return;\n            }\n          }\n\n          // Re-ordering items, default action if 'on-top' of non-container\n          if (this.inventory) {\n            // Adjust final add index for dropLocation 'below' or 'above'\n            const dropTargetId = `${dropTargetItem.id}`;\n            let finalAddIndex = parseInt(dropTargetId.substring(dropTargetId.lastIndexOf('_')), 10);\n            if (e.detail.dropLocation === 'below') {\n              finalAddIndex++;\n            }\n\n            if (dropTargetItem.parentItemREF) {\n              // Add child item\n              dropTargetItem.parentItemREF.storedItem.children.splice(finalAddIndex, 0, draggedItem.storedItem);\n              setItem(dropTargetItem.parentItemREF, undefined, true);\n            } else {\n              // Add top-level item\n              spliceItems(finalAddIndex, draggedItem.storedItem);\n            }\n\n            // Remove original item\n            removeItem(removeId);\n          }\n        }\n      });\n\n      // Set Data Provider\n      grid.dataProvider = ((params, callback) => {\n        const startIndex = params.page * params.pageSize;\n        let children = params.parentItem ? params.parentItem.children : this.inventory;\n        if (children && children.length) {\n          const page = children.slice(startIndex, startIndex + params.pageSize);\n          callback(page, children.length);\n        }\n      }).bind(this);\n    }, 0);\n    \n  }\n\n  async updateFromCharacter(character) {\n    if (character) {\n      this.character = character;\n      this.inventory = await getItems(character);\n      console.error('inventory:', this.inventory);\n      const originalScrollHeight = window.scrollY;\n      this.$.grid.clearCache();\n      if (this.openedItemID) {\n        const openedItem = getItemAtId(this.inventory, this.openedItemID.uniqueId);\n        if (openedItem) {\n          this.$.grid.openItemDetails(openedItem);\n        }\n      }\n      if (this.expandedIds) {\n        const expandedItems = this.expandedIds.map((id) => {\n          return getItemAtId(this.inventory, id);\n        });\n        this.expandedItems = expandedItems;\n      }\n      window.scrollTo(0, originalScrollHeight);\n      this.dispatchEvent(new CustomEvent(\"loadingChange\", { bubbles: true, composed: true }));\n    }\n  }\n\n  _expandDetails(e) {\n    let data = e.model.__data.item,\n      stayClosed = this.$.grid.detailsOpenedItems.indexOf(data) > -1;\n\n    const originalScrollHeight = window.scrollY;\n\n    for (let item of this.$.grid.detailsOpenedItems) {\n      this.$.grid.closeItemDetails(item);\n    }\n\n    if (stayClosed) {\n      this.$.grid.closeItemDetails(data);\n      this.openedItemID = undefined;\n    } else {\n      this.$.grid.openItemDetails(data);\n      this.openedItemID = data;\n    }\n    this.$.grid.notifyResize();\n    window.scrollTo(0, originalScrollHeight);\n  }\n\n  _flashCheckbox(checkboxEl) {\n    if (checkboxEl) {\n      checkboxEl.classList.add('transition-bg');\n      checkboxEl.classList.add('flash-error');\n      setTimeout(() => {\n        checkboxEl.classList.remove('flash-error');\n        setTimeout(() => {\n          checkboxEl.classList.remove('transition-bg');\n        }, 200);\n      }, 200);\n    }\n  }\n\n  _deleteItem(e) {\n    let uniqueId = e.model.__data.item && e.model.__data.item.uniqueId !== undefined ? e.model.__data.item.uniqueId : undefined;\n    removeItem(uniqueId);\n  }\n\n  async _setItemEquipped(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    let itemModel = e.model.__data.item;\n    let uniqueId = itemModel ? itemModel.uniqueId : undefined;\n    let isEquipped = itemModel ? itemModel.isEquipped : false;\n    \n    if (isEquipped) {\n      toggleItemEquipped(uniqueId);\n    } else if (await canEquipItem(itemModel)) {\n      toggleItemEquipped(uniqueId);\n    } else {\n      let checkbox = e.target.querySelector('vaadin-checkbox')\n      this._flashCheckbox(checkbox)\n    }\n  }\n\n  async _setItemAttuned(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    let itemModel = e.model.__data.item;\n    let uniqueId = itemModel ? itemModel.uniqueId : undefined;\n    let isAttuned = itemModel ? itemModel.isAttuned : false;\n\n    if (isAttuned) {\n      toggleItemAttuned(uniqueId);\n    } else if (await canAttuneItem(itemModel)) {\n      toggleItemAttuned(uniqueId);\n    } else {\n      let checkbox = e.target.querySelector('vaadin-checkbox')\n      this._flashCheckbox(checkbox)\n    }\n  }\n\n  _quantityChange(e) {\n    console.log(e);\n    const item = this.$.grid.getEventContext(e).item;\n    let newQuantity = parseInt(item.quantity, 10);\n    if (isNaN(newQuantity)) {\n      newQuantity = 0;\n    }\n\n    item.storedItem.quantity = newQuantity;\n    setItem(item);\n  }\n\n  _addItem() {\n    addItem({}, false);\n  }\n\n  _preventDefault(e) {\n    e.preventDefault();\n    e.stopPropagation();\n  }\n\n  _or(...bools) {\n    for (let bool of bools) {\n      if (bool) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  _noRarity(rarity) {\n    return !rarity || rarity === 'None';\n  }\n\n  _toggleTheme(item) {\n    return item.children && item.children.length === 0 ? 'no-children' : '';\n  }\n\n  static get template() {\n    return html`\n      <style include=\"material-styles\"></style>\n      <style>\n        :host {\n          display: block;\n          padding: 14px;\n        }\n        [hidden] {\n          display: none !important;\n        }\n        a {\n          color: var(--mdc-theme-secondary);\n        }\n\n        vaadin-grid {\n          margin-bottom: 200px;\n        }\n\n        .heading {\n          display: flex;\n          flex-direction: row;\n          align-items: center;\n          justify-content: space-between;\n        }\n        .reference-link:hover {\n          color: var(--mdc-theme-secondary);\n        }\n\n        .col-wrap {\n          display: flex; \n          justify-content: space-between;\n          flex-wrap: wrap;\n        }\n\n        .row-wrap {\n          width: 100%;\n        }\n        .row-wrap:not(:last-child) {\n          margin-bottom: 24px;\n        }\n\n        .row-wrap > *:not(h2):not(:last-child) {\n          margin-bottom: 10px;\n        }\n\n        .no-content {\n          font-size: 14px;\n          font-style: italic;\n        }\n\n        .item-wrap {\n          display: flex;\n          flex-wrap: nowrap;\n          flex-direction: row;\n          justify-content: space-between;\n          align-items: flex-start;\n          padding: 10px 6px;\n          min-height: 28px;\n          border-bottom: 1px solid var(--_lumo-grid-secondary-border-color);\n        }\n        .item-wrap__name-wrap {\n          flex-basis: 100%;\n          min-width: 0;\n          display: flex;\n          flex-direction: column;\n          cursor: pointer;\n        }\n        .item-wrap__name-wrap:hover {\n          color: var(--mdc-theme-secondary);\n        }\n        .item-wrap__name {\n          font-weight: bold;\n          overflow: hidden;\n          text-overflow: ellipsis;\n          white-space: nowrap;\n          position: relative;\n        }\n        .item-wrap__edited,\n        .item-wrap__from {\n          background-color: var(--mdc-theme-text-disabled-on-background);\n          color: var(--mdc-theme-on-secondary);\n          border: none;\n          border-radius: 4px;\n          outline: none;\n          display: inline-block;\n          justify-content: center;\n          white-space: normal;\n          font-size: 10px;\n          padding: 1px 4px;\n          margin-right: 4px;\n          font-style: italic;\n        }\n        .item-wrap__edited {\n          top: -1px;\n          position: relative;\n          font-weight: normal;\n        }\n        .item-wrap__type {\n          font-style: italic;\n          font-size: 12px;\n          overflow: hidden;\n          text-overflow: ellipsis;\n          white-space: nowrap;\n          position: relative;\n        }\n        .item-wrap__type--fromBackground {\n          padding-right: 38px;\n        }\n        .item-wrap__type--fromClass {\n          padding-right: 50px;\n        }\n        .item-wrap__close {\n          font-size: 14px;\n          margin-top: 6px;\n          cursor: pointer;\n        }\n        .item-wrap__checkboxes {\n          display: flex;\n          flex-direction: column;\n          width: 80px;\n          flex-grow: 0;\n          flex-shrink: 0;\n          margin-left: auto;\n        }\n        .item-wrap__checkboxes > span {\n          cursor: pointer;\n        }\n        .item-wrap__quantity {\n          display: flex;\n          flex-direction: column;\n          width: 80px;\n          flex-grow: 0;\n          flex-shrink: 0;\n          margin-left: auto;\n        }\n        vaadin-integer-field {\n          margin: -13px 0 8px;\n        }\n        vaadin-checkbox {\n          pointer-events: none;\n          font-size: 13px;\n        }\n        vaadin-checkbox.flash-error {\n          color: var(--mdc-theme-error);\n          transition: color 0.2s ease-out;\n          --lumo-contrast-20pct: var(--mdc-theme-error);\n        }\n        vaadin-checkbox.transition-bg {\n          transition: color 0.2s ease-in;\n        }\n\n        .details {\n          font-size: 14px;\n          width: calc(100% - 30px);\n          margin: 0 auto 13px !important;\n          background: var(--lumo-contrast-10pct);\n          border-radius: 4px;\n          padding: 14px;\n        }\n        #stats {\n          margin-top: 24px;\n          font-size: 12px;\n        }\n        #stats p {\n          margin-top: 4px;\n          margin-bottom: 16px;\n        }\n        #stats .table {\n          margin-bottom: 24px;\n          border-radius: 4px;\n          box-shadow: 0 0 0 1px var(--mdc-theme-text-divider-on-background);\n        }\n        #stats .subclass-feature .stat-name {\n          color: var(--mdc-theme-primary, '#6200ee');\n        }\n        #stats .statsBlockHead .stat-name {\n          display: block;\n          font-size: 1.6rem;\n          font-weight: normal;\n          line-height: 1.2;\n        }\n        #stats .statsBlockSubHead .stat-name {\n          font-size: 1.2rem;\n          font-weight: normal;\n        }\n        #stats .statsInlineHead {\n          margin-bottom: 16px;\n        }\n        #stats .statsInlineHead .stat-name {\n          font-size: .8rem;\n          font-weight: bold;\n          display: inline;\n        }\n        #stats .statsInlineHead .stat-name + p {\n          display: inline;\n        }\n        #stats .spell-ability {\n          margin: 0 24px;\n          display: block;\n        }\n        #stats .subclass-feature,\n        #stats .class-feature {\n          padding-top: 24px;\n          border-top: 1px solid var(--mdc-theme-text-divider-on-background, 'rgba(0, 0, 0, 0.12)');\n        }\n        #stats a {\n          color: var(--mdc-theme-secondary, '#018786') !important;\n        }\n        #stats ul {\n          padding-left: 24px;\n          list-style: disc;\n        }\n        #stats ul li {\n          margin-bottom: 8px;\n        }\n\n        @media(min-width: 420px) {\n          .heading {\n            justify-content: flex-start;\n          }\n          .reference-link {\n            margin-left: 8px;\n          }\n        }\n\n        @media(min-width: 921px) {\n          .row-wrap {\n            width: calc(50% - 10px);\n          }\n          .row-wrap:first-child {\n            margin-bottom: 0;\n          }\n        }\n      </style>\n\n      <div class=\"col-wrap\">\n\n        <div class=\"row-wrap\">\n          <div class=\"heading\">\n            <h2>Inventory</h2>\n            <a class=\"reference-link mdc-icon-button material-icons\" href=\"#/items\">launch</a>\n          </div>\n          <vaadin-grid id=\"grid\" expanded-items=\"{{expandedItems}}\" height-by-rows rows-draggable theme=\"no-border no-row-borders no-row-padding\" >\n            <vaadin-grid-column>\n              <template>\n                <div class=\"item-wrap\">\n                  <vaadin-grid-tree-toggle level$=[[level]] leaf=\"[[!item.container]]\" expanded=\"{{expanded}}\" theme$=[[_toggleTheme(item)]] on-click='_recordScrollHeight'></vaadin-grid-tree-toggle>\n                  <div class=\"item-wrap__name-wrap\" on-click=\"_expandDetails\">\n                    <span class=\"item-wrap__name\">[[item.name]]\n                      <span hidden$=\"[[!item.isEdited]]\" class=\"item-wrap__edited\">Edited</span>\n                    </span>\n                    <span class=\"item-wrap__type\">\n                      <span class=\"item-wrap__from\" hidden$=\"[[!item.fromBackground]]\">BG</span>\n                      <span class=\"item-wrap__from\" hidden$=\"[[!item.fromClass]]\">Class</span>\n                      <span>[[item.typeText]]<span hidden$=\"[[_noRarity(item.rarity)]]\">, [[item.rarity]]</span></span>\n                    </span>\n                  </div>\n                  <div hidden$=\"[[item.hasQuantity]]\" class=\"item-wrap__checkboxes\">\n                    <span on-click=\"_setItemEquipped\">\n                      <vaadin-checkbox checked=\"[[item.isEquipped]]\" hidden$=\"[[!item.canEquip]]\">Equip</vaadin-checkbox>\n                    </span>\n                    <span on-click=\"_setItemAttuned\">\n                      <vaadin-checkbox checked=\"[[item.isAttuned]]\" hidden$=\"[[!item.reqAttune]]\">Attune</vaadin-checkbox>\n                    </span>\n                  </div>\n                  <div hidden$=\"[[!item.hasQuantity]]\" class=\"item-wrap__quantity\">\n                    <vaadin-integer-field min=\"0\" value=\"{{item.quantity}}\" theme=\"mini\" has-controls on-change=\"_quantityChange\"></vaadin-integer-field>\n                  </div>\n                  <div class=\"mdc-buttom-icon material-icons item-wrap__close\" on-click=\"_deleteItem\">close</div>\n                </div>\n              </template>\n            </vaadin-grid-column>\n          </vaadin-grid>\n        </div>\n      </div>\n    `;\n  }\n}\n\ncustomElements.define(\"dnd-character-builder-equipment\", DndCharacterBuilderEquipment);"],"sourceRoot":""}