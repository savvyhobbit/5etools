{"version":3,"sources":["webpack:///./node_modules/@vaadin/vaadin-text-field/theme/lumo/vaadin-number-field-styles.js","webpack:///./node_modules/@vaadin/vaadin-text-field/src/vaadin-number-field.js","webpack:///./node_modules/@vaadin/vaadin-text-field/src/vaadin-integer-field.js","webpack:///./components/dnd-asi-select.js","webpack:///./data/choices.js","webpack:///./components/views/character/dnd-character-builder-class.js"],"names":["$_documentContainer","document","head","appendChild","content","createElement","memoizedTemplate","innerHTML","hasControls","type","Boolean","value","reflectToAttribute","min","Number","observer","max","step","super","ready","this","__previousValidInput","inputElement","addEventListener","__onInputChange","bind","e","preventDefault","_decreaseValue","_increaseValue","template","cloneNode","thisTemplate","import","is","decreaseButton","querySelector","increaseButton","styles","inputField","prefixSlot","insertBefore","_createMethodObserver","required","minlength","maxlength","pattern","invalid","isNumUnset","n","_constraintsChanged","validate","_incrementValue","incr","disabled","readonly","parseFloat","_getIncrement","newValue","_incrementIsInsideTheLimits","_setValue","String","dispatchEvent","CustomEvent","bubbles","currentValue","multiplier","Math","_getMultiplier","margin","round","number","s","i","indexOf","length","isNaN","pow","_getDecimalCount","sign","__validateByStep","__stepChangedCalled","getAttribute","setAttribute","newVal","oldVal","_valueChanged","keyCode","_onKeyDown","undefined","checkValidity","window","customElements","define","preventInvalidInput","_enabledCharPattern","__isInteger","console","warn","__hasOnlyDigits","_stepChanged","test","levelIndex","checked","selectedFeat","Object","selectedAbility1","selectedAbility2","featHasAttributeChoice","featAttributeSelection","featAttributeOptions","Array","attributeOptions","connectedCallback","switchChangeHandler","detail","_genASICallback","characterChangeHandler","character","updateFromCharacter","disconnectedCallback","removeEventListener","asi","index","feat","ability1","ability2","isFeat","name","source","featId","featRef","ability","choose","from","map","toUpperCase","featAttributeSelections","asiIndex","keyForChange","linkData","push","dataLink","composed","selectedItem","viewId","classOptionsMap","class","2","count","options","5","10","15","20","4","7","11","19","artificer","6","14","18","barbarian","subclasses","3","bard","fighter","1","paladin","ranger","sorcerer","17","warlock","9","12","levels","classes","noContentMessage","isEditMode","editModeHandler","$","classGrid","notifyResize","renderer","setTimeout","grid","draggedItem","rowDetailsRenderer","root","rowData","renderStack","features","_getClassLevelFeatures","firstElementChild","feature","recursiveEntryRender","deets","join","draggedItems","dropMode","dropTargetItem","items","filter","dropIndex","dropLocation","splice","JSON","parse","stringify","classLevel","classChoices","_findLevelChoices","hitDiceMaxes","clearCache","className","classRef","classFeatures","levelsInClass","levelsInSubclass","classFeaturesForLevel","find","gainSubclassFeature","some","subclassDef","subclassFeatures","isSubclass","concat","classLevelFeatures","f","model","__data","previousFirstClassId","id","data","item","stayClosed","detailsOpenedItems","closeItemDetails","openItemDetails","levelChoices","_findChoices","classDef","choices","classLevelCount","subclassChoiceLevel","suboptions","skillProficiencies","startingProficiencies","skills","armor","armorProficiencies","forEach","p","prof","proficiency","toLowerCase","includes","weapons","weaponProficiencies","split","trim","tools","toolProficiencies","selections","choice","selection","level","featurei","isClassFeatureVariant","entries","error","classOptions","classLevelOptions","classLevelOption","subclassLevelOptions","subclassLevelOption","subclass","a","b","classs","adjChoice","isArray","c","innerWidth","obj","values","replace","element","target","closest","isOpen","classList","contains","intField","parseInt","dataset","changeVal","toggle","add","remove","focus","maxes"],"mappings":"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","file":"8.bundle.js","sourcesContent":["import '@vaadin/vaadin-lumo-styles/font-icons.js';\nimport '@vaadin/vaadin-lumo-styles/sizing.js';\nimport '@vaadin/vaadin-lumo-styles/mixins/field-button.js';\nimport { html } from '@polymer/polymer/lib/utils/html-tag.js';\n\nconst $_documentContainer = html`<dom-module id=\"lumo-number-field\" theme-for=\"vaadin-number-field\">\n  <template>\n    <style include=\"lumo-field-button\">\n      :host {\n        width: 8em;\n      }\n\n      :host([has-controls]:not([theme~=\"align-right\"])) [part=\"value\"] {\n        text-align: center;\n      }\n\n      [part=\"decrease-button\"][disabled],\n      [part=\"increase-button\"][disabled] {\n        opacity: 0.2;\n      }\n\n      :host([has-controls]) [part=\"input-field\"] {\n        padding: 0;\n      }\n\n      [part=\"decrease-button\"],\n      [part=\"increase-button\"] {\n        cursor: pointer;\n        font-size: var(--lumo-icon-size-s);\n        width: 1.6em;\n        height: 1.6em;\n      }\n\n      [part=\"decrease-button\"]::before,\n      [part=\"increase-button\"]::before {\n        margin-top: 0.2em;\n      }\n\n      /* RTL specific styles */\n\n      :host([dir=\"rtl\"]) [part=\"value\"],\n      :host([dir=\"rtl\"]) [part=\"input-field\"] ::slotted(input) {\n        --_lumo-text-field-overflow-mask-image: linear-gradient(to left, transparent, #000 1.25em);\n      }\n    </style>\n  </template>\n</dom-module>`;\n\ndocument.head.appendChild($_documentContainer.content);\n","/**\n@license\nCopyright (c) 2017 Vaadin Ltd.\nThis program is available under Apache License Version 2.0, available at https://vaadin.com/license/\n*/\nimport '@polymer/polymer/polymer-element.js';\n\nimport '@polymer/polymer/lib/elements/custom-style.js';\nimport { TextFieldElement } from './vaadin-text-field.js';\nimport { DomModule } from '@polymer/polymer/lib/elements/dom-module.js';\nconst $_documentContainer = document.createElement('template');\n\n$_documentContainer.innerHTML = `<dom-module id=\"vaadin-number-field-template\">\n  <template>\n    <style>\n      :host([readonly]) [part\\$=\"button\"] {\n        pointer-events: none;\n      }\n\n      [part=\"decrease-button\"]::before {\n        content: \"âˆ’\";\n      }\n\n      [part=\"increase-button\"]::before {\n        content: \"+\";\n      }\n\n      [part=\"decrease-button\"],\n      [part=\"increase-button\"] {\n        -webkit-user-select: none;\n        -moz-user-select: none;\n        -ms-user-select: none;\n        user-select: none;\n      }\n\n      /* Hide the native arrow icons */\n      [part=\"value\"]::-webkit-outer-spin-button,\n      [part=\"value\"]::-webkit-inner-spin-button {\n        -webkit-appearance: none;\n        margin: 0;\n      }\n\n      [part=\"value\"] {\n        /* Older Firefox versions (v47.0) requires !important */\n        -moz-appearance: textfield !important;\n      }\n\n      :host([dir=\"rtl\"]) [part=\"input-field\"] {\n        direction: ltr;\n      }\n\n      :host([dir=\"rtl\"]) [part=\"value\"]::placeholder {\n        direction: rtl;\n      }\n\n      :host([dir=\"rtl\"]) [part=\"input-field\"] ::slotted(input)::placeholder {\n        direction: rtl;\n      }\n\n      :host([dir=\"rtl\"]) [part=\"value\"]:-ms-input-placeholder,\n      :host([dir=\"rtl\"]) [part=\"input-field\"] ::slotted(input):-ms-input-placeholder {\n        direction: rtl;\n      }\n\n      :host([dir=\"rtl\"]:not([has-controls])) [part=\"value\"]::placeholder {\n        text-align: left;\n      }\n\n      :host([dir=\"rtl\"]:not([has-controls])) [part=\"input-field\"] ::slotted(input)::placeholder {\n        text-align: left;\n      }\n\n      :host([dir=\"rtl\"]:not([has-controls])) [part=\"value\"]:-ms-input-placeholder,\n      :host([dir=\"rtl\"]:not([has-controls])) [part=\"input-field\"] ::slotted(input):-ms-input-placeholder {\n        text-align: left;\n      }\n    </style>\n\n    <div disabled\\$=\"[[!_allowed(-1, value, min, max, step)]]\" part=\"decrease-button\" on-click=\"_decreaseValue\" on-touchend=\"_decreaseButtonTouchend\" hidden\\$=\"[[!hasControls]]\">\n    </div>\n\n    <div disabled\\$=\"[[!_allowed(1, value, min, max, step)]]\" part=\"increase-button\" on-click=\"_increaseValue\" on-touchend=\"_increaseButtonTouchend\" hidden\\$=\"[[!hasControls]]\">\n    </div>\n  </template>\n\n  \n</dom-module>`;\n\ndocument.head.appendChild($_documentContainer.content);\nlet memoizedTemplate;\n\n/**\n* `<vaadin-number-field>` is a Web Component for number field control in forms.\n*\n* ```html\n* <vaadin-number-field label=\"Number\">\n* </vaadin-number-field>\n* ```\n*\n* @extends PolymerElement\n* @demo demo/index.html\n*/\nclass NumberFieldElement extends TextFieldElement {\n  static get is() {\n    return 'vaadin-number-field';\n  }\n\n  static get version() {\n    return '2.6.2';\n  }\n\n  static get properties() {\n    return {\n      /**\n      * Set to true to display value increase/decrease controls.\n      */\n      hasControls: {\n        type: Boolean,\n        value: false,\n        reflectToAttribute: true\n      },\n\n      /**\n      * The minimum value of the field.\n      */\n      min: {\n        type: Number,\n        reflectToAttribute: true,\n        observer: '_minChanged'\n      },\n\n      /**\n       * The maximum value of the field.\n       */\n      max: {\n        type: Number,\n        reflectToAttribute: true,\n        observer: '_maxChanged'\n      },\n\n      /**\n       * Specifies the allowed number intervals of the field.\n       */\n      step: {\n        type: Number,\n        value: 1,\n        observer: '_stepChanged'\n      }\n\n    };\n  }\n\n  ready() {\n    super.ready();\n    this.__previousValidInput = this.value || '';\n    this.inputElement.type = 'number';\n    this.inputElement.addEventListener('change', this.__onInputChange.bind(this));\n  }\n\n  _decreaseButtonTouchend(e) {\n    // Cancel the following click and focus events\n    e.preventDefault();\n    this._decreaseValue();\n  }\n\n  _increaseButtonTouchend(e) {\n    // Cancel the following click and focus events\n    e.preventDefault();\n    this._increaseValue();\n  }\n\n  static get template() {\n    if (!memoizedTemplate) {\n      // Clone the superclass template\n      memoizedTemplate = super.template.cloneNode(true);\n\n      // Retrieve this element's dom-module template\n      const thisTemplate = DomModule.import(this.is + '-template', 'template');\n      const decreaseButton = thisTemplate.content.querySelector('[part=\"decrease-button\"]');\n      const increaseButton = thisTemplate.content.querySelector('[part=\"increase-button\"]');\n      const styles = thisTemplate.content.querySelector('style');\n\n      // Add the buttons and styles to the text-field template\n      const inputField = memoizedTemplate.content.querySelector('[part=\"input-field\"]');\n      const prefixSlot = memoizedTemplate.content.querySelector('[name=\"prefix\"]');\n      inputField.insertBefore(decreaseButton, prefixSlot);\n      inputField.appendChild(increaseButton);\n      memoizedTemplate.content.appendChild(styles);\n    }\n\n    return memoizedTemplate;\n  }\n\n  _createConstraintsObserver() {\n    // NOTE: do not call \"super\" but instead override the method to add extra arguments\n    this._createMethodObserver('_constraintsChanged(required, minlength, maxlength, pattern, min, max, step)');\n  }\n\n  _constraintsChanged(required, minlength, maxlength, pattern, min, max, step) {\n    if (!this.invalid) {\n      return;\n    }\n\n    const isNumUnset = n => (!n && n !== 0);\n\n    if (!isNumUnset(min) || !isNumUnset(max)) {\n      this.validate();\n    } else {\n      super._constraintsChanged(required, minlength, maxlength, pattern);\n    }\n  }\n\n  _decreaseValue() {\n    this._incrementValue(-1);\n  }\n\n  _increaseValue() {\n    this._incrementValue(1);\n  }\n\n  _incrementValue(incr) {\n    if (this.disabled || this.readonly) {\n      return;\n    }\n\n    let value = parseFloat(this.value);\n\n    if (!this.value) {\n      if (this.min == 0 && incr < 0 ||\n          this.max == 0 && incr > 0 ||\n          this.max == 0 && this.min == 0) {\n        incr = 0;\n        value = 0;\n      } else if ((this.max == null || this.max >= 0) &&\n                 (this.min == null || this.min <= 0)) {\n        value = 0;\n      } else if (this.min > 0) {\n        value = this.min;\n        if (this.max < 0 && incr < 0) {\n          value = this.max;\n        }\n        incr = 0;\n      } else if (this.max < 0) {\n        value = this.max;\n        if (incr < 0) {\n          incr = 0;\n        } else {\n          // FIXME(yuriy): find a proper solution to make correct step back\n          if (this._getIncrement(1, value - this.step) > this.max) {\n            value -= 2 * this.step;\n          } else {\n            value -= this.step;\n          }\n        }\n      }\n    } else if (value < this.min) {\n      incr = 0;\n      value = this.min;\n    } else if (value > this.max) {\n      incr = 0;\n      value = this.max;\n    }\n\n    const newValue = this._getIncrement(incr, value);\n    if (!this.value || incr == 0 || this._incrementIsInsideTheLimits(incr, value)) {\n      this._setValue(newValue);\n    }\n  }\n\n  _setValue(value) {\n    this.value = this.inputElement.value = String(parseFloat(value));\n    this.dispatchEvent(new CustomEvent('change', {bubbles: true}));\n  }\n\n  _getIncrement(incr, currentValue) {\n    let step = this.step || 1,\n      min = this.min || 0;\n\n    // To avoid problems with decimal math, multiplying to operate with integers.\n    const multiplier = Math.max(this._getMultiplier(currentValue),\n      this._getMultiplier(step),\n      this._getMultiplier(min));\n\n    step *= multiplier;\n    currentValue = Math.round(currentValue * multiplier);\n    min *= multiplier;\n\n    const margin = (currentValue - min) % step;\n\n    if (incr > 0) {\n      return (currentValue - margin + step) / multiplier;\n    } else if (incr < 0) {\n      return (currentValue - (margin || step)) / multiplier;\n    } else {\n      return currentValue / multiplier;\n    }\n  }\n\n  _getDecimalCount(number) {\n    const s = String(number);\n    const i = s.indexOf('.');\n    return i === -1 ? 1 : s.length - i - 1;\n  }\n\n  _getMultiplier(number) {\n    if (!isNaN(number)) {\n      return Math.pow(10, this._getDecimalCount(number));\n    }\n  }\n\n  _incrementIsInsideTheLimits(incr, value) {\n    if (incr < 0) {\n      return this.min == null || this._getIncrement(incr, value) >= this.min;\n    } else if (incr > 0) {\n      return this.max == null || this._getIncrement(incr, value) <= this.max;\n    } else {\n      return this._getIncrement(incr, value) <= this.max && this._getIncrement(incr, value) >= this.min;\n    }\n  }\n\n  _allowed(sign) {\n    const incr = sign * (this.step || 1);\n    const value = parseFloat(this.value);\n    return !this.value || (!this.disabled && this._incrementIsInsideTheLimits(incr, value));\n  }\n\n  _stepChanged(step) {\n    // Avoid using initial value in validation\n    this.__validateByStep = this.__stepChangedCalled || this.getAttribute('step') !== null;\n    this.inputElement.step = this.__validateByStep ? step : 'any';\n\n    this.__stepChangedCalled = true;\n    this.setAttribute('step', step);\n  }\n\n  _minChanged(min) {\n    this.inputElement.min = min;\n  }\n\n  _maxChanged(max) {\n    this.inputElement.max = max;\n  }\n\n  _valueChanged(newVal, oldVal) {\n    // Validate value to be numeric\n    if (newVal && isNaN(parseFloat(newVal))) {\n      this.value = '';\n    } else if (typeof this.value !== 'string') {\n      this.value = String(this.value);\n    }\n\n    super._valueChanged(this.value, oldVal);\n  }\n\n  _onKeyDown(e) {\n    if (e.keyCode == 38) {\n      e.preventDefault();\n      this._increaseValue();\n    } else if (e.keyCode == 40) {\n      e.preventDefault();\n      this._decreaseValue();\n    }\n    super._onKeyDown(e);\n  }\n\n  __onInputChange() {\n    this.validate();\n  }\n\n  checkValidity() {\n    // text-field mixin does not check against `min`, `max` and `step`\n    if (this.min !== undefined || this.max !== undefined || this.__validateByStep) {\n      return this.inputElement.checkValidity();\n    }\n\n    return super.checkValidity();\n  }\n}\n\nwindow.customElements.define(NumberFieldElement.is, NumberFieldElement);\n\nexport { NumberFieldElement };\n","/**\n@license\nCopyright (c) 2019 Vaadin Ltd.\nThis program is available under Apache License Version 2.0, available at https://vaadin.com/license/\n*/\nimport '@polymer/polymer/polymer-element.js';\n\nimport '@polymer/polymer/lib/elements/custom-style.js';\nimport { NumberFieldElement } from './vaadin-number-field.js';\nconst $_documentContainer = document.createElement('template');\n\n$_documentContainer.innerHTML = `<dom-module id=\"vaadin-integer-field-template\">\n\n  \n</dom-module>`;\n\ndocument.head.appendChild($_documentContainer.content);\n\n/**\n* `<vaadin-integer-field>` is a Web Component for integer field control in forms.\n*\n* ```html\n* <vaadin-integer-field label=\"Number\">\n* </vaadin-integer-field>\n* ```\n*\n* @extends PolymerElement\n* @demo demo/index.html\n*/\nclass IntegerFieldElement extends NumberFieldElement {\n  static get is() {\n    return 'vaadin-integer-field';\n  }\n\n  static get version() {\n    return '2.6.2';\n  }\n\n  static get properties() {\n    // Hide inherited props that don't work with <input type=\"number\"> from JSDoc.\n    return {\n      /**\n       * @private\n       */\n      pattern: String,\n      /**\n       * @private\n       */\n      preventInvalidInput: Boolean,\n      /**\n       * @private\n       */\n      minlength: Number,\n      /**\n       * @private\n       */\n      maxlength: Number\n    };\n  }\n\n  ready() {\n    super.ready();\n    this._enabledCharPattern = '[-+\\\\d]';\n  }\n\n  _valueChanged(newVal, oldVal) {\n    if (newVal !== '' && !this.__isInteger(newVal)) {\n      console.warn(`Trying to set non-integer value \"${newVal}\" to <vaadin-integer-field>.`\n        + ` Clearing the value.`);\n      this.value = '';\n      return;\n    }\n    super._valueChanged(newVal, oldVal);\n  }\n\n  _stepChanged(newVal, oldVal) {\n    if (!this.__hasOnlyDigits(newVal)) {\n      console.warn(`Trying to set invalid step size \"${newVal}\",`\n        + ` which is not a positive integer, to <vaadin-integer-field>.`\n        + ` Resetting the default value 1.`);\n      this.step = 1;\n      return;\n    }\n    super._stepChanged(newVal, oldVal);\n  }\n\n  __isInteger(value) {\n    return /^(-\\d)?\\d*$/.test(String(value));\n  }\n\n  __hasOnlyDigits(value) {\n    return /^\\d*$/.test(String(value));\n  }\n}\n\nwindow.customElements.define(IntegerFieldElement.is, IntegerFieldElement);\n\nexport { IntegerFieldElement };\n","import { PolymerElement, html } from \"@polymer/polymer\";\nimport { encodeForHash } from \"../js/utils\";\nimport { getSelectedCharacter, getASIForLevel, getCharacterChannel, setASI, getFeatReference, setFeatAttributeSelection } from \"../util/charBuilder\";\n\nclass DndAsiSelect extends PolymerElement {\n  \n  static get properties() {\n    return {\n      levelIndex: {\n        type: Number\n      },\n      checked: {\n        type: Boolean,\n        value: false\n      },\n      selectedFeat: {\n        type: Object\n      },\n      selectedAbility1: {\n        type: String,\n        value: ''\n      },\n      selectedAbility2: {\n        type: String,\n        value: ''\n      },\n      featHasAttributeChoice: {\n        type: Boolean,\n        value: false\n      },\n      featAttributeSelection: {\n        type: String,\n        value: ''\n      },\n      featAttributeOptions: {\n        type: Array,\n        value: []\n      },\n      disabled: {\n        type: Boolean,\n        value: false,\n        reflectToAttribute: true\n      }\n    };\n  }\n\n  constructor() {\n    super();\n    this.attributeOptions = [\n      \"STR\",\n      \"DEX\",\n      \"CON\",\n      \"INT\",\n      \"WIS\",\n      \"CHA\"\n    ]\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n\n    this.switchChangeHandler = (e) => {\n      this.checked = e.detail.checked;\n      this._genASICallback()();\n    }\n    this.addEventListener(\"switch-change\", this.switchChangeHandler);\n\n    this.characterChangeHandler = (e) => {\n      let character = e.detail.character;\n      this.updateFromCharacter(character);\n    };\n    \n    this.updateFromCharacter(getSelectedCharacter());\n    getCharacterChannel().addEventListener(\"character-selected\", this.characterChangeHandler);\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n\n    this.removeEventListener(\"switch-change\", this.switchChangeHandler);\n    getCharacterChannel().removeEventListener(\"character-selected\", this.characterChangeHandler);\n  }\n\n  async updateFromCharacter(character) {\n    const { asi, index } = await getASIForLevel(this.levelIndex, character);\n\n    this.featHasAttributeChoice = false;\n    if (asi) {\n      this.selectedFeat = asi.feat;\n      this.selectedAbility1 = asi.ability1;\n      this.selectedAbility2 = asi.ability2;\n      this.checked = asi.isFeat;\n\n      if (asi.isFeat && asi.feat && asi.feat.name && asi.feat.source) {\n        const featId = `${asi.feat.name}_${asi.feat.source}`;\n        const featRef = await getFeatReference(featId);\n\n        if (featRef.ability && featRef.ability.length && featRef.ability[0].choose) {\n          this.featHasAttributeChoice = true;\n          this.featAttributeOptions = featRef.ability[0].choose.from.map(i => { return i.toUpperCase() });\n          this.featAttributeSelection = character.featAttributeSelections && character.featAttributeSelections[featId] \n            ? character.featAttributeSelections[featId] : '';\n        }\n      }\n    } else {\n      this.selectedFeat = { name: '', source: '' };\n      this.selectedAbility1 = '';\n      this.selectedAbility2 = '';\n      this.checked = false;\n    }\n    this.asiIndex = index;\n  }\n\n  _genASICallback(keyForChange) {\n    return (newVal) => {\n      setASI({\n        feat: keyForChange === 'feat' ? { name: newVal.name, source: newVal.source } : this.selectedFeat,\n        ability1: keyForChange === 'ability1' ? newVal : this.selectedAbility1,\n        ability2: keyForChange === 'ability2' ? newVal : this.selectedAbility2,\n        isFeat: this.checked\n      }, this.asiIndex);\n    }\n  }\n\n  _genFeatAbilityCallback() {\n    return (newVal) => {\n      if (this.selectedFeat && this.selectedFeat.name && this.selectedFeat.source) {\n        const featId = `${this.selectedFeat.name}_${this.selectedFeat.source}`;\n        setFeatAttributeSelection(featId, newVal);\n      }\n    }\n  }\n\n  _disableLabel(checked) {\n    return checked ? 'Feat' : 'ASI';\n  }\n\n  _getFeatLink(feat) {\n    let linkData = [feat.name];\n    if (feat.source) {\n      linkData.push(feat.source);\n    }\n    let dataLink = encodeForHash(linkData);\n    return dataLink ? `#/feats/${dataLink}` : '#/feats';\n  }\n\n  _linkClick() {\n    this.dispatchEvent(new CustomEvent(\"open-drawer\", {\n      bubbles: true,\n      composed: true,\n      detail: {\n        selectedItem: this.selectedFeat,\n        viewId: 'feats'\n      }\n    }));\n  }\n\n  static get template() {\n    return html`\n      <style include=\"material-styles\">\n        :host {\n          display: flex;\n          flex-direction: column;\n          max-width: 192px;\n        }\n        [hidden] {\n          display: none !important;\n        }\n        .abilities {\n          display: flex;\n          flex-wrap: wrap;\n        }\n        .abilities dnd-select-add {\n          width: calc(50% - 8px);\n        }\n        dnd-select-add + dnd-select-add {\n          margin-left: 16px;\n        }\n        dnd-select-add {\n          display: block;\n        }\n        .disable-label {\n          font-size: 14px;\n          font-weight: 500;\n          color: var(--mdc-theme-primary);\n        }\n        .reference-link {\n          color: var(--lumo-body-text-color);\n        }\n        .reference-link:hover {\n          color: var(--mdc-theme-secondary);\n        }\n        .feat-pick-wrap {\n          display: flex;\n        }\n      </style>\n\n      <div class=\"disable-label\" hidden$=\"[[!disabled]]\">[[_disableLabel(checked)]]</div>\n      <dnd-switch initial-value=[[checked]] label=\"ASI\" secondary-label=\"Feat\" disabled$=\"[[disabled]]\" hidden$=\"[[disabled]]\"></dnd-switch>\n      <div class=\"abilities\" hidden$=[[checked]]>\n        <dnd-select-add add-callback=\"[[_genASICallback('ability1')]]\" value=\"[[selectedAbility1]]\" options=\"[[attributeOptions]]\" placeholder=\"<ASI>\" disabled$=\"[[disabled]]\"></dnd-select-add>\n        <dnd-select-add add-callback=\"[[_genASICallback('ability2')]]\" value=\"[[selectedAbility2]]\" options=\"[[attributeOptions]]\" placeholder=\"<ASI>\" disabled$=\"[[disabled]]\"></dnd-select-add>\n      </div>\n      <div class=\"feat-pick-wrap\" hidden$=[[!checked]]>\n        <dnd-select-add add-callback=\"[[_genASICallback('feat')]]\" model=\"feats\" value=\"[[selectedFeat.name]]\" placeholder=\"<Choose Feat>\" disabled$=\"[[disabled]]\"></dnd-select-add>\n        <button class=\"reference-link mdc-icon-button material-icons\" on-click=\"_linkClick\">logout</button>\n      </div>\n      <div hidden$=[[!featHasAttributeChoice]]>\n        <dnd-select-add test add-callback=\"[[_genFeatAbilityCallback()]]\" value=\"[[featAttributeSelection]]\" options=\"[[featAttributeOptions]]\" placeholder=\"<Choose Attribute>\" disabled$=\"[[disabled]]\"></dnd-select-add>\n      </div>\n    `;\n  }\n}\n\ncustomElements.define(\"dnd-asi-select\", DndAsiSelect);","export const classOptionsMap = {\n  \"artificer(ua)\": {\n    class: {\n      2: {\n        name: \"Wonderous Invention\",\n        count: 1,\n        options: [\"{@item Bag of holding}\", \"{@item cap of water breathing}\", \"{@item driftglobe}\", \"{@item goggles of night}\", \"{@item sending stones}\"]\n      },\n      5: {\n        name: \"Wonderous Invention\",\n        count: 1,\n        options: [\"{@item Alchemy jug}\", \"{@item helm of comprehending languages}\", \"{@item lantern of revealing}\", \"{@item ring of swimming}\", \"{@item robe of useful items}\", \"{@item rope of climbing}\", \"{@item wand of magic detection}\", \"{@item wand of secrets}\", \"{@item Bag of holding}\", \"{@item cap of water breathing}\", \"{@item driftglobe}\", \"{@item goggles of night}\", \"{@item sending stones}\"]\n      },\n      10: {\n        name: \"Wonderous Invention\",\n        count: 1,\n        options: [\"{@item Bag of beans}\", \"{@item chime of opening}\", \"{@item decanter of endless water}\", \"{@item eyes of minute seeing}\", \"{@item folding boat}\", \"{@item Heward's handy haversack}\", \"{@item Alchemy jug}\", \"{@item helm of comprehending languages}\", \"{@item lantern of revealing}\", \"{@item ring of swimming}\", \"{@item robe of useful items}\", \"{@item rope of climbing}\", \"{@item wand of magic detection}\", \"{@item wand of secrets}\", \"{@item Bag of holding}\", \"{@item cap of water breathing}\", \"{@item driftglobe}\", \"{@item goggles of night}\", \"{@item sending stones}\"]\n      },\n      15: {\n        name: \"Wonderous Invention\",\n        count: 1,\n        options: [\"{@item Boots of striding and springing}\", \"{@item bracers of archery}\", \"{@item brooch of shielding}\", \"{@item broom of flying}\", \"{@item hat of disguise}\", \"{@item slippers of spider climbing}\", \"{@item Bag of beans}\", \"{@item chime of opening}\", \"{@item decanter of endless water}\", \"{@item eyes of minute seeing}\", \"{@item folding boat}\", \"{@item Heward's handy haversack}\", \"{@item Alchemy jug}\", \"{@item helm of comprehending languages}\", \"{@item lantern of revealing}\", \"{@item ring of swimming}\", \"{@item robe of useful items}\", \"{@item rope of climbing}\", \"{@item wand of magic detection}\", \"{@item wand of secrets}\", \"{@item Bag of holding}\", \"{@item cap of water breathing}\", \"{@item driftglobe}\", \"{@item goggles of night}\", \"{@item sending stones}\"]\n      },\n      20: {\n        name: \"Wonderous Invention\",\n        count: 1,\n        options: [\"{@item Eyes of the eagle}\", \"{@item gem of brightness}\", \"{@item gloves of missile snaring}\", \"{@item gloves of swimming and climbing}\", \"{@item ring of jumping}\", \"{@item ring of mind shielding}\", \"{@item wings of flying}\", \"{@item Boots of striding and springing}\", \"{@item bracers of archery}\", \"{@item brooch of shielding}\", \"{@item broom of flying}\", \"{@item hat of disguise}\", \"{@item slippers of spider climbing}\", \"{@item Bag of beans}\", \"{@item chime of opening}\", \"{@item decanter of endless water}\", \"{@item eyes of minute seeing}\", \"{@item folding boat}\", \"{@item Heward's handy haversack}\", \"{@item Alchemy jug}\", \"{@item helm of comprehending languages}\", \"{@item lantern of revealing}\", \"{@item ring of swimming}\", \"{@item robe of useful items}\", \"{@item rope of climbing}\", \"{@item wand of magic detection}\", \"{@item wand of secrets}\", \"{@item Bag of holding}\", \"{@item cap of water breathing}\", \"{@item driftglobe}\", \"{@item goggles of night}\", \"{@item sending stones}\"]\n      }\n    }\n  },\n  \"artificer (revisited)\": {\n    class: {\n      2: {\n        name: \"Infuse Item\",\n        count: 3,\n        type: \"featureType=ai|source=UAArtificerRevisited\"\n      },\n      4: {\n        name: \"Infuse Item\",\n        count: 1,\n        type: \"featureType=ai|source=UAArtificerRevisited\"\n      },\n      7: {\n        name: \"Infuse Item\",\n        count: 1,\n        type: \"featureType=ai|source=UAArtificerRevisited\"\n      },\n      11: {\n        name: \"Infuse Item\",\n        count: 1,\n        type: \"featureType=ai|source=UAArtificerRevisited\"\n      },\n      15: {\n        name: \"Infuse Item\",\n        count: 1,\n        type: \"featureType=ai|source=UAArtificerRevisited\"\n      },\n      19: {\n        name: \"Infuse Item\",\n        count: 1,\n        type: \"featureType=ai|source=UAArtificerRevisited\"\n      }\n    }\n  },\n  artificer: {\n    class: {\n      2: {\n        name: \"Infuse Item\",\n        count: 4,\n        type: \"featureType=ai|source=TCE\"\n      },\n      6: {\n        name: \"Infuse Item\",\n        count: 2,\n        type: \"featureType=ai|source=TCE\"\n      },\n      10: {\n        name: \"Infuse Item\",\n        count: 2,\n        type: \"featureType=ai|source=TCE\"\n      },\n      14: {\n        name: \"Infuse Item\",\n        count: 2,\n        type: \"featureType=ai|source=TCE\"\n      },\n      18: {\n        name: \"Infuse Item\",\n        count: 2,\n        type: \"featureType=ai|source=TCE\"\n      }\n    }\n  },\n  barbarian: {\n    subclasses: {\n      \"Path of the Totem Warrior\": {\n        3: {\n          name: \"Totem Spirit\",\n          count: 1,\n          options: [\"Bear\", \"Eagle\", \"Elk\", \"Tiger\", \"Wolf\"]\n        },\n        6: {\n          name: \"Aspect of the Beast\",\n          count: 1,\n          options: [\"Bear\", \"Eagle\", \"Elk\", \"Tiger\", \"Wolf\"]\n        },\n        14: {\n          name: \"Totemic Attunement\",\n          count: 1,\n          options: [\"Bear\", \"Eagle\", \"Elk\", \"Tiger\", \"Wolf\"]\n        }\n      }\n    }\n  },\n  bard: {\n    subclasses: {\n      \"College of Swords\": {\n        3: {\n          name: \"Fighting Style\",\n          count: 1,\n          type: \"fs:b\"\n        }\n      }\n    }\n  },\n  fighter: {\n    class: {\n      1: {\n        name: \"Fighting Style\",\n        type: \"fs:f\",\n        count: 1\n      }\n    }\n  },\n  paladin: {\n    class: {\n      2: {\n        name: \"Fighting Style\",\n        type: \"fs:p\",\n        count: 1\n      },\n    }\n  },\n  ranger: {\n    class: {\n      2: {\n        name: \"Fighting Style\",\n        type: \"fs:r\",\n        count: 1\n      },\n    }\n  },\n  sorcerer: {\n    class: {\n      3: {\n        name: \"Metamagic\",\n        type: \"mm\",\n        count: 2\n      },\n      10: {\n        name: \"Metamagic\",\n        type: \"mm\",\n        count: 1\n      },\n      17: {\n        name: \"Metamagic\",\n        type: \"mm\",\n        count: 1\n      }\n    },\n    subclasses: {\n      \"Divine Soul\": {\n        1: [\n          {\n            name: \"Divine Magic Affinity\",\n            options: [\"Good (Cure Wounds)\", \"Evil (Inflict Wounds)\", \"Law (Bless)\", \"Chaos (Bane)\", \"Neutrality (Protection From Good and Evil\"],\n            count: 1\n          }\n        ]\n      }\n    }\n  },\n  warlock: {\n    class: {\n      2: {\n        name: \"Eldritch Invocations\",\n        type: \"ei\",\n        count: 2\n      },\n      3: {\n        name: \"Pact Boon\",\n        type: \"pb\",\n        count: 1\n      },\n      5: {\n        name: \"Eldritch Invocations\",\n        type: \"ei\",\n        count: 1\n      },\n      7: {\n        name: \"Eldritch Invocations\",\n        type: \"ei\",\n        count: 1\n      },\n      9: {\n        name: \"Eldritch Invocations\",\n        type: \"ei\",\n        count: 1\n      },\n      12: {\n        name: \"Eldritch Invocations\",\n        type: \"ei\",\n        count: 1\n      },\n      15: {\n        name: \"Eldritch Invocations\",\n        type: \"ei\",\n        count: 1\n      },\n      18: {\n        name: \"Eldritch Invocations\",\n        type: \"ei\",\n        count: 1\n      }\n    }\n  }\n};\n\nexport const proficiencyGains = {\n  classes: {\n    \"artificer(ua)\": {\n      subclasses: {\n        \"Gunsmith\": {\n          1: {\n            name: \"Master Smith\",\n            value: \"{@item smith's tools|phb}\"\n          }\n        }\n      }\n    },\n    \"Artificer (Revisited)\": {\n      subclasses: {\n        \"Alchemist\": {\n          3: {\n            name: \"Tools of the Trade\",\n            value: [\"{@item alchemist's supplies|phb}\", \"{@item herbalism kit|phb}\"]\n          }\n        },\n        \"Archivist\": {\n          3: {\n            name: \"Tools of the Trade\",\n            value: [\"{@item calligrapher's supplies|phb}\", \"{@item forgery kit|phb}\"]\n          }\n        },\n        \"Artillerist\": {\n          3: {\n            name: \"Tools of the Trade\",\n            value: [\"{@item smith's tools|phb}\", \"{@item woodcarver's tools|phb}\"]\n          }\n        },\n        \"Battle Smith\": {\n          3: [\n            {\n              name: \"Tools of the Trade\",\n              value: [\"{@item leatherworker's tools|phb}\", \"{@item smith's tools|phb}\"]\n            }, \n            {\n              name: \"Battle Ready\",\n              value: \"martial weapons\"\n            }\n          ]\n        }\n      }\n    },\n    artificer: {\n      subclasses: {\n        \"Alchemist\": {\n          3: {\n            name: \"Tool Proficiency\",\n            value: \"alchemist's supplies\",\n            orOther: true,\n            type: \"artisan's tools\"\n          }\n        },\n        \"Artillerist\": {\n          3: {\n            name: \"Tool Proficiency\",\n            value: \"woodcarver's supplies\"\n          }\n        },\n        \"Battle Smith\": {\n          3: [\n            {\n              name: \"Tool Proficiency\",\n              value: \"smith's supplies\"\n            },\n            {\n              name: \"Battle Ready\",\n              value: \"martial weapons\"\n            }\n          ]\n        },\n        \"Armorer (UA)\": {\n          3: {\n            name: \"Tricks of the Trade\",\n            value: [\"heavy armor\", \"smith's tools\"]\n          }\n        }\n      }\n    }\n  }\n};\n\nexport const spellGains = {\n  classes: {\n    \"artificer(ua)\": {\n      subclasses: {\n        \"Gunsmith\": {\n          1: {\n            name: \"\",\n            value: \"mending\"\n          }\n        }\n      }\n    },\n    \"Artificer (Revisited)\": {\n      subclasses: {\n        \"Alchemist\": {\n          14: {\n            name: \"Chemical Savant\",\n            value: \"greater restoration\",\n            noSlot: true,\n            noMaterial: true,\n            recharge: \"long rest\"\n          }\n        }\n      }\n    },\n    \"artificer\": {\n      subclasses: {\n        \"Alchemist\": {\n          14: {\n            name: \"Chemical Mastery\",\n            value: [\"greater restoration\", \"heal\"],\n            noSlot: true,\n            noMaterial: true,\n            recharge: \"long rest\"\n          }\n        }\n      }\n    },\n    barbarian: {\n      subclasses: {\n        \"Path of the Totem Warrior\": {\n          3: {\n            name: \"Spirit Seeker\",\n            value: [\"beast sense\", \"speak with animals\"],\n            ritualOnly: true,\n            noSlot: true\n          }\n        },\n        \"Path of the Ancestral Guardian v2 (UA)\": {\n          10: {\n            name: \"Consult the Spirits\",\n            value: \"clairvoyance\",\n            noSlot: true\n          }\n        },\n        \"Path of the Ancestral Guardian\": {\n          10: {\n            name: \"Consult the Spirits\",\n            value: [\"augury\", \"clairvoyance\"],\n            noSlot: true,\n            noMaterial: true,\n            recharge: \"short rest\"\n          }\n        },\n        \"Path of the Wild Soul (UA)\": {\n          3: {\n            name: \"Lingering Magic\",\n            value: \"detect magic\",\n            noSlot: true,\n            noMaterial: true,\n            recharge: \"long rest\",\n            charges: \"con\"\n          }\n        }\n      }\n    },\n    bard: {\n      subclasses: {\n        \"College of Lore\": {\n          6: {\n            name: \"\",\n            count: 2,\n            list: \"any\"\n          }\n        }\n      },\n      class: {\n        10: {\n          name: \"Magical Secrets\",\n          count: 2,\n          list: \"any\"\n        },\n        14: {\n          name: \"\",\n          count: 2,\n          list: \"any\"\n        },\n        18: {\n          name: \"\",\n          count: 2,\n          list: \"any\"\n        }\n      }\n    }\n  }\n};\n\nexport const expertiseClasses = {\n  \"artificer(ua)\": {\n    2: {\n      name: \"Tool Expertise\",\n      type: \"artificier-tools\"\n    }\n  },\n  \"Artificer (Revisited)\": {\n    3: {\n      name: \"Tool Expertise\",\n      type: \"artificier-tools\"\n    }\n  },\n  \"Artificer\": {\n    6: {\n      name: \"Tool Expertise\",\n      type: \"artificier-tools\"\n    }\n  },\n  bard: {\n    3: 2,\n    10: 2\n  }\n};\n\nexport const itemGains = {\n  \"Artificer (Revisited)\": {\n    subclasses: {\n      \"Alchemist\": {\n        3: {\n          name: \"Tools of the Trade\",\n          value: [\"{@item alchemist's supplies|phb}\", \"{@item herbalism kit|phb}\"]\n        }\n      },\n      \"Archivist\": {\n        3: {\n          name: \"Tools of the Trade\",\n          value: [\"{@item calligrapher's supplies|phb}\", \"{@item forgery kit|phb}\"]\n        }\n      },\n      \"Artillerist\": {\n        3: {\n          name: \"Tools of the Trade\",\n          value: [\"{@item smith's tools|phb}\", \"{@item woodcarver's tools|phb}\", \"a nonmagical, wooden wand\"]\n        }\n      },\n      \"Battle Smith\": {\n        3: {\n          name: \"Tools of the Trade\",\n          value: [\"{@item leatherworker's tools|phb}\", \"{@item smith's tools|phb}\"]\n        }\n      }\n    }\n  }\n};\n\nexport const resistanceGains = {\n  class: {\n    \"Artificer (Revisited)\": {\n      subclasses: {\n        \"Alchemist\": {\n          14: [\n            {\n              name: \"Chemical Savant\",\n              level: \"resistance\",\n              type: \"damage\",\n              value: \"acid\"\n            },\n            {\n              name: \"Chemical Savant\",\n              level: \"resistance\",\n              type: \"damage\",\n              value: \"poison\"\n            },\n            {\n              name: \"Chemical Savant\",\n              level: \"immunity\",\n              type: \"condition\",\n              value: \"poisoned\"\n            }\n          ]\n        }\n      }\n    }\n  },\n  artificer: {\n    subclasses: {\n      \"Alchemist\": {\n        15: [\n          {\n            name: \"Chemical Mastery\",\n            level: \"resistance\",\n            type: \"damage\",\n            value: \"acid\"\n          },\n          {\n            name: \"Chemical Mastery\",\n            level: \"resistance\",\n            type: \"damage\",\n            value: \"poison\"\n          },\n          {\n            name: \"Chemical Mastery\",\n            level: \"immunity\",\n            type: \"condition\",\n            value: \"poisoned\"\n          }\n        ]\n      }\n    }\n  }\n};\n","import { PolymerElement, html } from \"@polymer/polymer\";\nimport { MutableData } from '@polymer/polymer/lib/mixins/mutable-data.js';\nimport { getCharacterChannel, getSelectedCharacter, getClassReferences, setClassLevels, mergeSubclass, setClassSkillProficiencies, getSubclassChoiceLevel, mergeFeature, setSubclassChoice, setClassChoice, getSubclassChoice, getClassChoice, getHPRollForClassLevel, getHPDiceForLevel, setHpRoll, getClassString, getOptionFeatureChoice, setOptionFeatureChoice } from \"../../../util/charBuilder\";\nimport \"@vaadin/vaadin-grid\";\nimport \"../../dnd-select-add\";\nimport \"../../dnd-switch\";\nimport \"../../dnd-button\";\nimport \"../../dnd-asi-select\";\nimport \"../../dnd-svg\";\nimport './dnd-character-builder-suboptions';\nimport { jqEmpty, getEntryName } from \"../../../js/utils\";\nimport { classOptionsMap } from \"../../../data/choices\";\nimport EntryRenderer from \"../../../util/entryrender\";\nimport { } from '@polymer/polymer/lib/elements/dom-if.js';\nimport { } from '@polymer/polymer/lib/elements/dom-repeat.js';\nimport { getEditModeChannel, isEditMode } from \"../../../util/editMode\";\nimport {filterModel} from \"../../../util/data\";\nimport '@vaadin/vaadin-text-field/vaadin-integer-field'\n\nclass DndCharacterBuilderClass extends MutableData(PolymerElement) {\n  \n  static get properties() {\n    return {\n      levels: {\n        type: Array,\n        value: []\n      },\n      classes: {\n        type: Object,\n      },\n      subclasses: {\n        type: Object,\n        value: undefined\n      },\n      noContentMessage: {\n        type: Boolean,\n        value: false\n      },\n      isEditMode: {\n        type: Boolean,\n        value: false\n      }\n    };\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n\n    this.characterChangeHandler = (e) => {\n      let character = e.detail.character;\n      this.updateFromCharacter(character);\n    };\n    \n    this.updateFromCharacter(getSelectedCharacter());\n    getCharacterChannel().addEventListener(\"character-selected\", this.characterChangeHandler);\n\n    this.editModeHandler = (e) => {\n      this.isEditMode = e.detail.isEditMode;\n      this.$.classGrid.notifyResize();\n    }\n    getEditModeChannel().addEventListener('editModeChange', this.editModeHandler);\n    this.isEditMode = isEditMode();\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n\n    getCharacterChannel().removeEventListener(\"character-selected\", this.characterChangeHandler);\n    getEditModeChannel().removeEventListener('editModeChange', this.editModeHandler);\n  }\n\n  ready() {\n    super.ready();\n\n    const renderer = new EntryRenderer();\n\n    setTimeout(() => {\n      const grid = this.$.classGrid;\n      let draggedItem;\n\n      grid.rowDetailsRenderer = ((root, grid, rowData) => {\n        let renderStack = [],\n          features = this._getClassLevelFeatures(this.levels, rowData.index, this.classes, this.subclasses);\n        \n        if (features && features.length) {\n          if (!root.firstElementChild) {\n            root.innerHTML = '<div class=\"details stats-wrapper \"></div>';\n          }\n\n          for (let feature of features) {\n            renderer.recursiveEntryRender(\n              feature,\n              renderStack,\n              0,\n              undefined,\n              true\n            );\n          }\n          const deets = root.querySelector('.details');\n          jqEmpty(deets);\n          deets.innerHTML = renderStack.join(\"\");\n        }\n      }).bind(this);\n\n      grid.addEventListener('grid-dragstart', function(e) {\n        draggedItem = e.detail.draggedItems[0];\n        grid.dropMode = 'between';\n      });\n\n      grid.addEventListener('grid-dragend', function(e) {\n        draggedItem = grid.dropMode = null;\n      });\n\n      grid.addEventListener('grid-drop', function(e) {\n        const dropTargetItem = e.detail.dropTargetItem;\n        if (draggedItem && draggedItem !== dropTargetItem) {\n          // Reorder the items\n          const items = grid.items.filter(function(i) {\n            return i !== draggedItem;\n          });\n          const dropIndex = items.indexOf(dropTargetItem)\n            + (e.detail.dropLocation === 'below' ? 1 : 0);\n          items.splice(dropIndex, 0, draggedItem);\n          setClassLevels(items);\n        }\n      });\n    }, 0);\n  }\n\n  async updateFromCharacter(character) {\n    if (character && character.levels && character.levels.length) {\n      this.noContentMessage = false;\n      this.character = character;\n      this.classes = await getClassReferences(character);\n      this.subclasses = JSON.parse(JSON.stringify(character.subclasses));\n      this.classLevel = getClassString(character);\n      this.classChoices = await this._findLevelChoices(character, this.classes);\n\n      this.dispatchEvent(new CustomEvent(\"loadingChange\", { bubbles: true, composed: true }));\n\n      this.levels = character.levels;\n\n      const hitDiceMaxes = [];\n      for (let i = 0; i < character.levels.length; i++) {\n        hitDiceMaxes.push(await getHPDiceForLevel(i));\n      }\n      this.hitDiceMaxes = hitDiceMaxes;\n\n      this.$.classGrid.clearCache();\n    } else {\n      this.noContentMessage = true;\n      this.dispatchEvent(new CustomEvent(\"loadingChange\", { bubbles: true, composed: true }));\n      this.$.classGrid.clearCache();\n    }\n  }\n\n  _getClassLevelFeatures(levels, index, classes, subclasses) {\n    if (classes && levels[index] && subclasses) {\n      const className = levels[index].name;\n      const classRef = classes[className];\n\n      if (classRef) {\n        const classFeatures = classRef.classFeatures;\n        let levelsInClass = -1;\n        let levelsInSubclass = -1;\n\n        if (levels.length >= index + 1) {\n          for (let i = 0; i <= index; i ++) {\n            if (levels[i].name === className) {\n              levelsInClass ++;\n\n              const classFeaturesForLevel = classFeatures[levelsInClass];\n              if (classFeaturesForLevel) {\n                const hasSubclassFeature = classFeaturesForLevel.find(i => i.gainSubclassFeature);\n                if (hasSubclassFeature) {\n                  levelsInSubclass ++;\n                }\n              }\n            }\n          }\n\n          const classFeaturesForLevel = classFeatures[levelsInClass];\n          if (classFeaturesForLevel) {\n            const hasSubclassFeature = classFeaturesForLevel.some(i => i.gainSubclassFeature);\n            if (hasSubclassFeature && subclasses && subclasses[className] && classRef.subclasses && classRef.subclasses.length) {\n              const subclassDef = classRef.subclasses.find(i => subclasses[className].name === i.name);\n              if (subclassDef && subclassDef.subclassFeatures[levelsInSubclass]) {\n                subclassDef.subclassFeatures[levelsInSubclass].map((i) => { i.isSubclass = true; return i; })\n                return [...classFeaturesForLevel].concat(subclassDef.subclassFeatures[levelsInSubclass]);\n              }\n            }\n            return classFeaturesForLevel.filter((feature) => { \n              const name = getEntryName(feature);\n              return name !== 'Proficiency Versatility' && name !== 'Martial Versatility';\n            });\n          }\n        }\n      }\n    }\n  }\n\n  _getClassLevelFeatureStringArray(levels, index, classes, subclasses) {\n    if (levels && index !== undefined && classes && subclasses) {\n      const classLevelFeatures = this._getClassLevelFeatures(levels, index, classes, subclasses);\n\n      if (classLevelFeatures) {\n        return classLevelFeatures.map(f => {\n          return { name: getEntryName(f), isSubclass: f.isSubclass };\n        });\n      }\n    }\n  }\n\n  _level(index) {\n    return index + 1;\n  }\n\n  _deleteLevel(e) {\n    let index = e.model.__data.index;\n    let previousFirstClassId = this.levels[0].id;\n    this.levels.splice(index, 1);\n    setClassLevels(this.levels, previousFirstClassId);\n  }\n\n  _expandDetails(e) {\n    let data = e.model.__data.item,\n      stayClosed = this.$.classGrid.detailsOpenedItems.indexOf(data) > -1;\n\n    for (let item of this.$.classGrid.detailsOpenedItems) {\n      this.$.classGrid.closeItemDetails(item);\n    }\n\n    if (stayClosed) {\n      this.$.classGrid.closeItemDetails(data);\n    } else {\n      this.$.classGrid.openItemDetails(data);\n    }\n    this.$.classGrid.notifyResize();\n  }\n\n  async _findLevelChoices(character, classes) {\n    const levelChoices = [];\n    if (character && character.levels && character.levels.length) {\n      for (let i = 0; i < character.levels.length; i++) {\n        levelChoices.push(await this._findChoices(character, classes, i));\n      }\n    }\n    return levelChoices;\n  }\n\n  async _findChoices(character, classes, levelIndex) {\n    if (classes && character.levels && character.levels.length && character.levels.length > levelIndex) {\n      let levels = character.levels,\n        subclasses = character.subclasses,\n        name = levels[levelIndex].name,\n        classDef = classes[name];\n\n      if (classDef) {\n        let choices = [],\n          classLevelCount = 0,\n          subclassChoiceLevel = getSubclassChoiceLevel(classDef);\n\n        for (let i = 0; i <= levelIndex; i++) {\n          let level = levels[i]\n          if (level.name === name) {\n            classLevelCount ++;\n          }\n        }\n\n        // Suboption component for first level class\n        if (levelIndex === 0) {\n          const suboptions = {}\n          suboptions.skillProficiencies = classDef.startingProficiencies.skills\n\n          if (classDef.startingProficiencies.armor) {\n            suboptions.armorProficiencies = [{}];\n            classDef.startingProficiencies.armor.forEach(p => {\n              let prof = p.proficiency || p.toLowerCase();\n              prof = prof.includes('shield') ? 'shield' : prof;\n              suboptions.armorProficiencies[0][prof] = true;\n            });\n          }\n          \n          if (classDef.startingProficiencies.weapons) {\n            suboptions.weaponProficiencies = [{}];\n            classDef.startingProficiencies.weapons.forEach(p => {\n              let prof = p.proficiency || p.toLowerCase();\n              if (prof.includes(\"@item\")) {\n                prof = prof.split(\"@item\")[1].trim().split('|')[0];\n              }\n              suboptions.weaponProficiencies[0][prof] = true;\n            });\n          }\n\n          if (classDef.startingProficiencies.tools) {\n            suboptions.toolProficiencies = [{}];\n            classDef.startingProficiencies.tools.forEach(p => {\n              let count;\n              let prof = p.proficiency || p.toLowerCase();\n              count = prof.includes('one ') ? 1 : prof.includes('two ') ? 2 : prof.includes('three ') ? 3 :prof.includes('four ') ? 4 : prof.includes('five ') ? 5 : 1;\n              if (prof.includes(\"@item\")) {\n                prof = prof.split(\"@item\")[1].trim().split('|')[0];\n              }\n              if (prof.includes(\"artisan's tools\") || prof.includes('musical instrument')) {\n                prof = prof.includes(\"artisan's tools\") ? \"artisan's tools\" : 'musical instrument';\n                suboptions.toolProficiencies[0].choose = { from: [prof], count };\n              } else {\n                suboptions.toolProficiencies[0][prof] = true;\n              }\n            });\n          }\n          choices.push({\n            id: \"firstClass\",\n            suboptions\n          });\n        }\n\n        // Subclass choice\n        if (subclassChoiceLevel !== undefined && classLevelCount === subclassChoiceLevel) {\n          choices.push({\n            id: \"subclass\",\n            from: classDef.subclasses,\n            selections: character.subclasses[name]\n          });\n        }\n\n        // ASI choice\n        let features = this._getClassLevelFeatures(levels, levelIndex, classes, subclasses);\n        if (features && features.length) {\n          if (features.find((f) => { return f.name === \"Ability Score Improvement\"; })) {\n            choices.push({\n              id: \"asi\"\n            });\n          }\n        }\n\n        // Feature replacement choice\n        if (features && features.length) {\n          features.forEach(feature => {\n            if (!feature.name.includes(\"feature\")) {\n              const choice = {\n                id: 'replacement',\n                from: [{name: feature.name, source: feature.source}],\n                selection: getOptionFeatureChoice(name, levelIndex, feature.name),\n                class: name,\n                level: levelIndex,\n                feature: feature.name\n              };\n              features.forEach(featurei => {\n                if (featurei.isClassFeatureVariant && featurei.entries[0].includes('replaces') && featurei.entries[0].includes(feature.name)) {\n                  choice.from.push({name: featurei.name, source: featurei.source});\n                }\n              });\n              if (choice.from.length > 1) {\n                console.error(' replacement choice', choice)\n                choices.push(choice);\n              }\n            }\n          });\n        }\n        \n        // Todo: optional replacement features, sub-option setup for class, subclass, and features\n\n        // Generating other choices from choices.js map\n        if (classLevelCount) {\n          const classOptions = classOptionsMap[name.toLowerCase()];\n\n          if (classOptions && classOptions.class && classOptions.class[classLevelCount]) {\n            const classLevelOptions = [].concat(classOptions.class[classLevelCount]);\n            \n            for (const classLevelOption of classLevelOptions) {\n              console.error(\"classLevelOption\", classLevelOption);\n              if (classLevelOption.options) {\n                choices.push({\n                  id: \"classFeature\",\n                  name: classLevelOption.name,\n                  from: classLevelOption.options,\n                  count: classLevelOption.count > 1 ? classLevelOption.count : undefined,\n                  class: name.toLowerCase(),\n                  feature: classLevelOption.name,\n                  level: classLevelCount,\n                  selections: getClassChoice(name.toLowerCase(), classLevelCount, classLevelOption.name)\n                });\n              } else if (classLevelOption.type) {\n                const options = await filterModel(\"features\", classLevelOption.type);\n                choices.push({\n                  id: \"classFeature\",\n                  name: classLevelOption.name,\n                  from: options,\n                  count: classLevelOption.count > 1 ? classLevelOption.count : undefined,\n                  class: name.toLowerCase(),\n                  feature: classLevelOption.name,\n                  level: classLevelCount,\n                  selections: getClassChoice(name.toLowerCase(), classLevelCount, classLevelOption.name)\n                });\n              }\n            }\n          }\n\n          if (classOptions && classOptions.subclasses && subclasses[name] && classOptions.subclasses[subclasses[name].name] && classOptions.subclasses[subclasses[name].name][classLevelCount]) {\n            const subclassLevelOptions = [].concat(classOptions.subclasses[subclasses[name].name][classLevelCount]);\n            \n            for (const subclassLevelOption of subclassLevelOptions) {\n              if (subclassLevelOption.options) {\n                choices.push({\n                  id: \"subclassFeature\",\n                  name: subclassLevelOption.name,\n                  from: subclassLevelOption.options,\n                  count: subclassLevelOption.count > 1 ? subclassLevelOption.count : undefined,\n                  class: name.toLowerCase(),\n                  subclass: subclasses[name],\n                  feature: subclassLevelOption.name,\n                  level: classLevelCount,\n                  selections: getSubclassChoice(name.toLowerCase(), subclasses[name].name.toLowerCase(), classLevelCount, subclassLevelOption.name)\n                });\n              } else if (subclassLevelOption.type) {\n                const options = await filterModel(\"features\", subclassLevelOption.type);\n                choices.push({\n                  id: \"subclassFeature\",\n                  name: subclassLevelOption.name,\n                  from: options,\n                  count: subclassLevelOption.count > 1 ? subclassLevelOption.count : undefined,\n                  class: name.toLowerCase(),\n                  subclass: subclasses[name],\n                  feature: subclassLevelOption.name,\n                  level: classLevelCount,\n                  selections: getSubclassChoice(name.toLowerCase(), subclasses[name].name.toLowerCase(), classLevelCount, subclassLevelOption.name)\n                });\n              }\n            }\n          }\n        }\n\n        return choices;\n      }\n    }\n    return [];\n  }\n\n  _equal(a, b) {\n    return a === b;\n  }\n\n  _genSubclassCallback(level) {\n    return (subclass) => {\n      mergeSubclass(undefined, level.name, subclass);\n    }\n  }\n\n  _genSubclassOptions(level) {\n    return this.classes[level.name].subclasses;\n  }\n\n  _getSubclassSelection(level, subclasses) {\n    return subclasses[level.name];\n  }\n\n  _classFeatureOptionAddCallback(classs, level, feature) {\n    return (choice) => {\n      let adjChoice;\n      if (Array.isArray(choice)) {\n        adjChoice = choice.map(c => {\n          if (c.name) {\n            return { name: c.name, source: c.source }\n          } else {\n            return c;\n          }\n        });\n      } else if (choice.name) {\n        adjChoice = { name: choice.name, source: choice.source };\n      } else {\n        adjChoice = choice;\n      }\n      setClassChoice(classs, level, feature, adjChoice);\n    };\n  }\n\n  _subclassFeatureOptionAddCallback(classs, subclass, level, feature) {\n    return (choice) => {\n      let adjChoice;\n      if (Array.isArray(choice)) {\n        adjChoice = choice.map(c => {\n          if (c.name) {\n            return { ...c }\n          } else {\n            return c;\n          }\n        });\n      } else if (choice.name) {\n        adjChoice = { ...choice };\n      } else {\n        adjChoice = choice;\n      }\n      setSubclassChoice(classs, subclass.name.toLowerCase(), level, feature, adjChoice);\n    };\n  }\n\n  _optionalFeatureAddCallback(classs, level, feature) {\n    return (choice) => {\n      let adjChoice;\n      if (Array.isArray(choice)) {\n        adjChoice = choice.map(c => {\n          if (c.name) {\n            return { ...c }\n          } else {\n            return c;\n          }\n        });\n      } else if (choice.name) {\n        adjChoice = { ...choice };\n      } else {\n        adjChoice = choice;\n      }\n      setOptionFeatureChoice(classs, level, feature, adjChoice);\n    };\n  }\n\n  _indexOfLevel(level, levels) {\n    return levels.indexOf(level);\n  }\n\n  _isMobile() {\n    return window.innerWidth < 921;\n  }\n\n  _objArray(obj) {\n    return Object.values(obj);\n  }\n\n  _atIndex(data, index) {\n    return data ? data[index] : null;\n  }\n\n  _svgFromClass(className) {\n    return className ? className.replace(/(\\s|\\(|\\))/g, \"\") : '';\n  }\n\n  _addClassLevel(e) {\n    mergeFeature(undefined, e.model.item, \"classes\");\n  }\n\n  _classSkillAddCallback(skills) {\n    setClassSkillProficiencies(skills);\n  }\n\n  _levelHp(className, index) {\n    return getHPRollForClassLevel(className, index + 1);\n  }\n\n  _editModeClass(isEditMode) {\n    return isEditMode ? 'edit-mode' : 'not-edit-mode';\n  }\n\n  _toggleHpField(e) {\n    const element = e.target.closest('.btn-field');\n    const isOpen = element.classList.contains('btn-field--open');\n    const intField = element.querySelector('vaadin-integer-field');\n    const level = parseInt(element.dataset.level) + 1;\n    const className = element.dataset.className;\n    const max = parseInt(element.dataset.max);\n  \n    if (isOpen) {\n      const changeVal = parseInt(intField.value);\n      if (changeVal && changeVal <= max && changeVal > 0) {\n        setHpRoll(className, level, changeVal);\n        intField.value = '';\n        element.classList.toggle('btn-field--open');\n      } else {\n        element.classList.add('btn-field--error');\n        setTimeout(() => {\n          element.classList.remove('btn-field--error');\n        }, 500);\n      }\n    } else {\n      element.classList.toggle('btn-field--open');\n      intField.focus();\n    }\n  }\n\n  _levelHitDice(index, maxes) {\n    if (maxes && index !== undefined && maxes[index]) {\n      return maxes[index];\n    }\n  }\n\n  static get template() {\n    return html`\n      <style include=\"material-styles my-styles\">\n        .something {\n          display: block;\n        }\n\n        #classGrid {\n          margin-bottom: 144px;\n        }\n\n        .heading-wrap {\n          display: flex;\n          justify-content: space-between;\n          margin: 22px 14px 12px;\n          align-items: center;\n          border-bottom: 1px solid var(--lumo-contrast-10pct);\n          flex-wrap: wrap;\n        }\n        .heading {\n          width: 100%;\n          display: flex;\n          flex-direction: row;\n          align-items: center;\n          justify-content: space-between;\n        }\n        .class-levels {\n          font-size: 16px;\n          padding-left: 8px;\n          font-weight: normal;\n          display: none;\n        }\n\n        h2 {\n          margin-bottom: 24px;\n          display: block;\n          font-size: 1.5em;\n          margin: 20px 0;\n          font-weight: bold;\n        }\n\n        .not-edit-mode .button-wrap {\n          display: none;\n        }\n\n        .button-wrap {\n          display: flex;\n          flex-wrap: wrap;\n          align-items: center;\n          padding: 10px;\n          width: 100%;\n        }\n        .button-wrap > * {\n          margin: 4px;\n        }\n\n        .row {\n          position: relative;\n          min-height: 80px;\n          padding: 12px 0 12px;\n        }\n        .row:after {\n          content: \"\";\n          display: table;\n          clear: both;\n        }\n\n        .open-details {\n          cursor: pointer;\n          display: flex;\n          align-items: flex-start;\n          flex-wrap: wrap;\n        }\n        .open-details:hover .level-col {\n          color: var(--mdc-theme-secondary);\n        }\n\n        .level-col {\n          width: calc(100% - 70px);\n          text-overflow: ellipsis;\n          white-space: nowrap;\n          overflow: hidden;\n          flex-shrink: 0;\n          padding: 6px 0;\n        }\n        .level-col__level {\n          margin-right: 10px;\n          font-size: 20px;\n          font-weight: bold;\n        }\n        .level-col__image-wrap {\n          width: 30px;\n          position: relative;\n          height: 21px;\n          display: inline-block;\n        }\n        .level-col__image {\n          width: 30px;\n          height: 30px;\n          display: block;\n          position: absolute;\n          top: -1px;\n        }\n        .level-col__class {\n          font-size: 20px;\n          font-weight: bold;\n        }\n\n        .features-col {\n          white-space: normal;\n          width: 100%;\n          margin: 0;\n          padding: 16px 0 8px;\n          font-size: 15px;\n        }\n        .class-feature:not(:last-of-type)::after {\n          content: ', ';\n        }\n        .class-feature[subclass] {\n          color: var(--mdc-theme-secondary);\n        }\n\n        .choices-col {\n          display: flex;\n          float: left;\n          flex-wrap: wrap;\n          width: 100%;\n          padding-left: 30px;\n        }\n        .choices-col__choice {\n          margin-right: 16px;\n          width: 100%;\n        }\n        .choices-col__choice dnd-select-add {\n          min-width: 250px;\n          width: calc(100% - 20px);\n        }\n        .choices-col__choice dnd-character-builder-suboptions {\n          --suboptions__min-width: 250px;\n          --suboptions__width: calc(100% - 20px);\n        }\n\n        @media(min-width: 420px) {\n          .choices-col__choice dnd-select-add {\n            width: calc(50% - 20px);\n          }\n          .choices-col__choice dnd-character-builder-suboptions {\n            --suboptions__width: calc(50% - 20px);\n          }\n        }\n\n        .choices-col__subclass-choice {\n          display: block;\n        }\n\n        .delete-col {\n          margin-right: 16px;\n        }\n        .delete-btn {\n          height: 24px;\n          width: 24px;\n          font-size: 18px;\n          padding: 0;\n          margin-right: 16px;\n          background: none !important;\n        }\n        .delete-btn:before,\n        .delete-btn:after {\n          background: none !important;\n        }\n        .delete-btn:hover {\n          color: var(--mdc-theme-secondary);\n        }\n        .not-edit-mode .delete-btn {\n          display: none;\n        }\n        \n\n        .btn-field {\n          display: inline-flex;\n          flex-direction: row;\n          flex-wrap: nowrap;\n          margin-bottom: 16px;\n          width: 80px;\n          height: 36px;\n          background: var(--lumo-contrast-10pct);\n          border-radius: 4px;\n        }\n        .btn-field--error {\n          background: var(--lumo-error-color-50pct);\n        }\n        .btn-field__btn {\n          display: block;\n          width: 100%;\n        }\n        .btn-field__input {\n          display: none;\n        }\n        .btn-field--open .btn-field__btn {\n          width: 40px;\n        }\n        .btn-field__btn-label-text {\n          position: relative;\n          left: 4px;\n          bottom: 2px;\n        }\n        .btn-field--open .btn-field__btn-label-text {\n          display: none;\n        }\n        .btn-field--open .btn-field__input {\n          display: block;\n          width: 40px;\n          margin-top: -40px;\n        }\n        .btn-field--open .btn-field__btn-label {\n          margin-left: -20px;\n        }\n        .btn-field vaadin-integer-field {\n          --lumo-contrast-10pct: transparent;\n        }\n\n\n        .hp-col {\n          position: absolute;\n          right: 0;\n          top: 8px;\n          overflow: hidden;\n          display: flex;\n        }\n        .not-edit-mode .hp-col {\n          right: 0px;\n        }\n        .hp-col .material-icons {\n          font-size: 20px;\n          position: relative;\n          margin-right: 8px;\n          top: 3px;\n        }\n        .hp-col__non-edit {\n          display: block;\n        }\n        .hp-col .hp-col__non-edit .hp-roll-icon {\n          left: 33px;\n        }\n        .edit-mode .hp-col__non-edit {\n          display: none;\n        }\n        .hp-col__edit {\n          display: none;\n        }\n        .edit-mode .hp-col__edit {\n          display: inline-flex;\n        }\n        .hp-col .hp-roll-icon {\n          position: absolute;\n          left: 18px;\n          font-size: 11px;\n          top: 1px;\n        }\n        .edit-mode .hp-roll-icon {\n          left: 36px;\n          top: 5px;\n        }\n        .btn-field--open .hp-roll-icon {\n          left: 26px;\n        }\n\n        .details {\n          font-size: 15px;\n          width: calc(100% - 30px);\n          margin: 0 auto 13px !important;\n          background: var(--lumo-contrast-10pct);\n          border-radius: 4px;\n          white-space: pre-line;\n          padding: 14px 14px 1px;\n        }\n        .details > .statsBlockHead:first-child > .stat-name {\n          margin-top: 0;\n        }\n\n        @media(min-width: 921px) {\n          .features-col {\n            margin: 0 30px 0 12px;\n            width: unset;\n            font-size: 16px;\n          }\n          #classGrid {\n            margin-bottom: 0;\n          }\n          .class-levels {\n            display: inline;\n          }\n        }\n\n        .no-content-message {\n          padding: 20px;\n          font-size: 14px;\n          font-style: italic;\n        }\n      </style>\n\n      <div class$=\"[[_editModeClass(isEditMode)]]\">\n        <div class=\"heading-wrap\">\n          <h2>Levels <span class=\"class-levels\">[[classLevel]]</span></h2> \n          <dnd-select-add model=\"class-all\" placeholder=\"Add a Class\"></dnd-select-add>\n\n          <div class=\"button-wrap\">\n            <template is=\"dom-repeat\" items=\"[[_objArray(classes)]]\">\n              <dnd-button icon=\"add\" label=\"[[item.name]]\" on-click=\"_addClassLevel\"></dnd-button>\n            </template>\n          </div>\n        </div>\n\n        <div>\n          <div class=\"no-content-message\" hidden$=\"[[!noContentMessage]]\">Enter edit mode to add classes and levels.</div>\n\n          <vaadin-grid id=\"classGrid\" items=[[levels]] theme=\"no-border\" height-by-rows>\n            <vaadin-grid-column flex-grow=\"1\">\n              <template>\n                <div class=\"row\">\n                  <div class=\"open-details\" on-click=\"_expandDetails\">\n                    <div class=\"level-col\">\n                      <span class=\"level-col__level\">[[_level(index)]]</span>\n                      <span class=\"level-col__image-wrap\" ><dnd-svg class=\"level-col__image\" default-color id=\"[[_svgFromClass(item.name)]]\"></dnd-svg></span>\n                      <span class=\"level-col__class\">[[item.name]]</span>\n                    </div>\n\n                    <div class=\"features-col\">\n                      <template is=\"dom-repeat\" items=\"[[_getClassLevelFeatureStringArray(levels, index, classes, subclasses)]]\">\n                        <span class=\"class-feature\" subclass$=\"[[item.isSubclass]]\">[[item.name]]</span>\n                      </template>\n                    </div>\n                  </div>\n\n                  <div class=\"choices-col\">\n                    <template is=\"dom-repeat\" items=\"[[_atIndex(classChoices, index)]]\" as=\"choice\">\n                      <div class=\"choices-col__choice\">\n\n                        <template is=\"dom-if\" if=\"[[_equal(choice.id, 'firstClass')]]\">\n                          <dnd-character-builder-suboptions storage-key=\"firstClass\" selected-item=\"[[choice.suboptions]]\"></dnd-character-builder-suboptions>\n                        </template>\n          \n                        <template is=\"dom-if\" if=\"[[_equal(choice.id, 'replacement')]]\">\n                          <dnd-select-add label=\"Optional Features\" placeholder=\"<Choose Option>\" disabled$=\"[[!isEditMode]]\"\n                            options=\"[[choice.from]]\" value=\"[[choice.selection]]\" add-callback=\"[[_optionalFeatureAddCallback(choice.class, choice.level, choice.feature)]]\"></dnd-select-add>\n                        </template>\n\n                        <template is=\"dom-if\" if=\"[[_equal(choice.id, 'subclass')]]\">\n                          <dnd-select-add class=\"choices-col__subclass-choice\" label=\"Subclass\" placeholder=\"<Choose Subclass>\" disabled$=\"[[!isEditMode]]\"\n                            options=\"[[choice.from]]\" value=\"[[choice.selections]]\" add-callback=\"[[_genSubclassCallback(item)]]\"></dnd-select-add>\n                        </template>\n                        <template is=\"dom-if\" if=\"[[_equal(choice.id, 'asi')]]\">\n                          <dnd-asi-select level-index=\"[[_indexOfLevel(item, levels)]]\" character=\"[[character]]\" disabled$=\"[[!isEditMode]]\"></dnd-asi-select>\n                        </template>\n                        <template is=\"dom-if\" if=\"[[_equal(choice.id, 'classFeature')]]\">\n                          <dnd-select-add choices=\"[[choice.count]]\" label=\"[[choice.name]]\" placeholder=\"<Choose Option>\" disabled$=\"[[!isEditMode]]\"\n                            options=\"[[choice.from]]\" value=\"[[choice.selections]]\" add-callback=\"[[_classFeatureOptionAddCallback(choice.class, choice.level, choice.feature)]]\"></dnd-select-add>\n                        </template>\n                        <template is=\"dom-if\" if=\"[[_equal(choice.id, 'subclassFeature')]]\">\n                          <dnd-select-add choices=\"[[choice.count]]\" label=\"[[choice.name]]\" placeholder=\"<Choose Option>\" disabled$=\"[[!isEditMode]]\"\n                            options=\"[[choice.from]]\" value=\"[[choice.selections]]\" add-callback=\"[[_subclassFeatureOptionAddCallback(choice.class, choice.subclass, choice.level, choice.feature)]]\"></dnd-select-add>\n                        </template>\n                      </div>\n                    </template>\n                  </div>\n\n                  <div class=\"hp-col\">\n                    <div class=\"delete-col\">\n                      <button class=\"delete-btn mdc-icon-button material-icons \"on-click=\"_deleteLevel\">delete</button>\n                    </div>\n                    <div class=\"hp-col__non-edit\">\n                      <span class=\"material-icons \" aria-hidden=\"true\">casino</span>\n                      <span class=\"material-icons hp-roll-icon\" aria-hidden=\"true\">favorite</span>\n                      [[_levelHp(item.name, index)]]\n                    </div>\n                    <div class=\"hp-col__edit btn-field\" data-max$=\"[[_levelHitDice(index, hitDiceMaxes)]]\" data-level$=\"[[index]]\" data-class-name$=\"[[item.name]]\">\n                      <dnd-button background=\"none\" class=\"btn-field__btn\" on-click=\"_toggleHpField\">\n                        <span class=\"btn-field__btn-label\" slot=\"label\">\n                          <span class=\"material-icons \" aria-hidden=\"true\">casino</span>\n                          <span class=\"material-icons hp-roll-icon\" aria-hidden=\"true\">favorite</span>\n                          <span class=\"btn-field__btn-label-text\">[[_levelHp(item.name, index)]]</span>\n                        </span>\n                      </dnd-button>\n                      <vaadin-integer-field class=\"btn-field__input\" min=\"1\" max=\"[[_levelHitDice(index, hitDiceMaxes)]]\"></vaadin-integer-field>\n                    </div>\n                  </div>\n                </div>\n              </template>\n            </vaadin-grid-column>\n          </vaadin-grid>\n        </div>\n      </div>\n    `;\n  }\n}\n\ncustomElements.define(\"dnd-character-builder-class\", DndCharacterBuilderClass);"],"sourceRoot":""}