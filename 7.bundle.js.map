{"version":3,"sources":["webpack:///./node_modules/@vaadin/vaadin-checkbox/src/vaadin-checkbox.js","webpack:///./node_modules/@vaadin/grid/theme/lumo/vaadin-grid-tree-toggle-styles.js","webpack:///./node_modules/@vaadin/grid/src/vaadin-grid-tree-toggle.js","webpack:///./components/views/character/dnd-character-builder-equipment.js"],"names":["console","warn","moduleId","template","document","createElement","innerHTML","head","appendChild","content","level","type","Number","value","observer","leaf","Boolean","reflectToAttribute","expanded","notify","super","ready","this","addEventListener","e","_onClick","target","HTMLLabelElement","preventDefault","toString","style","setProperty","customElements","define","is","DndCharacterBuilderEquipment","inventory","Array","isEditMode","character","Object","expandedItems","expandedIds","activeItem","currencyModalOpen","newPP","newGP","newEP","newSP","newCP","new$","nextActiveItem","prevActiveItem","isMobile","previousScrollPosition","setTimeout","window","scrollTo","scrollY","getBoundingClientRect","y","activeItemTop","innerWidth","length","filter","item","map","uniqueId","connectedCallback","currencyTypes","characterChangeHandler","detail","updateFromCharacter","editModeHandler","$","grid","notifyResize","routeSubSelectionChangeHandler","subSelection","parseInt","bind","routeSubSelectionDeselectedHandler","undefined","disconnectedCallback","removeEventListener","draggedItem","draggedItems","dropMode","dropTargetItem","isChild","containerCapacity","packContents","removeId","storedItem","itemCounter","dropLocation","children","push","dropTargetId","id","finalAddIndex","substring","lastIndexOf","parentItemREF","splice","dataProvider","params","callback","startIndex","page","pageSize","parentItem","slice","set","currency","currencyIsDollars","error","clearCache","dispatchEvent","CustomEvent","bubbles","composed","itemId","model","__data","checkboxEl","classList","add","remove","deleteItemId","_closeDeleteModal","deleteModalOpen","deleteItemName","stopPropagation","name","itemModel","isEquipped","checkbox","querySelector","_flashCheckbox","isAttuned","getEventContext","newQuantity","quantity","isNaN","newItemId","bools","bool","rarity","viewId","isArray","pp","gp","ep","sp","cp","_closeCurrencyModal","key","toLocaleString","val","checked","history","back"],"mappings":"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","file":"7.bundle.js","sourcesContent":["/**\n * @license\n * Copyright (c) 2017 - 2022 Vaadin Ltd.\n * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/\n */\nimport { Checkbox } from '@vaadin/checkbox/src/vaadin-checkbox.js';\n\n/**\n * @deprecated Import `Checkbox` from `@vaadin/checkbox` instead.\n */\nexport const CheckboxElement = Checkbox;\n\nexport * from '@vaadin/checkbox/src/vaadin-checkbox.js';\n\nconsole.warn('WARNING: Since Vaadin 23.2, \"@vaadin/vaadin-checkbox\" is deprecated. Use \"@vaadin/checkbox\" instead.');\n","import '@vaadin/vaadin-lumo-styles/color.js';\nimport '@vaadin/vaadin-lumo-styles/spacing.js';\nimport '@vaadin/vaadin-lumo-styles/style.js';\nimport { css, registerStyles } from '@vaadin/vaadin-themable-mixin/vaadin-themable-mixin.js';\n\nregisterStyles(\n  'vaadin-grid-tree-toggle',\n  css`\n    :host {\n      --vaadin-grid-tree-toggle-level-offset: 2em;\n      align-items: center;\n      vertical-align: middle;\n      transform: translateX(calc(var(--lumo-space-s) * -1));\n      -webkit-tap-highlight-color: transparent;\n    }\n\n    :host(:not([leaf])) {\n      cursor: default;\n    }\n\n    [part='toggle'] {\n      display: inline-block;\n      font-size: 1.5em;\n      line-height: 1;\n      width: 1em;\n      height: 1em;\n      text-align: center;\n      color: var(--lumo-contrast-50pct);\n      cursor: var(--lumo-clickable-cursor);\n      /* Increase touch target area */\n      padding: calc(1em / 3);\n      margin: calc(1em / -3);\n    }\n\n    :host(:not([dir='rtl'])) [part='toggle'] {\n      margin-right: 0;\n    }\n\n    @media (hover: hover) {\n      :host(:hover) [part='toggle'] {\n        color: var(--lumo-contrast-80pct);\n      }\n    }\n\n    [part='toggle']::before {\n      font-family: 'lumo-icons';\n      display: inline-block;\n      height: 100%;\n    }\n\n    :host(:not([expanded])) [part='toggle']::before {\n      content: var(--lumo-icons-angle-right);\n    }\n\n    :host([expanded]) [part='toggle']::before {\n      content: var(--lumo-icons-angle-right);\n      transform: rotate(90deg);\n    }\n\n    /* Experimental support for hierarchy connectors, using an unsupported selector */\n    :host([theme~='connectors']) #level-spacer {\n      position: relative;\n      z-index: -1;\n      font-size: 1em;\n      height: 1.5em;\n    }\n\n    :host([theme~='connectors']) #level-spacer::before {\n      display: block;\n      content: '';\n      margin-top: calc(var(--lumo-space-m) * -1);\n      height: calc(var(--lumo-space-m) + 3em);\n      background-image: linear-gradient(\n        to right,\n        transparent calc(var(--vaadin-grid-tree-toggle-level-offset) - 1px),\n        var(--lumo-contrast-10pct) calc(var(--vaadin-grid-tree-toggle-level-offset) - 1px)\n      );\n      background-size: var(--vaadin-grid-tree-toggle-level-offset) var(--vaadin-grid-tree-toggle-level-offset);\n      background-position: calc(var(--vaadin-grid-tree-toggle-level-offset) / 2 - 2px) 0;\n    }\n\n    /* RTL specific styles */\n\n    :host([dir='rtl']) {\n      margin-left: 0;\n      margin-right: calc(var(--lumo-space-s) * -1);\n    }\n\n    :host([dir='rtl']) [part='toggle'] {\n      margin-left: 0;\n    }\n\n    :host([dir='rtl'][expanded]) [part='toggle']::before {\n      transform: rotate(-90deg);\n    }\n\n    :host([dir='rtl'][theme~='connectors']) #level-spacer::before {\n      background-image: linear-gradient(\n        to left,\n        transparent calc(var(--vaadin-grid-tree-toggle-level-offset) - 1px),\n        var(--lumo-contrast-10pct) calc(var(--vaadin-grid-tree-toggle-level-offset) - 1px)\n      );\n      background-position: calc(100% - (var(--vaadin-grid-tree-toggle-level-offset) / 2 - 2px)) 0;\n    }\n\n    :host([dir='rtl']:not([expanded])) [part='toggle']::before,\n    :host([dir='rtl'][expanded]) [part='toggle']::before {\n      content: var(--lumo-icons-angle-left);\n    }\n  `,\n  { moduleId: 'lumo-grid-tree-toggle' },\n);\n","/**\n * @license\n * Copyright (c) 2016 - 2022 Vaadin Ltd.\n * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/\n */\nimport { html, PolymerElement } from '@polymer/polymer/polymer-element.js';\nimport { DirMixin } from '@vaadin/component-base/src/dir-mixin.js';\nimport { ThemableMixin } from '@vaadin/vaadin-themable-mixin/vaadin-themable-mixin.js';\nimport { isFocusable } from './vaadin-grid-active-item-mixin.js';\n\nconst template = document.createElement('template');\n\ntemplate.innerHTML = `\n  <style>\n    @font-face {\n      font-family: \"vaadin-grid-tree-icons\";\n      src: url(data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAAAQkAA0AAAAABrwAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABGRlRNAAAECAAAABoAAAAcgHwa6EdERUYAAAPsAAAAHAAAAB4AJwAOT1MvMgAAAZQAAAA/AAAAYA8TBIJjbWFwAAAB8AAAAFUAAAFeGJvXWmdhc3AAAAPkAAAACAAAAAgAAAAQZ2x5ZgAAAlwAAABLAAAAhIrPOhFoZWFkAAABMAAAACsAAAA2DsJI02hoZWEAAAFcAAAAHQAAACQHAgPHaG10eAAAAdQAAAAZAAAAHAxVAgBsb2NhAAACSAAAABIAAAASAIAAVG1heHAAAAF8AAAAGAAAACAACgAFbmFtZQAAAqgAAAECAAACTwflzbdwb3N0AAADrAAAADYAAABZQ7Ajh3icY2BkYGAA4twv3Vfi+W2+MnCzMIDANSOmbGSa2YEZRHEwMIEoAAoiB6sAeJxjYGRgYD7w/wADAwsDCDA7MDAyoAI2AFEEAtIAAAB4nGNgZGBg4GBgZgDRDAxMDGgAAAGbABB4nGNgZp7JOIGBlYGBaSbTGQYGhn4IzfiawZiRkwEVMAqgCTA4MDA+38d84P8BBgdmIAapQZJVYGAEAGc/C54AeJxjYYAAxlAIzQTELAwMBxgZGB0ACy0BYwAAAHicY2BgYGaAYBkGRgYQiADyGMF8FgYbIM3FwMHABISMDArP9/3/+/8/WJXC8z0Q9v8nEp5gHVwMMMAIMo+RDYiZoQJMQIKJARUA7WBhGN4AACFKDtoAAAAAAAAAAAgACAAQABgAJgA0AEIAAHichYvBEYBADAKBVHBjBT4swl9KS2k05o0XHd/yW1hAfBFwCv9sIlJu3nZaNS3PXAaXXHI8Lge7DlzF7C1RgXc7xkK6+gvcD2URmQB4nK2RQWoCMRiFX3RUqtCli65yADModOMBLLgQSqHddRFnQghIAnEUvEA3vUUP0LP0Fj1G+yb8R5iEhO9/ef/7FwFwj28o9EthiVp4hBlehcfUP4Ur8o/wBAv8CU+xVFvhOR7UB7tUdUdlVRJ6HnHWTnhM/V24In8JT5j/KzzFSi2E53hUz7jCcrcIiDDwyKSW1JEct2HdIPH1DFytbUM0PofWdNk5E5oUqb/Q6HHBiVGZpfOXkyUMEj5IyBuNmYZQjBobfsuassvnkKLe1OuBBj0VQ8cRni2xjLWsHaM0jrjx3peYA0/vrdmUYqe9iy7bzrX6eNP7Jh1SijX+AaUVbB8AAHicY2BiwA84GBgYmRiYGJkZmBlZGFkZ2djScyoLMgzZS/MyDQwMwLSruZMzlHaB0q4A76kLlwAAAAEAAf//AA94nGNgZGBg4AFiMSBmYmAEQnYgZgHzGAAD6wA2eJxjYGBgZACCKxJigiD6mhFTNowGACmcA/8AAA==) format('woff');\n      font-weight: normal;\n      font-style: normal;\n    }\n  </style>\n`;\n\ndocument.head.appendChild(template.content);\n\n/**\n * `<vaadin-grid-tree-toggle>` is a helper element for the `<vaadin-grid>`\n * that provides toggle and level display functionality for the item tree.\n *\n * #### Example:\n * ```html\n * <vaadin-grid-column id=\"column\"></vaadin-grid-column>\n * ```\n * ```js\n * const column = document.querySelector('#column');\n * column.renderer = (root, column, model) => {\n *   let treeToggle = root.firstElementChild;\n *   if (!treeToggle) {\n *     treeToggle = document.createElement('vaadin-grid-tree-toggle');\n *     treeToggle.addEventListener('expanded-changed', () => { ... });\n *     root.appendChild(treeToggle);\n *   }\n *   treeToggle.leaf = !model.item.hasChildren;\n *   treeToggle.level = level;\n *   treeToggle.expanded = expanded;\n *   treeToggle.textContent = model.item.name;\n * };\n * ```\n *\n * ### Styling\n *\n * The following shadow DOM parts are available for styling:\n *\n * Part name | Description\n * ---|---\n * `toggle` | The tree toggle icon\n *\n * The following state attributes are available for styling:\n *\n * Attribute    | Description | Part name\n * ---|---|---\n * `expanded` | When present, the toggle is expanded | :host\n * `leaf` | When present, the toggle is not expandable, i. e., the current item is a leaf | :host\n *\n * The following custom CSS properties are available on\n * the `<vaadin-grid-tree-toggle>` element:\n *\n * Custom CSS property | Description | Default\n * ---|---|---\n * `--vaadin-grid-tree-toggle-level-offset` | Visual offset step for each tree sublevel | `1em`\n *\n * @fires {CustomEvent} expanded-changed - Fired when the `expanded` property changes.\n *\n * @extends HTMLElement\n * @mixes ThemableMixin\n */\nclass GridTreeToggle extends ThemableMixin(DirMixin(PolymerElement)) {\n  static get template() {\n    return html`\n      <style>\n        :host {\n          display: inline-flex;\n          align-items: baseline;\n          max-width: 100%;\n\n          /* CSS API for :host */\n          --vaadin-grid-tree-toggle-level-offset: 1em;\n          --_collapsed-icon: '\\\\e7be\\\\00a0';\n        }\n\n        :host([dir='rtl']) {\n          --_collapsed-icon: '\\\\e7bd\\\\00a0';\n        }\n\n        :host([hidden]) {\n          display: none !important;\n        }\n\n        :host(:not([leaf])) {\n          cursor: pointer;\n        }\n\n        #level-spacer,\n        [part='toggle'] {\n          flex: none;\n        }\n\n        #level-spacer {\n          display: inline-block;\n          width: calc(var(---level, '0') * var(--vaadin-grid-tree-toggle-level-offset));\n        }\n\n        [part='toggle']::before {\n          font-family: 'vaadin-grid-tree-icons';\n          line-height: 1em; /* make icon font metrics not affect baseline */\n        }\n\n        :host(:not([expanded])) [part='toggle']::before {\n          content: var(--_collapsed-icon);\n        }\n\n        :host([expanded]) [part='toggle']::before {\n          content: '\\\\e7bc\\\\00a0'; /* icon glyph + single non-breaking space */\n        }\n\n        :host([leaf]) [part='toggle'] {\n          visibility: hidden;\n        }\n\n        slot {\n          display: block;\n          overflow: hidden;\n          text-overflow: ellipsis;\n        }\n      </style>\n\n      <span id=\"level-spacer\"></span>\n      <span part=\"toggle\"></span>\n      <slot></slot>\n    `;\n  }\n\n  static get is() {\n    return 'vaadin-grid-tree-toggle';\n  }\n\n  static get properties() {\n    return {\n      /**\n       * Current level of the tree represented with a horizontal offset\n       * of the toggle button.\n       * @type {number}\n       */\n      level: {\n        type: Number,\n        value: 0,\n        observer: '_levelChanged',\n      },\n\n      /**\n       * Hides the toggle icon and disables toggling a tree sublevel.\n       * @type {boolean}\n       */\n      leaf: {\n        type: Boolean,\n        value: false,\n        reflectToAttribute: true,\n      },\n\n      /**\n       * Sublevel toggle state.\n       * @type {boolean}\n       */\n      expanded: {\n        type: Boolean,\n        value: false,\n        reflectToAttribute: true,\n        notify: true,\n      },\n    };\n  }\n\n  /** @protected */\n  ready() {\n    super.ready();\n\n    this.addEventListener('click', (e) => this._onClick(e));\n  }\n\n  /** @private */\n  _onClick(e) {\n    if (this.leaf) {\n      return;\n    }\n    if (isFocusable(e.target) || e.target instanceof HTMLLabelElement) {\n      return;\n    }\n\n    e.preventDefault();\n    this.expanded = !this.expanded;\n  }\n\n  /** @private */\n  _levelChanged(level) {\n    const value = Number(level).toString();\n    this.style.setProperty('---level', value);\n  }\n}\n\ncustomElements.define(GridTreeToggle.is, GridTreeToggle);\n\nexport { GridTreeToggle };\n","import { PolymerElement, html } from \"@polymer/polymer\";\nimport { \n  getCharacterChannel,\n  getSelectedCharacter,\n  getItems,\n  removeItem,\n  canAttuneItem,\n  canEquipItem,\n  toggleItemEquipped,\n  toggleItemAttuned,\n  setItem,\n  spliceItems,\n  isChildItem,\n  getItemAtId,\n  addItem,\n  saveCharacter\n} from \"../../../util/charBuilder\";\nimport \"../../dnd-icon\";\nimport { dispatchEditModeChange, getEditModeChannel, isEditMode } from \"../../../util/editMode\";\nimport '@vaadin/polymer-legacy-adapter/template-renderer.js';\nimport \"@vaadin/vaadin-checkbox\";\nimport \"@vaadin/vaadin-grid\";\nimport \"@vaadin/vaadin-grid/vaadin-grid-tree-toggle\";\nimport \"@vaadin/vaadin-grid/vaadin-grid-column\";\nimport \"@vaadin/vaadin-text-field/vaadin-integer-field\";\nimport \"./dnd-character-builder-equipment-item-detail\";\nimport { clearRouteSubSelection, readRouteSubSelection, routeEventChannel, setRouteSubSelection } from \"../../../util/routing\";\n\nclass DndCharacterBuilderEquipment extends PolymerElement {\n  \n  static get properties() {\n    return {\n      inventory: {\n        type: Array\n      },\n      isEditMode: {\n        type: Boolean,\n        value: false\n      },\n      character: {\n        type: Object,\n      },\n      expandedItems: {\n        type: Array\n      },\n      expandedIds: {\n        type: Array\n      },\n      activeItem: {\n        type: Object,\n        value: null,\n        observer: '_activeItemChange'\n      },\n      currencyModalOpen: {\n        type: Boolean,\n        value: false\n      },\n      newPP: {\n        type: Number,\n      },\n      newGP: {\n        type: Number,\n      },\n      newEP: {\n        type: Number,\n      },\n      newSP: {\n        type: Number,\n      },\n      newCP: {\n        type: Number,\n      },\n      new$: {\n        type: Number,\n      },\n    };\n  }\n\n  static get observers() {\n    return [\n      '_expandedItemsChange(expandedItems.*)'\n    ]\n  }\n\n  _activeItemChange(nextActiveItem, prevActiveItem) {\n    if ((!prevActiveItem || !this.isMobile() )&& nextActiveItem) {\n      this.previousScrollPosition = window.scrollY;\n      if (this.getBoundingClientRect().y < 0) {\n        const activeItemTop = window.scrollY + this.getBoundingClientRect().y - 57;\n        setTimeout(() => {\n          window.scrollTo(0, activeItemTop);\n        }, 0);\n      }\n    } else if (!nextActiveItem && prevActiveItem && this.previousScrollPosition && this.isMobile()) {\n      setTimeout(() => {\n        window.scrollTo(0, this.previousScrollPosition);\n        this.previousScrollPosition = 0;\n      }, 0);\n    }\n  }\n\n  isMobile() {\n    return window.innerWidth <= 768;\n  }\n\n  _expandedItemsChange() {\n    if (this.expandedItems && this.expandedItems.length) {\n      this.expandedIds = this.expandedItems.filter(item => !!item).map((item) => item.uniqueId);\n    }\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n\n    this.currencyTypes = [\"Platinum\", \"Gold\", \"Silver\", \"Copper\", \"Dollars\"];\n\n    this.characterChangeHandler = (e) => {\n      let character = e.detail.character;\n      this.updateFromCharacter(character);\n    };\n    \n    this.updateFromCharacter(getSelectedCharacter());\n    getCharacterChannel().addEventListener(\"character-selected\", this.characterChangeHandler);\n\n    this.editModeHandler = (e) => {\n      this.isEditMode = e.detail.isEditMode;\n      if (this.$.grid) {\n        setTimeout(() => {\n          this.$.grid.notifyResize();\n        }, 0);\n      }\n    }\n    getEditModeChannel().addEventListener('editModeChange', this.editModeHandler);\n    this.isEditMode = isEditMode();\n\n    this.routeSubSelectionChangeHandler = ((e) => {\n      const subSelection = e.detail.subSelection;\n      if (this.inventory) {\n        this.activeItem = getItemAtId(this.inventory, parseInt(subSelection));\n      }\n    }).bind(this);\n    routeEventChannel().addEventListener('sub-selection-change', this.routeSubSelectionChangeHandler);\n\n    this.routeSubSelectionDeselectedHandler = (() => {\n      this.activeItem = undefined;\n    }).bind(this);\n    routeEventChannel().addEventListener('sub-selection-deselected', this.routeSubSelectionDeselectedHandler);\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n\n    getCharacterChannel().removeEventListener(\"character-selected\", this.characterChangeHandler);\n    getEditModeChannel().removeEventListener('editModeChange', this.editModeHandler);\n    routeEventChannel().removeEventListener('selection-change', this.routeSubSelectionDeselectedHandler);\n    routeEventChannel().removeEventListener('sub-selection-change', this.routeSubSelectionChangeHandler);\n  }\n\n  ready() {\n    super.ready();\n    \n    setTimeout(() => {\n      const grid = this.$.grid;\n\n      // Add Drag and Drop\n      let draggedItem;\n\n      grid.addEventListener('grid-dragstart', function(e) {\n        draggedItem = e.detail.draggedItems[0];\n        grid.dropMode = 'on-top-or-between';\n      });\n\n      grid.addEventListener('grid-dragend', function(e) {\n        draggedItem = grid.dropMode = null;\n      });\n\n      grid.addEventListener('grid-drop', (e) => {\n        const dropTargetItem = e.detail.dropTargetItem;\n        if (draggedItem && draggedItem !== dropTargetItem) {\n\n          // Prevent loops\n          const isChild = isChildItem(draggedItem, dropTargetItem.uniqueId);\n          if ((draggedItem.containerCapacity || draggedItem.packContents) && isChild) {\n            return;\n          }\n\n          const removeId = draggedItem.storedItem.uniqueId;\n          draggedItem.storedItem.uniqueId = this.character.itemCounter ++;\n\n          // Dropping into container\n          if (e.detail.dropLocation === 'on-top') {\n            if (dropTargetItem.containerCapacity || dropTargetItem.packContents) {\n              if (dropTargetItem.storedItem && dropTargetItem.storedItem.children) {\n                // Add child item\n                dropTargetItem.storedItem.children.push(draggedItem.storedItem);\n                setItem(dropTargetItem, undefined, true);\n                // Remove original\n                removeItem(removeId);\n              }\n              return;\n            }\n          }\n\n          // Re-ordering items, default action if 'on-top' of non-container\n          if (this.inventory) {\n            // Adjust final add index for dropLocation 'below' or 'above'\n            const dropTargetId = `${dropTargetItem.id}`;\n            let finalAddIndex = parseInt(dropTargetId.substring(dropTargetId.lastIndexOf('_')), 10);\n            if (e.detail.dropLocation === 'below') {\n              finalAddIndex++;\n            }\n\n            if (dropTargetItem.parentItemREF) {\n              // Add child item\n              dropTargetItem.parentItemREF.storedItem.children.splice(finalAddIndex, 0, draggedItem.storedItem);\n              setItem(dropTargetItem.parentItemREF, undefined, true);\n            } else {\n              // Add top-level item\n              spliceItems(finalAddIndex, draggedItem.storedItem);\n            }\n\n            // Remove original item\n            removeItem(removeId);\n          }\n        }\n      });\n\n      // Set Data Provider\n      grid.dataProvider = ((params, callback) => {\n        const startIndex = params.page * params.pageSize;\n        let children = params.parentItem ? params.parentItem.children : this.inventory;\n        if (children && children.length) {\n          const page = children.slice(startIndex, startIndex + params.pageSize);\n          callback(page, children.length);\n        }\n      }).bind(this);\n    }, 0);\n  }\n\n  async updateFromCharacter(character) {\n    if (character) {\n      this.character = character;\n      this.set('currency', null);\n      this.set('currency', character.currency);\n      this.currencyIsDollars = !!character.currencyIsDollars;\n      this.inventory = await getItems(character);\n      console.error('inventory:', this.inventory);\n      this.$.grid.clearCache();\n      if (this.expandedIds) {\n        const expandedItems = this.expandedIds.map((id) => {\n          return getItemAtId(this.inventory, id);\n        });\n        this.expandedItems = expandedItems;\n      }\n      if (readRouteSubSelection()) {\n        this.activeItem = getItemAtId(this.inventory, parseInt(readRouteSubSelection()));\n      }\n      this.dispatchEvent(new CustomEvent(\"loadingChange\", { bubbles: true, composed: true }));\n    }\n  }\n\n  _expandDetails(e) {\n    let itemId = e.model.__data.item.uniqueId,\n      stayClosed = readRouteSubSelection() === itemId;\n    if (stayClosed) {\n      clearRouteSubSelection();\n    } else {\n      setRouteSubSelection(itemId);\n    }\n  }\n\n  _flashCheckbox(checkboxEl) {\n    if (checkboxEl) {\n      checkboxEl.classList.add('transition-bg');\n      checkboxEl.classList.add('flash-error');\n      setTimeout(() => {\n        checkboxEl.classList.remove('flash-error');\n        setTimeout(() => {\n          checkboxEl.classList.remove('transition-bg');\n        }, 200);\n      }, 200);\n    }\n  }\n\n  _deleteItem() {\n    removeItem(this.deleteItemId);\n    this._closeDeleteModal();\n  }\n\n  _closeDeleteModal() {\n    this.deleteModalOpen = false;\n    setTimeout(() => {\n      this.deleteItemId = null;\n      this.deleteItemName = null;\n    }, 200);\n  }\n  \n  _openDeleteModal(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    if (e.model.__data.item) {\n      this.deleteItemId = e.model.__data.item.uniqueId;\n      this.deleteItemName = e.model.__data.item.name;\n    }\n    this.deleteModalOpen = true;\n  }\n\n  async _setItemEquipped(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    let itemModel = e.model.__data.item;\n    let uniqueId = itemModel ? itemModel.uniqueId : undefined;\n    let isEquipped = itemModel ? itemModel.isEquipped : false;\n    \n    if (isEquipped) {\n      toggleItemEquipped(uniqueId);\n    } else if (await canEquipItem(itemModel)) {\n      toggleItemEquipped(uniqueId);\n    } else {\n      let checkbox = e.target.querySelector('vaadin-checkbox')\n      this._flashCheckbox(checkbox)\n    }\n  }\n\n  async _setItemAttuned(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    let itemModel = e.model.__data.item;\n    let uniqueId = itemModel ? itemModel.uniqueId : undefined;\n    let isAttuned = itemModel ? itemModel.isAttuned : false;\n\n    if (isAttuned) {\n      toggleItemAttuned(uniqueId);\n    } else if (await canAttuneItem(itemModel)) {\n      toggleItemAttuned(uniqueId);\n    } else {\n      let checkbox = e.target.querySelector('vaadin-checkbox')\n      this._flashCheckbox(checkbox)\n    }\n  }\n\n  _quantityChange(e) {\n    const item = this.$.grid.getEventContext(e).item;\n    let newQuantity = parseInt(item.quantity, 10);\n    if (isNaN(newQuantity)) {\n      newQuantity = 0;\n    }\n\n    item.storedItem.quantity = newQuantity;\n    setItem(item);\n  }\n\n  _addItem() {\n    const newItemId = addItem({name: ''}, false);\n    dispatchEditModeChange(true);\n    setTimeout(() => {\n      setRouteSubSelection(newItemId);\n    }, 0);\n  }\n\n  _preventDefault(e) {\n    e.preventDefault();\n    e.stopPropagation();\n  }\n\n  _or(...bools) {\n    for (let bool of bools) {\n      if (bool) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  _noRarity(rarity) {\n    return !rarity || rarity === 'None';\n  }\n\n  _toggleTheme(item) {\n    return item.children && item.children.length === 0 ? 'no-children' : '';\n  }\n\n  _linkClick() {\n    this.dispatchEvent(new CustomEvent(\"open-drawer\", {\n      bubbles: true,\n      composed: true,\n      detail: {\n        viewId: 'items'\n      }\n    }));\n  }\n\n  _openCurrencyModal() {\n    this.currencyModalOpen = true;\n  }\n\n  _closeCurrencyModal() {\n    this.newPP = null;\n    this.newGP = null;\n    this.newEP = null;\n    this.newSP = null;\n    this.newCP = null;\n    this.new$ = null;\n    this.currencyModalOpen = false;\n  }\n\n  _addCurrency() {\n    if (!this.character.currency || Array.isArray(this.character.currency)) {\n      this.character.currency = {};\n    }\n    if (this.character.currencyIsDollars) {\n      this.character.currency.$  = parseInt(this.character.currency.$ || 0)  + parseInt(this.new$ || 0);\n    } else {\n      this.character.currency.pp = parseInt(this.character.currency.pp || 0) + parseInt(this.newPP || 0);\n      this.character.currency.gp = parseInt(this.character.currency.gp || 0) + parseInt(this.newGP || 0);\n      this.character.currency.ep = parseInt(this.character.currency.ep || 0) + parseInt(this.newEP || 0);\n      this.character.currency.sp = parseInt(this.character.currency.sp || 0) + parseInt(this.newSP || 0);\n      this.character.currency.cp = parseInt(this.character.currency.cp || 0) + parseInt(this.newCP || 0);\n    }\n    saveCharacter(this.character);\n    this._closeCurrencyModal();\n  }\n\n  _removeCurrency() {\n    if (this.character.currencyIsDollars) {\n      if (parseInt(this.character.currency.$ || 0)  - parseInt(this.new$ || 0) < 0) {\n        return false;\n      }\n      this.character.currency.$  = parseInt(this.character.currency.$ || 0)  - parseInt(this.new$ || 0);\n    } else {\n      if (parseInt(this.character.currency.pp || 0) - parseInt(this.newPP || 0) < 0 ||\n          parseInt(this.character.currency.gp || 0) - parseInt(this.newGP || 0) < 0 ||\n          parseInt(this.character.currency.ep || 0) - parseInt(this.newEP || 0) < 0 ||\n          parseInt(this.character.currency.sp || 0) - parseInt(this.newSP || 0) < 0 || \n          parseInt(this.character.currency.cp || 0) - parseInt(this.newCP || 0) < 0) {\n        return false;\n      }\n      this.character.currency.pp = parseInt(this.character.currency.pp || 0) - parseInt(this.newPP || 0);\n      this.character.currency.gp = parseInt(this.character.currency.gp || 0) - parseInt(this.newGP || 0);\n      this.character.currency.ep = parseInt(this.character.currency.ep || 0) - parseInt(this.newEP || 0);\n      this.character.currency.sp = parseInt(this.character.currency.sp || 0) - parseInt(this.newSP || 0);\n      this.character.currency.cp = parseInt(this.character.currency.cp || 0) - parseInt(this.newCP || 0);\n    }\n    saveCharacter(this.character);\n    this._closeCurrencyModal();\n  }\n\n  _getCurrencyValue(key, currency) {\n    return currency && currency[key] ? currency[key].toLocaleString() : 0;\n  }\n\n  _setCurrencyType(val) {\n    this.character.currencyIsDollars = val.detail.checked;\n    saveCharacter(this.character);\n  }\n  \n  _currencyColor(currencyIsDollars) {\n    return currencyIsDollars ? \"Dollars\" : \"Gold\";\n  }\n  \n  _isActive(activeItem, item) {\n    return activeItem === item;\n  }\n\n  _hasActive(activeItem) {\n    return !!activeItem;\n  }\n\n  _clearSelection() {\n    window.history.back();\n  }\n\n  _isLeaf(item) {\n    return !item.containerCapacity && !item.packContents;\n  }\n\n  static get template() {\n    return html`\n      <style include=\"material-styles fa-styles\"></style>\n      <style>\n        :host {\n          display: block;\n          padding: 14px;\n        }\n        [hidden] {\n          display: none !important;\n        }\n        a {\n          color: var(--mdc-theme-secondary);\n        }\n\n        vaadin-grid {\n          margin-bottom: var(--tab-bottom-margin);\n          border-top: 1px solid var(--_lumo-grid-secondary-border-color);\n        }\n\n        .heading {\n          display: flex;\n          flex-direction: row;\n          align-items: center;\n          border-bottom: 1px solid var(--lumo-contrast-10pct);\n        }\n        .reference-link {\n          margin-right: auto;\n        }\n        .mdc-icon-button:hover {\n          color: var(--mdc-theme-primary);\n        }\n        .add-item {\n          position: relative;\n        }\n        .add-item__tiny {\n          position: absolute;\n          font-size: 14px;\n          top: 2px;\n          right: 4px;\n        }\n\n        .col-wrap {\n          display: flex; \n          justify-content: space-between;\n          flex-wrap: wrap;\n        }\n\n        .row-wrap {\n          width: 100%;\n        }\n\n        .no-content {\n          font-size: 14px;\n          font-style: italic;\n        }\n\n        .item-wrap {\n          display: flex;\n          flex-wrap: nowrap;\n          flex-direction: row;\n          justify-content: space-between;\n          align-items: center;\n          padding: 10px 6px;\n          min-height: 28px;\n          border-bottom: 1px solid var(--_lumo-grid-secondary-border-color);\n        }\n        .item-wrap__name-wrap {\n          flex-basis: 100%;\n          min-width: 0;\n          display: flex;\n          flex-direction: column;\n          cursor: pointer;\n          min-height: 28px;\n        }\n        .item-wrap__name-wrap:hover {\n          color: var(--mdc-theme-primary);\n        }\n        .item-wrap__name {\n          font-weight: bold;\n          overflow: hidden;\n          text-overflow: ellipsis;\n          white-space: nowrap;\n          position: relative;\n        }\n        .item-wrap__edited,\n        .item-wrap__from {\n          background-color: var(--mdc-theme-text-disabled-on-background);\n          color: var(--mdc-theme-on-secondary);\n          border: none;\n          border-radius: 4px;\n          outline: none;\n          display: inline-block;\n          justify-content: center;\n          white-space: normal;\n          font-size: 10px;\n          padding: 1px 4px;\n          margin-right: 4px;\n          font-style: italic;\n        }\n        .item-wrap__edited {\n          top: -1px;\n          position: relative;\n          font-weight: normal;\n        }\n        .item-wrap__type {\n          font-style: italic;\n          font-size: 12px;\n          overflow: hidden;\n          text-overflow: ellipsis;\n          white-space: nowrap;\n          position: relative;\n        }\n        .item-wrap__type--fromBackground {\n          padding-right: 38px;\n        }\n        .item-wrap__type--fromClass {\n          padding-right: 50px;\n        }\n        .item-wrap__close {\n          font-size: 14px;\n          cursor: pointer;\n          background: none;\n          border: none;\n          height: 100%;\n          padding: 11px;\n          margin-left: 5px;\n          color: var(--mdc-theme-on-surface);\n        }\n        .item-wrap__checkboxes {\n          display: flex;\n          flex-direction: column;\n          width: 80px;\n          flex-grow: 0;\n          flex-shrink: 0;\n          margin-left: auto;\n        }\n        .item-wrap__checkboxes > span {\n          cursor: pointer;\n        }\n        .item-wrap__quantity {\n          display: flex;\n          flex-direction: column;\n          width: 80px;\n          flex-grow: 0;\n          flex-shrink: 0;\n          margin-left: auto;\n        }\n        vaadin-integer-field {\n          margin: -13px 0 5px;\n        }\n        vaadin-checkbox {\n          pointer-events: none;\n          font-size: 13px;\n        }\n        vaadin-checkbox.flash-error {\n          color: var(--mdc-theme-error);\n          transition: color 0.2s ease-out;\n          --lumo-contrast-20pct: var(--mdc-theme-error);\n        }\n        vaadin-checkbox.transition-bg {\n          transition: color 0.2s ease-in;\n        }\n\n        .details {\n          font-size: 14px;\n          width: calc(100% - 30px);\n          margin: 0 auto 13px !important;\n          background: var(--lumo-contrast-10pct);\n          border-radius: 4px;\n          padding: 14px;\n        }\n        \n        .details-row {\n          padding-top: 14px;\n          position: relative;\n          padding-bottom: 220px;\n        }\n\n        .details-wrap {\n          font-size: 14px;\n          background: var(--lumo-contrast-10pct);\n          border-radius: 4px;\n          line-height: 1.5;\n          padding: 14px;\n        }\n\n        .close-item {\n          margin-left: auto;\n          font-size: 32px;\n        }\n\n        .currency {\n          margin: 20px 0;\n          display: flex;\n          margin-left: auto;\n          align-items: center;\n          width: fit-content;\n        }\n        .currency-change {\n          margin-left: 12px;\n        }\n        .currency-wrap {\n          padding-left: 30px;\n          display: flex;\n          justify-content: flex-end;\n          flex-wrap: wrap;\n          align-items: baseline;\n          gap: 10px;\n        }\n        .currency-item {\n          display: flex;\n          position: relative;\n          align-items: baseline;\n        }\n        .currency-item__value {\n          font-weight: bold;\n          font-size: 24px;\n          margin-right: 4px;\n        }\n        .currency-item__label {\n          color: grey;\n          font-size: 16px;\n          font-weight: normal;\n        }\n        .currency-item__icon {\n          margin-right: 4px;\n          font-size: 18px;\n          position: relative;\n          top: -2px;\n        }\n        .currency-item--dollars .currency-item__value {\n          font-size: 32px;\n          font-weight: normal;\n        }\n        .currency-item--dollars .currency-item__icon {\n          font-size: 32px;\n          font-weight: normal;\n          top: 0;\n        }\n        [currency=\"Dollars\"] {\n          color: green;\n        }\n        [currency=\"Electrum\"] {\n          color: #8898A4;\n        }\n        [currency=\"Platinum\"] {\n          color: #B2B2B2;\n        }\n        [currency=\"Gold\"] {\n          color: #ECA824;\n        }\n        [currency=\"Silver\"] {\n          color: #CEC6BF;\n        }\n        [currency=\"Copper\"] {\n          color: #C2876F;\n        }\n        .currency-item:focus .tooltip,\n        .currency-item:hover .tooltip {\n          display: block;\n        }\n        .currency-item:focus {\n          outline: none;\n        }\n        .tooltip {\n          position: absolute;\n          background: lightgray;\n          color: black;\n          font-size: 14px;\n          padding: 2px 10px;\n          border-radius: 4px;\n          white-space: nowrap;\n          left: 5px;\n          top: -32px;\n          display: none;\n        }\n        .tooltip::after {\n          content: '';\n          height: 0;\n          width: 0;\n          position: absolute;\n          border-left: 5px solid transparent;\n          border-right: 5px solid transparent;\n          border-top: 5px solid lightgray;\n          bottom: -4px;\n          left: 2px;\n        }\n\n        @media(min-width: 420px) {\n          .heading {\n            justify-content: flex-start;\n          }\n          .reference-link {\n            margin-left: 8px;\n          }\n        }\n\n        @media(min-width: 921px) {\n          .reference-link,\n          .add-item {\n            display: block !important;\n          }\n          .item-wrap[active] {\n            background: var(--lumo-primary-color-10pct);\n          }\n          .row-wrap {\n            width: calc(50% - 10px);\n          }\n          .row-wrap:first-child {\n            margin-bottom: 0;\n          }\n          .details {\n            display: none;\n          }\n          .item-list-row[hidden]{\n            display: block !important;\n          }\n          .details-wrap {\n            display: block;\n          }\n          .close-item {\n            display: none;\n          }\n        }\n      </style>\n\n      <div class=\"heading\">\n        <h2>Inventory</h2>\n        <button class=\"mdc-icon-button reference-link material-icons\" hidden$=\"[[_hasActive(activeItem)]]\" on-click=\"_linkClick\">logout</button>\n        <button class=\"mdc-icon-button add-item\" hidden$=\"[[_hasActive(activeItem)]]\" on-click=\"_addItem\">\n          <dnd-icon class=\"add-item__tiny\" icon=\"plus\"></dnd-icon>\n          <dnd-icon icon=\"sack\"></dnd-icon>\n        </button>\n        <button class=\"mdc-icon-button close-item material-icons mdc-theme--on-header\" hidden$=\"[[!_hasActive(activeItem)]]\" on-click=\"_clearSelection\">close</button>\n      </div>\n      <div class=\"col-wrap\">\n        <div class=\"row-wrap item-list-row\" hidden$=\"[[_hasActive(activeItem)]]\">\n          <div class=\"currency\">\n            <div hidden$=[[currencyIsDollars]] class=\"currency-wrap\">\n              <div hidden$='[[!_getCurrencyValue(\"pp\", currency)]]' class=\"currency-item\" tabindex=\"0\">\n                <div class=\"currency-item__value\">[[_getCurrencyValue(\"pp\", currency)]]</div>\n                <dnd-icon class=\"currency-item__icon\" icon=\"coins\" currency=\"Platinum\"></dnd-icon>\n                <div class=\"currency-item__label\">pp</div>\n                <div class=\"tooltip\">1pp = 10gp</div>\n              </div>\n              <div hidden$='[[!_getCurrencyValue(\"gp\", currency)]]' class=\"currency-item\">\n                <div class=\"currency-item__value\">[[_getCurrencyValue(\"gp\", currency)]]</div>\n                <dnd-icon class=\"currency-item__icon\" icon=\"coins\" currency=\"Gold\"></dnd-icon>\n                <div class=\"currency-item__label\">gp</div>\n              </div>\n              <div hidden$='[[!_getCurrencyValue(\"ep\", currency)]]' class=\"currency-item\" tabindex=\"0\">\n                <div class=\"currency-item__value\">[[_getCurrencyValue(\"ep\", currency)]]</div>\n                <dnd-icon class=\"currency-item__icon\" icon=\"coins\" currency=\"Electrum\"></dnd-icon>\n                <div class=\"currency-item__label\">ep</div>\n                <div class=\"tooltip\">1gp = 2ep</div>\n              </div>\n              <div hidden$='[[!_getCurrencyValue(\"sp\", currency)]]' class=\"currency-item\" tabindex=\"0\">\n                <div class=\"currency-item__value\">[[_getCurrencyValue(\"sp\", currency)]]</div>\n                <dnd-icon class=\"currency-item__icon\" icon=\"coins\" currency=\"Silver\"></dnd-icon>\n                <div class=\"currency-item__label\">sp</div>\n                <div class=\"tooltip\">1gp = 10sp</div>\n              </div>\n              <div class=\"currency-item\" tabindex=\"0\">\n                <div class=\"currency-item__value\">[[_getCurrencyValue(\"cp\", currency)]]</div>\n                <dnd-icon class=\"currency-item__icon\" icon=\"coins\" currency=\"Copper\"></dnd-icon>\n                <div class=\"currency-item__label\">cp</div>\n                <div class=\"tooltip\">1gp = 100cp</div>\n              </div>\n            </div>\n            <div hidden$=[[!currencyIsDollars]] class=\"currency-wrap\">\n              <div class=\"currency-item currency-item--dollars\">\n                <dnd-icon class=\"currency-item__icon\" icon=\"dollar-sign\" currency=\"Dollars\"></dnd-icon>\n                <div class=\"currency-item__value\">[[_getCurrencyValue(\"$\", currency)]]</div>\n              </div>\n            </div>\n            <button class=\"currency-change mdc-icon-button\" on-click=\"_openCurrencyModal\"><dnd-icon icon=\"sack-dollar\"></dnd-icon></button>\n\n            <vaadin-dialog opened=\"{{currencyModalOpen}}\">\n              <template>\n                <style>\n                  [hidden] {\n                    display: none !important;\n                  }\n                  h3 {\n                    margin-top: 0;\n                    margin-bottom: 30px;\n                    display: flex;\n                    min-width: 260px;\n                  }\n                  dnd-switch {\n                    margin-left: auto;\n                  }\n                  dnd-icon {\n                    font-size: 18px;\n                  }\n                  .modal-content {\n                    display: flex;\n                    justify-content: center;\n                    flex-wrap: wrap;\n                  }\n                  .modal-footer {\n                    display: flex;\n                    justify-content: center;\n                    margin-top: 30px;\n                    flex-wrap: wrap;\n                  }\n                  .modal-footer dnd-button:last-child {\n                    /* margin: 12px auto 0; */\n                    --mdc-theme-primary: var(--mdc-theme-error);\n                  }\n                  .modal-footer dnd-button:not(:last-child) {\n                    margin-right: 12px;\n                  }\n                  [currency=\"Dollars\"] {\n                    --mdc-theme-primary: green;\n                  }\n                  [currency=\"Electrum\"] {\n                    --mdc-theme-primary: #8898A4;\n                  }\n                  [currency=\"Platinum\"] {\n                    --mdc-theme-primary: #B2B2B2;\n                  }\n                  [currency=\"Gold\"] {\n                    --mdc-theme-primary: #ECA824;\n                  }\n                  [currency=\"Silver\"] {\n                    --mdc-theme-primary: #CEC6BF;\n                  }\n                  [currency=\"Copper\"] {\n                    --mdc-theme-primary: #C2876F;\n                  }\n                  vaadin-integer-field {\n                    margin-top: 0;\n                    width: 90px;\n                  }\n                  .dollars {\n                    width: 160px;\n                  }\n                </style>\n                <h3>\n                  Adjust Currency\n                  <dnd-switch no-color initial-value={{currencyIsDollars}} on-switch-change=\"_setCurrencyType\">\n                    <dnd-icon icon=\"coins\" style=\"color: #ECA824;\" slot=\"label\"></dnd-icon>\n                    <dnd-icon icon=\"dollar-sign\" style=\"color: green;\" slot=\"secondaryLabel\"></dnd-icon>\n                  </dnd-switch>\n                </h3>\n                <div class=\"modal-content\" hidden$=[[currencyIsDollars]]>\n                  <vaadin-integer-field theme=\"mini\" padded has-controls min=\"0\" id=\"pp\" value=\"{{newPP}}\" currency=\"Platinum\" label=\"Platinum (pp)\"></vaadin-integer-field>\n                  <vaadin-integer-field theme=\"mini\" padded has-controls min=\"0\" id=\"gp\" value=\"{{newGP}}\" currency=\"Gold\" label=\"Gold (gp)\"></vaadin-integer-field>\n                  <vaadin-integer-field theme=\"mini\" padded has-controls min=\"0\" id=\"ep\" value=\"{{newEP}}\" currency=\"Electrum\" label=\"Electrum (ep)\"></vaadin-integer-field>\n                  <vaadin-integer-field theme=\"mini\" padded has-controls min=\"0\" id=\"sp\" value=\"{{newSP}}\" currency=\"Silver\" label=\"Silver (sp)\"></vaadin-integer-field>\n                  <vaadin-integer-field theme=\"mini\" padded has-controls min=\"0\" id=\"cp\" value=\"{{newCP}}\" currency=\"Copper\" label=\"Copper (cp)\"></vaadin-integer-field>\n                </div>\n                <div class=\"modal-content\" hidden$=[[!currencyIsDollars]]>\n                  <vaadin-integer-field class=\"dollars\" theme=\"mini\" padded has-controls min=\"0\" id=\"$\" value=\"{{new$}}\" currency=\"Dollars\" label=\"Currency ($)\"></vaadin-integer-field>\n                </div>\n                <div class=\"modal-footer\">\n                  <dnd-button label=\"Add\" currency$=\"[[_currencyColor(currencyIsDollars)]]\" border on-click=\"_addCurrency\"></dnd-button>\n                  <dnd-button label=\"Remove\" border on-click=\"_removeCurrency\"></dnd-button>\n                  <!-- <dnd-button label=\"Cancel\" border on-click=\"_closeCurrencyModal\"></dnd-button> -->\n                </div>\n              </template>\n            </vaadin-dialog>\n          </div>\n\n          <vaadin-grid id=\"grid\" expanded-items=\"{{expandedItems}}\" all-rows-visible rows-draggable theme=\"no-border no-row-borders no-row-padding\">\n            <vaadin-grid-column>\n              <template>\n                <div class=\"item-wrap\" active$=\"[[_isActive(activeItem, item)]]\">\n                  <vaadin-grid-tree-toggle level$=[[level]] leaf=\"[[_isLeaf(item)]]\" expanded=\"{{expanded}}\" theme$=[[_toggleTheme(item)]]></vaadin-grid-tree-toggle>\n                  <div class=\"item-wrap__name-wrap\" on-click=\"_expandDetails\">\n                    <span class=\"item-wrap__name\">[[item.name]]\n                      <span hidden$=\"[[!item.isEdited]]\" class=\"item-wrap__edited\">Edited</span>\n                    </span>\n                    <span class=\"item-wrap__type\">\n                      <span class=\"item-wrap__from\" hidden$=\"[[!item.fromBackground]]\">BG</span>\n                      <span class=\"item-wrap__from\" hidden$=\"[[!item.fromClass]]\">Class</span>\n                      <span>[[item.typeText]]<span hidden$=\"[[_noRarity(item.rarity, item)]]\">, [[item.rarity]]</span></span>\n                    </span>\n                  </div>\n                  <div hidden$=\"[[item.hasQuantity]]\" class=\"item-wrap__checkboxes\">\n                    <span on-click=\"_setItemEquipped\">\n                      <vaadin-checkbox checked=\"[[item.isEquipped]]\" hidden$=\"[[!item.canEquip]]\" label=\"Equip\"></vaadin-checkbox>\n                    </span>\n                    <span on-click=\"_setItemAttuned\">\n                      <vaadin-checkbox checked=\"[[item.isAttuned]]\" hidden$=\"[[!item.reqAttune]]\" label=\"Attune\"></vaadin-checkbox>\n                    </span>\n                  </div>\n                  <div hidden$=\"[[!item.hasQuantity]]\" class=\"item-wrap__quantity\">\n                    <vaadin-integer-field value=\"{{item.quantity}}\" theme=\"mini\" has-controls on-change=\"_quantityChange\"></vaadin-integer-field>\n                  </div>\n                  <button class=\"mdc-icon-button item-wrap__close\" hidden$=\"[[!isEditMode]]\" on-click=\"_openDeleteModal\"><i class=\"fas fa-trash\"></i></button>\n                </div>\n              </template>\n            </vaadin-grid-column>\n          </vaadin-grid>\n        </div>\n\n        <vaadin-dialog opened=\"{{deleteModalOpen}}\">\n          <template>\n            <style>\n              .modal-content {\n                display: flex;\n                justify-content: center;\n              }\n              .modal-item {\n                font-weight: bold;\n                font-size: 16px;\n              }\n              .modal-footer {\n                display: flex;\n                justify-content: space-between;\n                margin-top: 20px;\n              }\n              .modal-footer dnd-button:first-child {\n                margin-right: 40px;\n                --mdc-theme-primary: var(--mdc-theme-error);\n              }\n            </style>\n            <div class=\"modal-content\">Remove the item?</div>\n            <div class=\"modal-content modal-item\">[[deleteItemName]]</div>\n            <div class=\"modal-footer\">\n              <dnd-button label=\"Delete\" border on-click=\"_deleteItem\"></dnd-button>\n              <dnd-button label=\"Cancel\" border on-click=\"_closeDeleteModal\"></dnd-button>\n            </div>\n          </template>\n        </vaadin-dialog>\n\n        <div class=\"row-wrap details-row\" hidden$=\"[[!_hasActive(activeItem)]]\">\n          <div class=\"details-wrap\">          \n            <dnd-character-builder-equipment-item-detail item=\"{{activeItem}}\"></dnd-character-builder-equipment-item-detail>\n          </div>\n        </div>\n      </div>\n    `;\n  }\n}\n\ncustomElements.define(\"dnd-character-builder-equipment\", DndCharacterBuilderEquipment);"],"sourceRoot":""}