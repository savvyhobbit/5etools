{"version":3,"sources":["webpack:///./node_modules/@vaadin/vaadin-checkbox/vaadin-checkbox.js","webpack:///./node_modules/@vaadin/vaadin-grid/theme/lumo/vaadin-grid-tree-toggle-styles.js","webpack:///./node_modules/@vaadin/vaadin-grid/src/vaadin-grid-tree-toggle.js","webpack:///./components/views/character/dnd-character-builder-equipment.js"],"names":["$_documentContainer","document","head","appendChild","content","createElement","innerHTML","level","type","Number","value","observer","leaf","Boolean","reflectToAttribute","expanded","notify","super","ready","this","addEventListener","e","_onClick","preventDefault","toString","style","_debouncerUpdateLevel","debounce","updateStyles","customElements","define","is","inventory","Array","isEditMode","character","Object","expandedItems","expandedIds","activeItem","isMobile","length","filter","item","map","uniqueId","console","error","openedItemID","$","grid","closeItemDetails","undefined","window","scrollTo","originalScrollHeight","scrollY","connectedCallback","characterChangeHandler","detail","updateFromCharacter","editModeHandler","setTimeout","notifyResize","disconnectedCallback","removeEventListener","draggedItem","draggedItems","dropMode","dropTargetItem","isChild","container","removeId","storedItem","itemCounter","dropLocation","children","push","dropTargetId","id","finalAddIndex","parseInt","substring","lastIndexOf","parentItemREF","splice","dataProvider","params","callback","startIndex","page","pageSize","parentItem","slice","bind","clearCache","openedItem","openItemDetails","dispatchEvent","CustomEvent","bubbles","composed","data","model","__data","stayClosed","detailsOpenedItems","indexOf","checkboxEl","classList","add","remove","stopPropagation","itemModel","isEquipped","checkbox","target","querySelector","_flashCheckbox","isAttuned","getEventContext","newQuantity","quantity","isNaN","bools","bool","rarity","viewId","set"],"mappings":"0FAAA,c,wDCIA,MAAMA,EAAsB,GAAI;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eAmGhCC,SAASC,KAAKC,YAAYH,EAAoBI,S;;;;;;AC1F9C,MAAM,EAAsBH,SAASI,cAAc,YAEnD,EAAoBC,UAAY,mpDAWhCL,SAASC,KAAKC,YAAY,EAAoBC,SA6C9C,MAAM,UAA8B,YAAc,YAAS,OACzD,sBACE,OAAO,GAAI;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EA8Db,gBACE,MAAO,0BAGT,wBACE,MAAO,CAKLG,MAAO,CACLC,KAAMC,OACNC,MAAO,EACPC,SAAU,iBAMZC,KAAM,CACJJ,KAAMK,QACNH,OAAO,EACPI,oBAAoB,GAMtBC,SAAU,CACRP,KAAMK,QACNH,OAAO,EACPI,oBAAoB,EACpBE,QAAQ,IAKd,QACEC,MAAMC,QAENC,KAAKC,iBAAiB,QAASC,GAAKF,KAAKG,SAASD,IAGpD,SAASA,GACHF,KAAKP,OAITS,EAAEE,iBACFJ,KAAKJ,UAAYI,KAAKJ,UAGxB,cAAcR,GACZ,MAAMG,EAAQD,OAAOF,GAAOiB,WAC5BL,KAAKM,MAAM,YAAcf,EAGzBS,KAAKO,sBAAwB,IAAUC,SACrCR,KAAKO,sBACL,IACA,IAAMP,KAAKS,aAAa,CAAC,WAAYlB,MAK3CmB,eAAeC,OAAO,EAAsBC,GAAI,I,sGCjLhD,MAAM,UAAqC,IAEzC,wBACE,MAAO,CACLC,UAAW,CACTxB,KAAMyB,OAERC,WAAY,CACV1B,KAAMK,QACNH,OAAO,GAETyB,UAAW,CACT3B,KAAM4B,QAERC,cAAe,CACb7B,KAAMyB,OAERK,YAAa,CACX9B,KAAMyB,OAERM,WAAY,CACV/B,KAAM4B,QAERI,SAAU,CACRhC,KAAMK,UAKZ,uBACE,MAAO,CACL,yCAIJ,uBACMM,KAAKkB,eAAiBlB,KAAKkB,cAAcI,SAC3CtB,KAAKmB,YAAcnB,KAAKkB,cAAcK,OAAOC,KAAUA,GAAMC,IAAKD,GAASA,EAAKE,UAChFC,QAAQC,MAAM5B,KAAKmB,aAEfnB,KAAK6B,eACP7B,KAAK8B,EAAEC,KAAKC,iBAAiBhC,KAAK6B,cAClC7B,KAAK6B,kBAAeI,IAGxBC,OAAOC,SAAS,EAAGnC,KAAKoC,sBAG1B,oBAAoBlC,GAElBF,KAAKoC,qBAAuBF,OAAOG,QAGrC,oBACEvC,MAAMwC,oBAENtC,KAAKuC,uBAA0BrC,IAC7B,IAAIc,EAAYd,EAAEsC,OAAOxB,UACzBhB,KAAKyC,oBAAoBzB,IAG3BhB,KAAKyC,oBAAoB,eACzB,cAAsBxC,iBAAiB,qBAAsBD,KAAKuC,wBAElEvC,KAAK0C,gBAAmBxC,IACtBF,KAAKe,WAAab,EAAEsC,OAAOzB,WACvBf,KAAK8B,EAAEC,MACTY,WAAW,KACT3C,KAAK8B,EAAEC,KAAKa,gBACX,IAGP,cAAqB3C,iBAAiB,iBAAkBD,KAAK0C,iBAC7D1C,KAAKe,WAAa,cAGpB,uBACEjB,MAAM+C,uBAEN,cAAsBC,oBAAoB,qBAAsB9C,KAAKuC,wBACrE,cAAqBO,oBAAoB,iBAAkB9C,KAAK0C,iBAGlE,QACE5C,MAAMC,QAEN4C,WAAW,KACT,MAAMZ,EAAO/B,KAAK8B,EAAEC,KAGpB,IAAIgB,EAEJhB,EAAK9B,iBAAiB,kBAAkB,SAASC,GAC/C6C,EAAc7C,EAAEsC,OAAOQ,aAAa,GACpCjB,EAAKkB,SAAW,uBAGlBlB,EAAK9B,iBAAiB,gBAAgB,SAASC,GAC7C6C,EAAchB,EAAKkB,SAAW,QAGhClB,EAAK9B,iBAAiB,YAAcC,IAClC,MAAMgD,EAAiBhD,EAAEsC,OAAOU,eAChC,GAAIH,GAAeA,IAAgBG,EAAgB,CAGjD,MAAMC,EAAU,YAAYJ,EAAaG,EAAexB,UACxD,GAAIqB,EAAYK,WAAaD,EAC3B,OAGF,MAAME,EAAWN,EAAYO,WAAW5B,SAIxC,GAHAqB,EAAYO,WAAW5B,SAAW1B,KAAKgB,UAAUuC,cAGnB,WAA1BrD,EAAEsC,OAAOgB,cACPN,EAAeE,UAQjB,YAPIF,EAAeI,YAAcJ,EAAeI,WAAWG,WAEzDP,EAAeI,WAAWG,SAASC,KAAKX,EAAYO,YACpD,aAAQJ,OAAgBjB,GAAW,GAEnC,aAAWoB,KAOjB,GAAIrD,KAAKa,UAAW,CAElB,MAAM8C,EAAe,GAAGT,EAAeU,GACvC,IAAIC,EAAgBC,SAASH,EAAaI,UAAUJ,EAAaK,YAAY,MAAO,IACtD,UAA1B9D,EAAEsC,OAAOgB,cACXK,IAGEX,EAAee,eAEjBf,EAAee,cAAcX,WAAWG,SAASS,OAAOL,EAAe,EAAGd,EAAYO,YACtF,aAAQJ,EAAee,mBAAehC,GAAW,IAGjD,aAAY4B,EAAed,EAAYO,YAIzC,aAAWD,OAMjBtB,EAAKoC,cAAe,CAAEC,EAAQC,KAC5B,MAAMC,EAAaF,EAAOG,KAAOH,EAAOI,SACxC,IAAIf,EAAWW,EAAOK,WAAaL,EAAOK,WAAWhB,SAAWzD,KAAKa,UACrE,GAAI4C,GAAYA,EAASnC,OAAQ,CAE/B+C,EADaZ,EAASiB,MAAMJ,EAAYA,EAAaF,EAAOI,UAC7Cf,EAASnC,WAEzBqD,KAAK3E,OACP,GAIL,0BAA0BgB,GACxB,GAAIA,EAAW,CACbhB,KAAKgB,UAAYA,EACjBhB,KAAKa,gBAAkB,YAASG,GAChCW,QAAQC,MAAM,aAAc5B,KAAKa,WACjC,MAAMuB,EAAuBF,OAAOG,QAEpC,GADArC,KAAK8B,EAAEC,KAAK6C,aACR5E,KAAK6B,aAAc,CACrB,MAAMgD,EAAa,YAAY7E,KAAKa,UAAWb,KAAK6B,aAAaH,UAC7DmD,GACF7E,KAAK8B,EAAEC,KAAK+C,gBAAgBD,GAGhC,GAAI7E,KAAKmB,YAAa,CACpB,MAAMD,EAAgBlB,KAAKmB,YAAYM,IAAKmC,GACnC,YAAY5D,KAAKa,UAAW+C,IAErC5D,KAAKkB,cAAgBA,EAEnBlB,KAAKoB,aACPpB,KAAKoB,WAAa,YAAYpB,KAAKa,UAAWb,KAAKoB,WAAWM,WAEhEQ,OAAOC,SAAS,EAAGC,GACnBpC,KAAK+E,cAAc,IAAIC,YAAY,gBAAiB,CAAEC,SAAS,EAAMC,UAAU,MAInF,eAAehF,GACb,IAAIiF,EAAOjF,EAAEkF,MAAMC,OAAO7D,KACxB8D,EAAatF,KAAK8B,EAAEC,KAAKwD,mBAAmBC,QAAQL,IAAS,EAE/D,MAAM/C,EAAuBF,OAAOG,QAEpC,IAAK,IAAIb,KAAQxB,KAAK8B,EAAEC,KAAKwD,mBAC3BvF,KAAK8B,EAAEC,KAAKC,iBAAiBR,GAG3B8D,GACFtF,KAAK8B,EAAEC,KAAKC,iBAAiBmD,GAC7BnF,KAAK6B,kBAAeI,IAEpBjC,KAAK8B,EAAEC,KAAK+C,gBAAgBK,GAC5BnF,KAAK6B,aAAesD,GAEtBnF,KAAK8B,EAAEC,KAAKa,eACZV,OAAOC,SAAS,EAAGC,GAGrB,eAAeqD,GACTA,IACFA,EAAWC,UAAUC,IAAI,iBACzBF,EAAWC,UAAUC,IAAI,eACzBhD,WAAW,KACT8C,EAAWC,UAAUE,OAAO,eAC5BjD,WAAW,KACT8C,EAAWC,UAAUE,OAAO,kBAC3B,MACF,MAIP,YAAY1F,GACV,IAAIwB,EAAWxB,EAAEkF,MAAMC,OAAO7D,WAAyCS,IAAjC/B,EAAEkF,MAAMC,OAAO7D,KAAKE,SAAyBxB,EAAEkF,MAAMC,OAAO7D,KAAKE,cAAWO,EAClH,aAAWP,GAGb,uBAAuBxB,GACrBA,EAAEE,iBACFF,EAAE2F,kBACF,IAAIC,EAAY5F,EAAEkF,MAAMC,OAAO7D,KAC3BE,EAAWoE,EAAYA,EAAUpE,cAAWO,EAGhD,KAFiB6D,GAAYA,EAAUC,WAGrC,aAAmBrE,QACd,SAAU,YAAaoE,GAC5B,aAAmBpE,OACd,CACL,IAAIsE,EAAW9F,EAAE+F,OAAOC,cAAc,mBACtClG,KAAKmG,eAAeH,IAIxB,sBAAsB9F,GACpBA,EAAEE,iBACFF,EAAE2F,kBACF,IAAIC,EAAY5F,EAAEkF,MAAMC,OAAO7D,KAC3BE,EAAWoE,EAAYA,EAAUpE,cAAWO,EAGhD,KAFgB6D,GAAYA,EAAUM,UAGpC,aAAkB1E,QACb,SAAU,YAAcoE,GAC7B,aAAkBpE,OACb,CACL,IAAIsE,EAAW9F,EAAE+F,OAAOC,cAAc,mBACtClG,KAAKmG,eAAeH,IAIxB,gBAAgB9F,GACd,MAAMsB,EAAOxB,KAAK8B,EAAEC,KAAKsE,gBAAgBnG,GAAGsB,KAC5C,IAAI8E,EAAcxC,SAAStC,EAAK+E,SAAU,IACtCC,MAAMF,KACRA,EAAc,GAGhB9E,EAAK8B,WAAWiD,SAAWD,EAC3B,aAAQ9E,GAGV,WACE,YAAQ,IAAI,GAGd,gBAAgBtB,GACdA,EAAEE,iBACFF,EAAE2F,kBAGJ,OAAOY,GACL,IAAK,IAAIC,KAAQD,EACf,GAAIC,EACF,OAAO,EAGX,OAAO,EAGT,UAAUC,GACR,OAAQA,GAAqB,SAAXA,EAGpB,aAAanF,GACX,OAAOA,EAAKiC,UAAqC,IAAzBjC,EAAKiC,SAASnC,OAAe,cAAgB,GAGvE,aACEtB,KAAK+E,cAAc,IAAIC,YAAY,cAAe,CAChDC,SAAS,EACTC,UAAU,EACV1C,OAAQ,CACNoE,OAAQ,YAKd,UAAUxF,EAAYI,GACpB,OAAOJ,IAAeI,EAGxB,WAAWJ,GACT,QAASA,EAGX,kBACEpB,KAAK6G,IAAI,aAAc,MAGzB,sBACE,OAAO,GAAI;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;OAwQfnG,eAAeC,OAAO,kCAAmC","file":"5.bundle.js","sourcesContent":["import './theme/lumo/vaadin-checkbox.js';\nexport * from './src/vaadin-checkbox.js';\n","import '@vaadin/vaadin-lumo-styles/color.js';\nimport '@vaadin/vaadin-lumo-styles/spacing.js';\nimport { html } from '@polymer/polymer/lib/utils/html-tag.js';\n\nconst $_documentContainer = html`<dom-module id=\"lumo-grid-tree-toggle\" theme-for=\"vaadin-grid-tree-toggle\">\n  <template>\n    <style>\n      :host {\n        --vaadin-grid-tree-toggle-level-offset: 2em;\n        align-items: center;\n        vertical-align: middle;\n        margin-left: calc(var(--lumo-space-s) * -1);\n        -webkit-tap-highlight-color: transparent;\n      }\n\n      :host(:not([leaf])) {\n        cursor: default;\n      }\n\n      [part=\"toggle\"] {\n        display: inline-block;\n        font-size: 1.5em;\n        line-height: 1;\n        width: 1em;\n        height: 1em;\n        text-align: center;\n        color: var(--lumo-contrast-50pct);\n        /* Increase touch target area */\n        padding: calc(1em / 3);\n        margin: calc(1em / -3);\n      }\n\n      :host(:not([dir=\"rtl\"])) [part=\"toggle\"] {\n        margin-right: 0;\n      }\n\n      @media (hover: hover) {\n        :host(:hover) [part=\"toggle\"] {\n          color: var(--lumo-contrast-80pct);\n        }\n      }\n\n      [part=\"toggle\"]::before {\n        font-family: \"lumo-icons\";\n        display: inline-block;\n        height: 100%;\n      }\n\n      :host(:not([expanded])) [part=\"toggle\"]::before {\n        content: var(--lumo-icons-angle-right);\n      }\n\n      :host([expanded]) [part=\"toggle\"]::before {\n        content: var(--lumo-icons-angle-right);\n        transform: rotate(90deg);\n      }\n\n      /* Experimental support for hierarchy connectors, using an unsupported selector */\n      :host([theme~=\"connectors\"]) #level-spacer {\n        position: relative;\n        z-index: -1;\n        font-size: 1em;\n        height: 1.5em;\n      }\n\n      :host([theme~=\"connectors\"]) #level-spacer::before {\n        display: block;\n        content: \"\";\n        margin-top: calc(var(--lumo-space-m) * -1);\n        height: calc(var(--lumo-space-m) + 3em);\n        background-image: linear-gradient(to right, transparent calc(var(--vaadin-grid-tree-toggle-level-offset) - 1px), var(--lumo-contrast-10pct) calc(var(--vaadin-grid-tree-toggle-level-offset) - 1px));\n        background-size: var(--vaadin-grid-tree-toggle-level-offset) var(--vaadin-grid-tree-toggle-level-offset);\n        background-position: calc(var(--vaadin-grid-tree-toggle-level-offset) / 2 - 2px) 0;\n      }\n\n      /* RTL specific styles */\n\n      :host([dir=\"rtl\"]) {\n        margin-left: 0;\n        margin-right: calc(var(--lumo-space-s) * -1);\n      }\n\n      :host([dir=\"rtl\"]) [part=\"toggle\"] {\n        margin-left: 0;\n      }\n\n      :host([dir=\"rtl\"][expanded]) [part=\"toggle\"]::before {\n        transform: rotate(-90deg);\n      }\n\n      :host([dir=\"rtl\"][theme~=\"connectors\"]) #level-spacer::before {\n        background-image: linear-gradient(to left, transparent calc(var(--vaadin-grid-tree-toggle-level-offset) - 1px), var(--lumo-contrast-10pct) calc(var(--vaadin-grid-tree-toggle-level-offset) - 1px));\n        background-position: calc(100% - (var(--vaadin-grid-tree-toggle-level-offset) / 2 - 2px)) 0;\n      }\n\n      :host([dir=\"rtl\"]:not([expanded])) [part=\"toggle\"]::before,\n      :host([dir=\"rtl\"][expanded]) [part=\"toggle\"]::before {\n        content: var(--lumo-icons-angle-left);\n      }\n    </style>\n  </template>\n</dom-module>`;\n\ndocument.head.appendChild($_documentContainer.content);\n","/**\n@license\nCopyright (c) 2017 Vaadin Ltd.\nThis program is available under Apache License Version 2.0, available at https://vaadin.com/license/\n*/\nimport { PolymerElement } from '@polymer/polymer/polymer-element.js';\n\nimport '@polymer/polymer/lib/elements/custom-style.js';\nimport { Debouncer } from '@polymer/polymer/lib/utils/debounce.js';\nimport { ThemableMixin } from '@vaadin/vaadin-themable-mixin/vaadin-themable-mixin.js';\nimport { DirMixin } from '@vaadin/vaadin-element-mixin/vaadin-dir-mixin.js';\nimport { html } from '@polymer/polymer/lib/utils/html-tag.js';\nimport { microTask } from '@polymer/polymer/lib/utils/async.js';\nconst $_documentContainer = document.createElement('template');\n\n$_documentContainer.innerHTML = `<custom-style>\n  <style>\n    @font-face {\n      font-family: \"vaadin-grid-tree-icons\";\n      src: url(data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAAAQkAA0AAAAABrwAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABGRlRNAAAECAAAABoAAAAcgHwa6EdERUYAAAPsAAAAHAAAAB4AJwAOT1MvMgAAAZQAAAA/AAAAYA8TBIJjbWFwAAAB8AAAAFUAAAFeGJvXWmdhc3AAAAPkAAAACAAAAAgAAAAQZ2x5ZgAAAlwAAABLAAAAhIrPOhFoZWFkAAABMAAAACsAAAA2DsJI02hoZWEAAAFcAAAAHQAAACQHAgPHaG10eAAAAdQAAAAZAAAAHAxVAgBsb2NhAAACSAAAABIAAAASAIAAVG1heHAAAAF8AAAAGAAAACAACgAFbmFtZQAAAqgAAAECAAACTwflzbdwb3N0AAADrAAAADYAAABZQ7Ajh3icY2BkYGAA4twv3Vfi+W2+MnCzMIDANSOmbGSa2YEZRHEwMIEoAAoiB6sAeJxjYGRgYD7w/wADAwsDCDA7MDAyoAI2AFEEAtIAAAB4nGNgZGBg4GBgZgDRDAxMDGgAAAGbABB4nGNgZp7JOIGBlYGBaSbTGQYGhn4IzfiawZiRkwEVMAqgCTA4MDA+38d84P8BBgdmIAapQZJVYGAEAGc/C54AeJxjYYAAxlAIzQTELAwMBxgZGB0ACy0BYwAAAHicY2BgYGaAYBkGRgYQiADyGMF8FgYbIM3FwMHABISMDArP9/3/+/8/WJXC8z0Q9v8nEp5gHVwMMMAIMo+RDYiZoQJMQIKJARUA7WBhGN4AACFKDtoAAAAAAAAAAAgACAAQABgAJgA0AEIAAHichYvBEYBADAKBVHBjBT4swl9KS2k05o0XHd/yW1hAfBFwCv9sIlJu3nZaNS3PXAaXXHI8Lge7DlzF7C1RgXc7xkK6+gvcD2URmQB4nK2RQWoCMRiFX3RUqtCli65yADModOMBLLgQSqHddRFnQghIAnEUvEA3vUUP0LP0Fj1G+yb8R5iEhO9/ef/7FwFwj28o9EthiVp4hBlehcfUP4Ur8o/wBAv8CU+xVFvhOR7UB7tUdUdlVRJ6HnHWTnhM/V24In8JT5j/KzzFSi2E53hUz7jCcrcIiDDwyKSW1JEct2HdIPH1DFytbUM0PofWdNk5E5oUqb/Q6HHBiVGZpfOXkyUMEj5IyBuNmYZQjBobfsuassvnkKLe1OuBBj0VQ8cRni2xjLWsHaM0jrjx3peYA0/vrdmUYqe9iy7bzrX6eNP7Jh1SijX+AaUVbB8AAHicY2BiwA84GBgYmRiYGJkZmBlZGFkZ2djScyoLMgzZS/MyDQwMwLSruZMzlHaB0q4A76kLlwAAAAEAAf//AA94nGNgZGBg4AFiMSBmYmAEQnYgZgHzGAAD6wA2eJxjYGBgZACCKxJigiD6mhFTNowGACmcA/8AAA==) format('woff');\n      font-weight: normal;\n      font-style: normal;\n    }\n  </style>\n</custom-style>`;\n\ndocument.head.appendChild($_documentContainer.content);\n/**\n * `<vaadin-grid-tree-toggle>` is a helper element for the `<vaadin-grid>`\n * that provides toggle and level display functionality for the item tree.\n *\n * #### Example:\n * ```html\n * <vaadin-grid-column>\n *   <template class=\"header\">Package name</template>\n *   <template>\n *     <vaadin-grid-tree-toggle\n *         leaf=\"[[!item.hasChildren]]\"\n *         expanded=\"{{expanded}}\"\n *         level=\"[[level]]\">\n *       [[item.name]]\n *     </vaadin-grid-tree-toggle>\n *   </template>\n * </vaadin-grid-column>\n * ```\n *\n * ### Styling\n *\n * The following shadow DOM parts are available for styling:\n *\n * Part name | Description\n * ---|---\n * `toggle` | The tree toggle icon\n *\n * The following state attributes are available for styling:\n *\n * Attribute    | Description | Part name\n * ---|---|---\n * `expanded` | When present, the toggle is expanded | :host\n * `leaf` | When present, the toggle is not expandable, i. e., the current item is a leaf | :host\n *\n * The following custom CSS properties are available on\n * the `<vaadin-grid-tree-toggle>` element:\n *\n * Custom CSS property | Description | Default\n * ---|---|---\n * `--vaadin-grid-tree-toggle-level-offset` | Visual offset step for each tree sublevel | `1em`\n *\n * @extends PolymerElement\n * @mixes ThemableMixin\n */\nclass GridTreeToggleElement extends ThemableMixin(DirMixin(PolymerElement)) {\n  static get template() {\n    return html`\n    <style>\n      :host {\n        display: inline-flex;\n        align-items: baseline;\n\n        /* CSS API for :host */\n        --vaadin-grid-tree-toggle-level-offset: 1em;\n\n        /*\n          ShadyCSS seems to polyfill :dir(rtl) only for :host, thus using\n          a host custom CSS property for ltr/rtl toggle icon choice.\n         */\n        ---collapsed-icon: \"\\\\e7be\\\\00a0\";\n      }\n\n      :host(:dir(rtl)) {\n        ---collapsed-icon: \"\\\\e7bd\\\\00a0\";\n      }\n\n      :host([hidden]) {\n        display: none !important;\n      }\n\n      :host(:not([leaf])) {\n        cursor: pointer;\n      }\n\n      #level-spacer,\n      [part=\"toggle\"] {\n        flex: none;\n      }\n\n      #level-spacer {\n        display: inline-block;\n        width: calc(var(---level, '0') * var(--vaadin-grid-tree-toggle-level-offset));\n      }\n\n      [part=\"toggle\"]::before {\n        font-family: \"vaadin-grid-tree-icons\";\n        line-height: 1em; /* make icon font metrics not affect baseline */\n      }\n\n      :host(:not([expanded])) [part=\"toggle\"]::before {\n        content: var(---collapsed-icon);\n      }\n\n      :host([expanded]) [part=\"toggle\"]::before {\n        content: \"\\\\e7bc\\\\00a0\"; /* icon glyph + single non-breaking space */\n      }\n\n      :host([leaf]) [part=\"toggle\"] {\n        visibility: hidden;\n      }\n    </style>\n\n    <span id=\"level-spacer\"></span>\n    <span part=\"toggle\"></span>\n    <slot></slot>\n`;\n  }\n\n  static get is() {\n    return 'vaadin-grid-tree-toggle';\n  }\n\n  static get properties() {\n    return {\n      /**\n       * Current level of the tree represented with a horizontal offset\n       * of the toggle button.\n       */\n      level: {\n        type: Number,\n        value: 0,\n        observer: '_levelChanged'\n      },\n\n      /**\n       * Hides the toggle icon and disables toggling a tree sublevel.\n       */\n      leaf: {\n        type: Boolean,\n        value: false,\n        reflectToAttribute: true\n      },\n\n      /**\n       * Sublevel toggle state.\n       */\n      expanded: {\n        type: Boolean,\n        value: false,\n        reflectToAttribute: true,\n        notify: true\n      }\n    };\n  }\n\n  ready() {\n    super.ready();\n\n    this.addEventListener('click', e => this._onClick(e));\n  }\n\n  _onClick(e) {\n    if (this.leaf) {\n      return;\n    }\n\n    e.preventDefault();\n    this.expanded = !this.expanded;\n  }\n\n  _levelChanged(level) {\n    const value = Number(level).toString();\n    this.style['---level'] = value;\n    // Async is to make DOM updates applied before evaluating the style\n    // update, required for polyfilled RTL support in MSIE and Edge.\n    this._debouncerUpdateLevel = Debouncer.debounce(\n      this._debouncerUpdateLevel,\n      microTask,\n      () => this.updateStyles({'---level': value})\n    );\n  }\n}\n\ncustomElements.define(GridTreeToggleElement.is, GridTreeToggleElement);\n\nexport { GridTreeToggleElement };\n","import { PolymerElement, html } from \"@polymer/polymer\";\nimport { \n  getCharacterChannel,\n  getSelectedCharacter,\n  getItems,\n  removeItem,\n  canAttuneItem,\n  canEquipItem,\n  toggleItemEquipped,\n  toggleItemAttuned,\n  setItem,\n  spliceItems,\n  isChildItem,\n  getItemAtId,\n  addItem\n} from \"../../../util/charBuilder\";\nimport { getEditModeChannel, isEditMode } from \"../../../util/editMode\";\nimport \"@vaadin/vaadin-checkbox\";\nimport \"@vaadin/vaadin-grid\";\nimport \"@vaadin/vaadin-grid/vaadin-grid-tree-toggle\";\nimport \"@vaadin/vaadin-grid/vaadin-grid-column\";\nimport \"./dnd-character-builder-equipment-item-detail\";\n\nclass DndCharacterBuilderEquipment extends PolymerElement {\n  \n  static get properties() {\n    return {\n      inventory: {\n        type: Array\n      },\n      isEditMode: {\n        type: Boolean,\n        value: false\n      },\n      character: {\n        type: Object,\n      },\n      expandedItems: {\n        type: Array\n      },\n      expandedIds: {\n        type: Array\n      },\n      activeItem: {\n        type: Object,\n      },\n      isMobile: {\n        type: Boolean\n      },\n    };\n  }\n\n  static get observers() {\n    return [\n      '_expandedItemsChange(expandedItems.*)'\n    ]\n  }\n\n  _expandedItemsChange() {\n    if (this.expandedItems && this.expandedItems.length) {\n      this.expandedIds = this.expandedItems.filter(item => !!item).map((item) => item.uniqueId);\n      console.error(this.expandedIds);\n\n      if (this.openedItemID) {\n        this.$.grid.closeItemDetails(this.openedItemID);\n        this.openedItemID = undefined;\n      }\n    }\n    window.scrollTo(0, this.originalScrollHeight);\n  }\n\n  _recordScrollHeight(e) {\n    // Fix reposition issue after tree expand/collapse toggle\n    this.originalScrollHeight = window.scrollY;\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n\n    this.characterChangeHandler = (e) => {\n      let character = e.detail.character;\n      this.updateFromCharacter(character);\n    };\n    \n    this.updateFromCharacter(getSelectedCharacter());\n    getCharacterChannel().addEventListener(\"character-selected\", this.characterChangeHandler);\n\n    this.editModeHandler = (e) => {\n      this.isEditMode = e.detail.isEditMode;\n      if (this.$.grid) {\n        setTimeout(() => {\n          this.$.grid.notifyResize();\n        }, 0);\n      }\n    }\n    getEditModeChannel().addEventListener('editModeChange', this.editModeHandler);\n    this.isEditMode = isEditMode();\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n\n    getCharacterChannel().removeEventListener(\"character-selected\", this.characterChangeHandler);\n    getEditModeChannel().removeEventListener('editModeChange', this.editModeHandler);\n  }\n\n  ready() {\n    super.ready();\n    \n    setTimeout(() => {\n      const grid = this.$.grid;\n\n      // Add Drag and Drop\n      let draggedItem;\n\n      grid.addEventListener('grid-dragstart', function(e) {\n        draggedItem = e.detail.draggedItems[0];\n        grid.dropMode = 'on-top-or-between';\n      });\n\n      grid.addEventListener('grid-dragend', function(e) {\n        draggedItem = grid.dropMode = null;\n      });\n\n      grid.addEventListener('grid-drop', (e) => {\n        const dropTargetItem = e.detail.dropTargetItem;\n        if (draggedItem && draggedItem !== dropTargetItem) {\n\n          // Prevent loops\n          const isChild = isChildItem(draggedItem, dropTargetItem.uniqueId);\n          if (draggedItem.container && isChild) {\n            return;\n          }\n\n          const removeId = draggedItem.storedItem.uniqueId;\n          draggedItem.storedItem.uniqueId = this.character.itemCounter ++;\n\n          // Dropping into container\n          if (e.detail.dropLocation === 'on-top') {\n            if (dropTargetItem.container) {\n              if (dropTargetItem.storedItem && dropTargetItem.storedItem.children) {\n                // Add child item\n                dropTargetItem.storedItem.children.push(draggedItem.storedItem);\n                setItem(dropTargetItem, undefined, true);\n                // Remove original\n                removeItem(removeId);\n              }\n              return;\n            }\n          }\n\n          // Re-ordering items, default action if 'on-top' of non-container\n          if (this.inventory) {\n            // Adjust final add index for dropLocation 'below' or 'above'\n            const dropTargetId = `${dropTargetItem.id}`;\n            let finalAddIndex = parseInt(dropTargetId.substring(dropTargetId.lastIndexOf('_')), 10);\n            if (e.detail.dropLocation === 'below') {\n              finalAddIndex++;\n            }\n\n            if (dropTargetItem.parentItemREF) {\n              // Add child item\n              dropTargetItem.parentItemREF.storedItem.children.splice(finalAddIndex, 0, draggedItem.storedItem);\n              setItem(dropTargetItem.parentItemREF, undefined, true);\n            } else {\n              // Add top-level item\n              spliceItems(finalAddIndex, draggedItem.storedItem);\n            }\n\n            // Remove original item\n            removeItem(removeId);\n          }\n        }\n      });\n\n      // Set Data Provider\n      grid.dataProvider = ((params, callback) => {\n        const startIndex = params.page * params.pageSize;\n        let children = params.parentItem ? params.parentItem.children : this.inventory;\n        if (children && children.length) {\n          const page = children.slice(startIndex, startIndex + params.pageSize);\n          callback(page, children.length);\n        }\n      }).bind(this);\n    }, 0);\n    \n  }\n\n  async updateFromCharacter(character) {\n    if (character) {\n      this.character = character;\n      this.inventory = await getItems(character);\n      console.error('inventory:', this.inventory);\n      const originalScrollHeight = window.scrollY;\n      this.$.grid.clearCache();\n      if (this.openedItemID) {\n        const openedItem = getItemAtId(this.inventory, this.openedItemID.uniqueId);\n        if (openedItem) {\n          this.$.grid.openItemDetails(openedItem);\n        }\n      }\n      if (this.expandedIds) {\n        const expandedItems = this.expandedIds.map((id) => {\n          return getItemAtId(this.inventory, id);\n        });\n        this.expandedItems = expandedItems;\n      }\n      if (this.activeItem) {\n        this.activeItem = getItemAtId(this.inventory, this.activeItem.uniqueId);\n      }\n      window.scrollTo(0, originalScrollHeight);\n      this.dispatchEvent(new CustomEvent(\"loadingChange\", { bubbles: true, composed: true }));\n    }\n  }\n\n  _expandDetails(e) {\n    let data = e.model.__data.item,\n      stayClosed = this.$.grid.detailsOpenedItems.indexOf(data) > -1;\n\n    const originalScrollHeight = window.scrollY;\n\n    for (let item of this.$.grid.detailsOpenedItems) {\n      this.$.grid.closeItemDetails(item);\n    }\n\n    if (stayClosed) {\n      this.$.grid.closeItemDetails(data);\n      this.openedItemID = undefined;\n    } else {\n      this.$.grid.openItemDetails(data);\n      this.openedItemID = data;\n    }\n    this.$.grid.notifyResize();\n    window.scrollTo(0, originalScrollHeight);\n  }\n\n  _flashCheckbox(checkboxEl) {\n    if (checkboxEl) {\n      checkboxEl.classList.add('transition-bg');\n      checkboxEl.classList.add('flash-error');\n      setTimeout(() => {\n        checkboxEl.classList.remove('flash-error');\n        setTimeout(() => {\n          checkboxEl.classList.remove('transition-bg');\n        }, 200);\n      }, 200);\n    }\n  }\n\n  _deleteItem(e) {\n    let uniqueId = e.model.__data.item && e.model.__data.item.uniqueId !== undefined ? e.model.__data.item.uniqueId : undefined;\n    removeItem(uniqueId);\n  }\n\n  async _setItemEquipped(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    let itemModel = e.model.__data.item;\n    let uniqueId = itemModel ? itemModel.uniqueId : undefined;\n    let isEquipped = itemModel ? itemModel.isEquipped : false;\n    \n    if (isEquipped) {\n      toggleItemEquipped(uniqueId);\n    } else if (await canEquipItem(itemModel)) {\n      toggleItemEquipped(uniqueId);\n    } else {\n      let checkbox = e.target.querySelector('vaadin-checkbox')\n      this._flashCheckbox(checkbox)\n    }\n  }\n\n  async _setItemAttuned(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    let itemModel = e.model.__data.item;\n    let uniqueId = itemModel ? itemModel.uniqueId : undefined;\n    let isAttuned = itemModel ? itemModel.isAttuned : false;\n\n    if (isAttuned) {\n      toggleItemAttuned(uniqueId);\n    } else if (await canAttuneItem(itemModel)) {\n      toggleItemAttuned(uniqueId);\n    } else {\n      let checkbox = e.target.querySelector('vaadin-checkbox')\n      this._flashCheckbox(checkbox)\n    }\n  }\n\n  _quantityChange(e) {\n    const item = this.$.grid.getEventContext(e).item;\n    let newQuantity = parseInt(item.quantity, 10);\n    if (isNaN(newQuantity)) {\n      newQuantity = 0;\n    }\n\n    item.storedItem.quantity = newQuantity;\n    setItem(item);\n  }\n\n  _addItem() {\n    addItem({}, false);\n  }\n\n  _preventDefault(e) {\n    e.preventDefault();\n    e.stopPropagation();\n  }\n\n  _or(...bools) {\n    for (let bool of bools) {\n      if (bool) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  _noRarity(rarity) {\n    return !rarity || rarity === 'None';\n  }\n\n  _toggleTheme(item) {\n    return item.children && item.children.length === 0 ? 'no-children' : '';\n  }\n\n  _linkClick() {\n    this.dispatchEvent(new CustomEvent(\"open-drawer\", {\n      bubbles: true,\n      composed: true,\n      detail: {\n        viewId: 'items'\n      }\n    }));\n  }\n  \n  _isActive(activeItem, item) {\n    return activeItem === item;\n  }\n\n  _hasActive(activeItem) {\n    return !!activeItem;\n  }\n\n  _clearSelection() {\n    this.set('activeItem', null);\n  }\n\n  static get template() {\n    return html`\n      <style include=\"material-styles\"></style>\n      <style>\n        :host {\n          display: block;\n          padding: 14px;\n        }\n        [hidden] {\n          display: none !important;\n        }\n        a {\n          color: var(--mdc-theme-secondary);\n        }\n\n        vaadin-grid {\n          margin-bottom: 200px;\n        }\n\n        .heading {\n          display: flex;\n          flex-direction: row;\n          align-items: center;\n          justify-content: space-between;\n          border-bottom: 1px solid var(--lumo-contrast-10pct);\n        }\n        .reference-link:hover {\n          color: var(--mdc-theme-secondary);\n        }\n\n        .col-wrap {\n          display: flex; \n          justify-content: space-between;\n          flex-wrap: wrap;\n        }\n\n        .row-wrap {\n          width: 100%;\n        }\n        .row-wrap:not(:last-child) {\n          margin-bottom: 24px;\n        }\n\n        .row-wrap > *:not(h2):not(:last-child) {\n          margin-bottom: 10px;\n        }\n\n        .no-content {\n          font-size: 14px;\n          font-style: italic;\n        }\n\n        .item-wrap {\n          display: flex;\n          flex-wrap: nowrap;\n          flex-direction: row;\n          justify-content: space-between;\n          align-items: flex-start;\n          padding: 10px 6px;\n          min-height: 28px;\n          border-bottom: 1px solid var(--_lumo-grid-secondary-border-color);\n        }\n        .item-wrap__name-wrap {\n          flex-basis: 100%;\n          min-width: 0;\n          display: flex;\n          flex-direction: column;\n          cursor: pointer;\n        }\n        .item-wrap__name-wrap:hover {\n          color: var(--mdc-theme-secondary);\n        }\n        .item-wrap__name {\n          font-weight: bold;\n          overflow: hidden;\n          text-overflow: ellipsis;\n          white-space: nowrap;\n          position: relative;\n        }\n        .item-wrap__edited,\n        .item-wrap__from {\n          background-color: var(--mdc-theme-text-disabled-on-background);\n          color: var(--mdc-theme-on-secondary);\n          border: none;\n          border-radius: 4px;\n          outline: none;\n          display: inline-block;\n          justify-content: center;\n          white-space: normal;\n          font-size: 10px;\n          padding: 1px 4px;\n          margin-right: 4px;\n          font-style: italic;\n        }\n        .item-wrap__edited {\n          top: -1px;\n          position: relative;\n          font-weight: normal;\n        }\n        .item-wrap__type {\n          font-style: italic;\n          font-size: 12px;\n          overflow: hidden;\n          text-overflow: ellipsis;\n          white-space: nowrap;\n          position: relative;\n        }\n        .item-wrap__type--fromBackground {\n          padding-right: 38px;\n        }\n        .item-wrap__type--fromClass {\n          padding-right: 50px;\n        }\n        .item-wrap__close {\n          font-size: 14px;\n          margin-top: 6px;\n          cursor: pointer;\n        }\n        .item-wrap__checkboxes {\n          display: flex;\n          flex-direction: column;\n          width: 80px;\n          flex-grow: 0;\n          flex-shrink: 0;\n          margin-left: auto;\n        }\n        .item-wrap__checkboxes > span {\n          cursor: pointer;\n        }\n        .item-wrap__quantity {\n          display: flex;\n          flex-direction: column;\n          width: 80px;\n          flex-grow: 0;\n          flex-shrink: 0;\n          margin-left: auto;\n        }\n        vaadin-integer-field {\n          margin: -13px 0 8px;\n        }\n        vaadin-checkbox {\n          pointer-events: none;\n          font-size: 13px;\n        }\n        vaadin-checkbox.flash-error {\n          color: var(--mdc-theme-error);\n          transition: color 0.2s ease-out;\n          --lumo-contrast-20pct: var(--mdc-theme-error);\n        }\n        vaadin-checkbox.transition-bg {\n          transition: color 0.2s ease-in;\n        }\n\n        .details {\n          font-size: 14px;\n          width: calc(100% - 30px);\n          margin: 0 auto 13px !important;\n          background: var(--lumo-contrast-10pct);\n          border-radius: 4px;\n          padding: 14px;\n        }\n        \n        .details-row {\n          padding-top: 14px;\n          position: relative;\n          padding-bottom: 220px;\n        }\n\n        .details-wrap {\n          font-size: 14px;\n          background: var(--lumo-contrast-10pct);\n          border-radius: 4px;\n          line-height: 1.5;\n          padding: 14px;\n        }\n\n        .close-item {\n          margin-left: auto;\n          font-size: 32px;\n        }\n\n        @media(min-width: 420px) {\n          .heading {\n            justify-content: flex-start;\n          }\n          .reference-link {\n            margin-left: 8px;\n          }\n        }\n\n        @media(min-width: 921px) {\n          .item-wrap[active] {\n            background: var(--_lumo-grid-selected-row-color);\n          }\n          .row-wrap {\n            width: calc(50% - 10px);\n          }\n          .row-wrap:first-child {\n            margin-bottom: 0;\n          }\n          .details {\n            display: none;\n          }\n          .item-list-row[hidden]{\n            display: block !important;\n          }\n          .details-wrap {\n            display: block;\n          }\n          .close-item {\n            display: none;\n          }\n        }\n      </style>\n\n      <div class=\"heading\">\n        <h2>Inventory</h2>\n        <button class=\"mdc-icon-button material-icons\" hidden$=\"[[_hasActive(activeItem)]]\" on-click=\"_linkClick\">logout</button>\n        <button class=\"mdc-icon-button close-item material-icons\" hidden$=\"[[!_hasActive(activeItem)]]\" on-click=\"_clearSelection\">close</button>\n      </div>\n      <div class=\"col-wrap\">\n        <div class=\"row-wrap item-list-row\" hidden$=\"[[_hasActive(activeItem)]]\">\n          <vaadin-grid id=\"grid\" expanded-items=\"{{expandedItems}}\" active-item=\"{{activeItem}}\" height-by-rows rows-draggable theme=\"no-border no-row-borders no-row-padding\" >\n            <vaadin-grid-column>\n              <template>\n                <div class=\"item-wrap\" active$=\"[[_isActive(activeItem, item)]]\">\n                  <vaadin-grid-tree-toggle level$=[[level]] leaf=\"[[!item.container]]\" expanded=\"{{expanded}}\" theme$=[[_toggleTheme(item)]] on-click='_recordScrollHeight'></vaadin-grid-tree-toggle>\n                  <div class=\"item-wrap__name-wrap\" on-click=\"_expandDetails\">\n                    <span class=\"item-wrap__name\">[[item.name]]\n                      <span hidden$=\"[[!item.isEdited]]\" class=\"item-wrap__edited\">Edited</span>\n                    </span>\n                    <span class=\"item-wrap__type\">\n                      <span class=\"item-wrap__from\" hidden$=\"[[!item.fromBackground]]\">BG</span>\n                      <span class=\"item-wrap__from\" hidden$=\"[[!item.fromClass]]\">Class</span>\n                      <span>[[item.typeText]]<span hidden$=\"[[_noRarity(item.rarity, item)]]\">, [[item.rarity]]</span></span>\n                    </span>\n                  </div>\n                  <div hidden$=\"[[item.hasQuantity]]\" class=\"item-wrap__checkboxes\">\n                    <span on-click=\"_setItemEquipped\">\n                      <vaadin-checkbox checked=\"[[item.isEquipped]]\" hidden$=\"[[!item.canEquip]]\">Equip</vaadin-checkbox>\n                    </span>\n                    <span on-click=\"_setItemAttuned\">\n                      <vaadin-checkbox checked=\"[[item.isAttuned]]\" hidden$=\"[[!item.reqAttune]]\">Attune</vaadin-checkbox>\n                    </span>\n                  </div>\n                  <div hidden$=\"[[!item.hasQuantity]]\" class=\"item-wrap__quantity\">\n                    <!-- <vaadin-integer-field min=\"0\" value=\"{{item.quantity}}\" theme=\"mini\" has-controls on-change=\"_quantityChange\"></vaadin-integer-field> -->\n                  </div>\n                  <div class=\"mdc-buttom-icon material-icons item-wrap__close\" hidden$=\"[[!isEditMode]]\" on-click=\"_deleteItem\">close</div>\n                </div>\n              </template>\n            </vaadin-grid-column>\n          </vaadin-grid>\n        </div>\n\n        <div class=\"row-wrap details-row\" hidden$=\"[[!_hasActive(activeItem)]]\">\n          <div class=\"details-wrap\">          \n            <dnd-character-builder-equipment-item-detail small-render item=\"{{activeItem}}\"></dnd-character-builder-equipment-item-detail>\n          </div>\n        </div>\n      </div>\n    `;\n  }\n}\n\ncustomElements.define(\"dnd-character-builder-equipment\", DndCharacterBuilderEquipment);"],"sourceRoot":""}