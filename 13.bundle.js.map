{"version":3,"sources":["webpack:///./components/dnd-tabs.js","webpack:///./components/dnd-roll-results.js","webpack:///./components/dnd-roller.js","webpack:///./components/views/dnd-character-builder-view.js","webpack:///./components/dnd-icon.js","webpack:///./components/views/character lazy ^\\.\\/dnd\\-character\\-builder\\-.*$ namespace object"],"names":["tabs","type","Array","observer","initialSelectedIndex","Number","value","this","length","tabBar","$","removeEventListener","handleTabChange","setTimeout","addEventListener","activateTab","e","index","detail","dispatchEvent","CustomEvent","bubbles","composed","icon","scrollPosition","scrollWrap","scrollLeft","wrapWidth","clientWidth","maxScroll","dragWrap","style","width","position","left","scrollTo","target","closest","dragInitTimer","window","navigator","vibrate","undefined","_disableScrolling","draggedItem","model","__data","item","dragged","draggedIndex","splice","clearTimeout","preventDefault","touchLocation","targetTouches","pageX","_scrollIt","_checkDragPosition","containerBounds","getBoundingClientRect","containerLeftBound","containerRightBound","right","hasScrolled","scrollItInterval","setInterval","clearInterval","from","children","forEach","tab","tabBounds","leftBound","rightBound","_enableScrolling","customElements","define","rollResults","focusRoll","isOpen","Boolean","focusElement","shadowRoot","querySelector","focusDiceWrap","toggleAttribute","offsetWidth","scrollWidth","focusRollWrap","focusTitle","isCrit","super","connectedCallback","rollHandler","console","error","push","scrollAtBottom","Math","abs","scrollContainer","scrollHeight","clientHeight","scrollTop","top","behavior","roll","editModeHandler","isEditMode","disconnectedCallback","parseInt","getAttribute","document","activeElement","blur","animate","rollValue","rollSplit","match","a","b","array","bools","bool","d4","d6","d8","d10","d12","d20","d100","rolls","_toggleOpen","loading","characterName","String","initialSelectedTab","indexForTabs","routeSelection","deleteModalOpen","pulse","defaultTabs","menuItems","defaultMenu","tabChangeHandler","newTabIndex","newViewId","viewId","then","updateView","createElement","loadingHandler","setStateFromCharacter","characterChangeHandler","character","fixedTabsScrollHandler","matches","tabWrap","classList","add","remove","nameFieldFocusHandler","name","inputElement","select","isLoaded","tabTarget","newIndex","hidden","_selectionChangeHandler","selection","el","requestAnimationFrame","scrollY","appendChild","findIndex","classLevel","background","race","isNonCaster","choices","Object","values","find","c","additionalSpells","classRefs","classLevels","className","level","entries","classRef","casterProgression","subclasses","subclassDef","i","wasNonCaster","nonCasterTabs","tabOrder","component","createMenuItem","key","tooltip","text","openDeleteModal","downloadCharacter","downloadCharacters","fileSelector","click","iconName","isChild","height","marginRight","setAttribute","createTextNode","char","Blob","JSON","stringify","Date","toLocaleString","chars","event","fileList","files","log","timestamp","file","reader","FileReader","readFile","parse","result","readArray","isArray","readObject","readAsText","DndIcon","faType","map","webpackAsyncContext","req","__webpack_require__","o","Promise","resolve","Error","code","ids","id","all","slice","keys","module","exports"],"mappings":"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","file":"13.bundle.js","sourcesContent":["import {PolymerElement, html} from '@polymer/polymer';\nimport {MDCTabBar} from '@material/tab-bar';\nimport {} from '@polymer/polymer/lib/elements/dom-repeat.js';\nimport {} from '@polymer/polymer/lib/elements/dom-if.js';\nimport { cloneDeep } from '../js/utils';\nimport { saveTabOrder } from '../util/charBuilder';\n\nclass DndTabs extends PolymerElement {\n  static get properties() {\n    return {\n      tabs: {\n        type: Array,\n        observer: 'tabsChanged'\n      },\n      initialSelectedIndex: {\n        type: Number,\n        value: 0,\n        observer: 'selectedIndexChange'\n      }\n    }\n  }\n\n  tabsChanged() {\n    if (this.tabs.length) {\n      if (this.tabBar) {\n        this.$.tabs.removeEventListener(\"MDCTabBar:activated\", this.handleTabChange);\n      }\n      // Allow tabs to be rendered\n      setTimeout(() => {\n        this.tabBar = new MDCTabBar(this.$.tabs);\n        this.$.tabs.addEventListener(\"MDCTabBar:activated\", this.handleTabChange);\n        this.tabBar.activateTab(this.initialSelectedIndex);\n      }, 10);\n    }\n  }\n\n  selectedIndexChange() {\n    if (this.tabBar && this.initialSelectedIndex) {\n      this.tabBar.activateTab(this.initialSelectedIndex);\n    }\n  }\n\n  handleTabChange(e) {\n    const index = e.detail.index;\n    this.dispatchEvent(new CustomEvent(\"tabChange\",  {\n      bubbles: true,\n      composed: true,\n      detail: {\n        index\n      }\n    }));\n  }\n\n  _iconClass(icon) {\n    return `mdc-tab__icon fas fa-${icon}`;\n  }\n\n  _disableScrolling() {\n    this.scrollPosition = this.$.scrollWrap.scrollLeft;\n    const wrapWidth = this.$.scrollWrap.clientWidth;\n    this.maxScroll = this.$.dragWrap.clientWidth - wrapWidth;\n    this.$.scrollWrap.style.width = `${wrapWidth}px`;\n    this.$.dragWrap.style.position = \"absolute\";\n    this.$.dragWrap.style.left = `-${this.scrollPosition}px`;\n  }\n\n  _enableScrolling() {\n    this.$.scrollWrap.style.width = null;\n    this.$.dragWrap.style.position = null;\n    this.$.dragWrap.style.left = null;\n    setTimeout(() => {\n      this.$.scrollWrap.scrollTo(this.scrollPosition, 0);\n    }, 1);\n  }\n\n  _touchstart(e) {\n    const draggedTab = e.target.closest(\".mdc-tab\");\n\n    if (draggedTab) {\n      this.dragInitTimer = setTimeout(() => {\n        window.navigator.vibrate(20);\n        this.dragInitTimer = undefined;\n        this._disableScrolling();\n        this.draggedItem = {...e.model.__data.item, dragged: true};\n        this.draggedIndex = e.model.__data.index;\n        this.splice(\"tabs\", this.draggedIndex, 1);\n        this.splice(\"tabs\", this.draggedIndex, 0, cloneDeep(this.draggedItem));\n      }, 200);\n    }\n  }\n\n  _touchmove(e) {\n    if (this.dragInitTimer) {\n      clearTimeout(this.dragInitTimer);\n    } else {\n      e.preventDefault();\n      this.touchLocation = e.targetTouches[0].pageX;\n\n      this._scrollIt();\n      this._checkDragPosition();\n    }\n  }\n\n  _scrollIt() {\n    const containerBounds = this.$.tabs.getBoundingClientRect();\n    const containerLeftBound = containerBounds.left;\n    const containerRightBound = containerBounds.right;\n    let hasScrolled = false;\n\n    if (this.touchLocation - 75 < containerLeftBound && this.scrollPosition > 0) {\n      //scrollLeft\n      this.scrollPosition  = this.scrollPosition - 2;\n      this.$.dragWrap.style.left = `-${this.scrollPosition}px`;\n      hasScrolled = true;\n\n    } else if (this.touchLocation + 75 > containerRightBound && this.scrollPosition < this.maxScroll) {\n      //scrollRight\n      this.scrollPosition  = this.scrollPosition + 2;\n      this.$.dragWrap.style.left = `-${this.scrollPosition}px`;\n      hasScrolled = true;\n    }\n\n    if (hasScrolled) {\n      this._checkDragPosition();\n      \n      if (!this.scrollItInterval) {\n        this.scrollItInterval = setInterval(() => {\n          this._scrollIt();\n        }, 20);\n      }\n    } else {\n      clearInterval(this.scrollItInterval);\n      this.scrollItInterval = null;\n    }\n  }\n\n  _checkDragPosition() {\n    Array.from(this.$.dragWrap.children).forEach((tab, index) => {\n      const tabBounds = tab.getBoundingClientRect();\n      const leftBound = tabBounds.left;\n      const rightBound = tabBounds.right;\n\n      if (leftBound < this.touchLocation && rightBound > this.touchLocation) {\n        this.splice(\"tabs\", this.draggedIndex, 1);\n        this.splice(\"tabs\", index, 0, this.draggedItem);\n        this.draggedIndex = index;\n      }\n    });\n  }\n\n  _touchend() {\n    if (this.dragInitTimer) {\n      clearTimeout(this.dragInitTimer);\n    } else {\n      this._enableScrolling();\n      this.draggedItem.dragged = false;\n      this.splice(\"tabs\", this.draggedIndex, 1);\n      this.splice(\"tabs\", this.draggedIndex, 0, cloneDeep(this.draggedItem));\n      this.draggedItem = null;\n      this.draggedIndex = null;\n      saveTabOrder(this.tabs);\n    }\n  }\n\n  \n  static get template() {\n    return html`\n      <style include=\"material-styles fa-styles\">\n        .mdc-tab-bar {\n          max-width: 100vw;\n          line-height: 1;\n        }\n        .mdc-tab__icon {\n          width: unset;\n          height: unset;\n        }\n        :host([theme=\"large\"]) .mdc-tab {\n          height: 64px;\n          margin-left: -5px;\n        }\n        :host([theme=\"large\"]) .mdc-tab__icon {\n          font-size: 30px;\n        }\n        :host([theme=\"large\"]) .mdc-tab__text-label {\n          font-size: 20px;\n          padding-left: 16px;\n        }\n        :host([theme=\"large\"]) .mdc-tab__content {\n          margin-left: 6px;\n        }\n        :host([theme=\"large\"]) .mdc-tab .mdc-tab--active {\n          background-color: var(--lumo-primary-color-10pct);\n        }\n        :host([theme=\"large\"]) .mdc-tab-indicator .mdc-tab-indicator__content {\n          border-width: 6px;\n        }\n\n        .mdc-tab-scroller__scroll-area--scroll {\n          overflow-x: auto;\n          background-color: var(--mdc-theme-surface);\n          border: 1px solid var(--mdc-theme-text-divider-on-background);\n          border-bottom: none;\n        }\n        .mdc-tab-scroller__scroll-area {\n          height: 64px;\n        }\n        .mdc-tab[hidden] {\n          display: none;\n        }\n        .mdc-tab[dragged] {\n          background-color: var(--lumo-primary-color-10pct);\n          transform: scale(1.2);\n        }\n        .mdc-tab[dragged] .mdc-tab__icon {\n          /* display: none; */\n        }\n        .mdc-tab__ripple:after,\n        .mdc-tab__ripple:before {\n          opacity: 0 !important;\n        }\n      </style>\n\n      <div class=\"mdc-tab-bar\" role=\"tablist\" id=\"tabs\">\n        <div class=\"mdc-tab-scroller\">\n          <div class=\"mdc-tab-scroller__scroll-area\" id=\"scrollWrap\">\n            <div class=\"mdc-tab-scroller__scroll-content\" id=\"dragWrap\">\n              \n              <template is=\"dom-repeat\" items=\"[[tabs]]\">\n                \n                <button class=\"mdc-tab\" dragged$=\"[[item.dragged]]\" role=\"tab\" aria-selected=\"false\" tabindex=\"[[index]]\" hidden$=\"[[item.hidden]]\" on-touchstart=\"_touchstart\" on-touchmove=\"_touchmove\" on-touchend=\"_touchend\">\n                  <span class=\"mdc-tab__content\">\n                    <span class$=\"[[_iconClass(item.icon)]]\" aria-hidden=\"true\"></span>\n                    <span class=\"mdc-tab__text-label\">[[item.label]]</span>\n                  </span>\n                  <span class=\"mdc-tab-indicator\">\n                    <span class=\"mdc-tab-indicator__content mdc-tab-indicator__content--underline\"></span>\n                  </span>\n                  <span class=\"mdc-tab__ripple\"></span>\n                </button>\n\n              </template>\n            </div>\n          </div>\n        </div>\n      </div>\n    `;\n  }\n  \n}\ncustomElements.define('dnd-tabs', DndTabs);","import {PolymerElement, html} from '@polymer/polymer';\nimport \"./styles/material-styles.js\";\nimport \"./styles/my-styles.js\";\nimport { rollEventChannel } from '../util/roll.js';\nimport { getEditModeChannel } from '../util/editMode.js';\n\nclass DndRollResults extends PolymerElement {\n  \n  static get properties() {\n    return {\n      rollResults: {\n        type: Array,\n        value: []\n      },\n      focusRoll: {\n        type: Number,\n        value: 0,\n        observer: \"focusRollChange\"\n      },\n      isOpen: {\n        type: Boolean,\n        value: false\n      }\n    };\n  }\n\n  focusRollChange(focusRoll) {\n    setTimeout(() => {\n      const focusElement = this.shadowRoot.querySelector(`[index=\"${focusRoll}\"]`);\n      if (focusElement) {\n        const focusDiceWrap = focusElement.querySelector('.roll-result__dice-results');\n        focusDiceWrap.toggleAttribute('tooltip', focusDiceWrap.offsetWidth < focusDiceWrap.scrollWidth);\n        const focusRollWrap = focusElement.querySelector('.roll-result__roll');\n        focusRollWrap.toggleAttribute('tooltip', focusRollWrap.offsetWidth < focusRollWrap.scrollWidth);\n        const focusTitle = focusElement.querySelector('.roll-result__title');\n        focusTitle.toggleAttribute('tooltip', focusTitle.offsetWidth < focusTitle.scrollWidth || this.rollResults[focusRoll] && this.rollResults[focusRoll].isCrit);\n      }\n    }, 500);\n  }\n\n  \n  connectedCallback() {\n    super.connectedCallback();\n\n    this.rollHandler = (e) => {\n      console.error('new-roll', e.detail);\n      this.push('rollResults', e.detail);\n      this.focusRoll = this.rollResults.length - 1;\n      this.isOpen = true;\n\n      const scrollAtBottom = Math.abs(this.$.scrollContainer.scrollHeight - this.$.scrollContainer.clientHeight - this.$.scrollContainer.scrollTop) < 1\n\n      setTimeout(() => {\n        this.$.scrollContainer.scrollTo({top: this.$.scrollContainer.scrollHeight, behavior: scrollAtBottom ? 'instant' : 'smooth'});\n      }, 0);\n    };\n    rollEventChannel().addEventListener('new-roll', this.rollHandler);\n\n    this.editModeHandler = (e) => {\n      if (e.detail.isEditMode) {\n        this.isOpen = false;\n      }\n    };\n    getEditModeChannel().addEventListener('editModeChange', this.editModeHandler);\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n    rollEventChannel().removeEventListener('new-roll', this.rollHandler);\n    getEditModeChannel().removeEventListener('editModeChange', this.editModeHandler);\n  }\n\n  _setFocusRoll(e) {\n    const index = parseInt(e.target.closest('.roll-result').getAttribute('index'));\n    if (this.focusRoll !== index) {\n      document.activeElement.blur();\n      this.animate = true;\n      setTimeout(() => {\n        this.animate = false;\n      }, 500);\n    }\n    this.focusRoll = index;\n  }\n\n  _deleteRoll(e) {\n    const index = parseInt(e.target.closest('.roll-result').getAttribute('index'));\n    this.splice('rollResults', index, 1);\n    setTimeout(() => {\n      if (this.focusRoll > this.rollResults.length - 1) {\n        this.focusRoll = this.rollResults.length - 1;\n      }\n    }, 0);\n    if (this.rollResults.length === 0) {\n      this.isOpen = false;\n    }\n  }\n\n  _toggleOpen() {\n    this.isOpen = !this.isOpen;\n  }\n\n  _clearRolls() {\n    this.rollResults = [];\n    this.isOpen = false;\n  }\n\n  _diceIconClass(roll) {\n    let rollValue = '20';\n    if (roll) {\n      const rollSplit = roll.match(/(?:d)(\\d+)/);\n      if (rollSplit && rollSplit.length > 1) {\n        rollValue = rollSplit[1];\n      }\n    }\n    return `roll-result__dice fal fa-dice-d${rollValue}`;\n  }\n\n  _equals(a, b) {\n    return a === b;\n  }\n\n  _isLast(index, array) {\n    return array.length && array.length - 1 === index;\n  }\n\n  _and(a, b) {\n    return a && b;\n  }\n\n  _or(...bools) {\n    for (let bool of bools) {\n      if (bool) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  static get template() {\n    return html`\n      <style include=\"material-styles fa-styles\">\n\n        [hidden] {\n          display: none !important;\n        }\n\n        .roll-results__toggle-btn {\n          position: absolute;\n          right: 90px;\n          bottom: 4px;\n          height: 20px;\n          border-radius: 20px;\n          width: 60px;\n          z-index: 3;\n        }\n        .roll-results__toggle-btn[open] {\n          transform: rotate(180deg);\n        }\n        .roll-results__toggle-btn[disabled] {\n          display: none;\n        }\n        .roll-results__clear-btn {\n          background: var(--mdc-theme-primary);\n          color: var(--mdc-theme-on-primary);\n          font-size: 14px;\n          font-weight: bold;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          cursor: pointer;\n          position: absolute;\n          bottom: 4px;\n          height: 24px;\n          border-radius: 20px;\n          width: 60px;\n          z-index: 3;\n          right: 168px;\n        }\n\n        .roll-results {\n          position: absolute;\n          bottom: -250px;\n          right: calc(100% - 20px);\n          flex-direction: column;\n          align-items: flex-end;\n          width: 110vw;\n          margin-bottom: -20px;\n          margin-right: -92px;\n          pointer-events: none;\n          transition: bottom 0.2s;\n        }\n        .roll-results[open] {\n          bottom: -4px;\n        }\n        .roll-results__mask {\n          position: fixed;\n          right: 0;\n          bottom: 63px;\n          width: 100%;\n          height: 100%;\n          max-width: 800px;\n          max-height: 255px;\n          opacity: 0;\n          transition: opacity 0.2s;\n        }\n        .roll-results[open] .roll-results__mask {\n          opacity: 1;\n        }\n        .roll-results__background {\n          width: 100%;\n          height: 100%;\n          background: linear-gradient(0deg, black, transparent);\n        }\n        .roll-results__scroll-container {\n          max-height: 202px;\n          overflow-y: scroll;\n          scroll-snap-type: y mandatory;\n          display: flex;\n          flex-direction: column;\n          align-items: flex-end;\n          pointer-events: all;\n          padding: 0 17px 50px 0;\n          box-sizing: content-box;\n          width: 100%;\n        }\n        .roll-results__scroll-wrap {\n          position: relative;\n          right: 133px;\n          z-index: 2;\n          overflow: hidden;\n          width: fit-content;\n          margin-left: auto;\n        }\n\n        .roll-result {\n          background: var(--mdc-theme-surface-surface);\n          color: var(--mdc-theme-on-surface);\n          border-radius: 6px;\n          margin-bottom: 16px;\n          display: flex;\n          width: 225px;\n          padding: 12px;\n          height: 82px;\n          outline: none;\n          scroll-snap-align: start;\n          position: relative;\n          user-select: none;\n        }\n        .roll-result[animate] {\n          transition: height 0.3s, width 0.3s;\n        }\n        .roll-result[crit]:before {\n          content: 'CRITICAL!!!';\n          color: var(--lumo-error-color);\n          position: absolute;\n          left: -15px;\n          top: -4px;\n          font-weight: bold;\n          transform: rotate(-12deg);\n          background: var(--mdc-theme-surface-surface);\n          padding: 0 8px;\n          border: 2px solid var(--lumo-error-color);\n          pointer-events: none;\n        }\n        .roll-result[animate][crit]:before {\n          transition: left 0.3s, top 0.3s, transform 0.3s;\n        }\n        .roll-result[crit][little]:before {\n          left: 13px;\n          top: 10px;\n          transform: rotate(0deg);\n        }\n        .roll-result__summary {\n          display: flex;\n          flex-direction: column;\n          overflow: hidden;\n          padding-right: 10px;\n          border-right: 1px solid var(--mdc-theme-on-surface-surface);\n          margin-right: 10px;\n          flex-grow: 1;\n        }\n        .roll-result:after {\n          content: '=';\n          font-size: 29px;\n          padding: 0px 0 3px;\n          background: var(--mdc-theme-surface-surface);\n          color: var(--mdc-theme-on-surface-surface);\n          position: absolute;\n          right: 78px;\n          line-height: 1;\n          top: 34px;\n          opacity: 1;\n        }\n        .roll-result[animate]:after {\n          transition: opacity 0.3s, top 0.3s, right 0.3s;\n        }\n        \n        .roll-result__title {\n          margin-top: -4px;\n          margin-bottom: 4px;\n          overflow: hidden;\n          width: auto;\n          white-space: nowrap;\n          text-overflow: ellipsis;\n          font-size: 14px;\n          font-weight: bold;\n        }\n        .roll-result__type {\n          color: var(--mdc-theme-primary);\n        }\n        .roll-result__type-separator {\n          margin-left: -4px;\n        }\n        .roll-result__total {\n          font-size: 32px;\n          font-weight: bold;\n          justify-content: center;\n          display: flex;\n          align-items: center;\n          width: 64px;\n          flex-shrink: 0;\n        }\n        .roll-result[animate] .roll-result__total {\n          transition: width 0.3s, font-size 0.3s;\n        }\n        .roll-result__dice-wrap {\n          display: flex;\n          align-items: center;\n          height: 30px;\n          overflow: hidden;\n        }\n        .roll-result[animate] .roll-result__dice-wrap {\n          transition: height 0.3s;\n        }\n        .roll-result__dice {\n          font-size: 30px;\n          margin-right: 10px;\n          color: var(--mdc-theme-on-surface-surface);\n        }\n        .roll-result__dice-results {\n          font-size: 20px;\n          font-weight: bold;\n          overflow: hidden;\n          text-overflow: ellipsis;\n        }\n        .roll-result__dice-results .tooltip {\n          font-size: 16px;\n          bottom: 30px;\n          top: unset;\n        }\n        .roll-result__dice-results span {\n          color: var(--mdc-theme-on-surface-surface);\n          position: relative;\n          font-size: 17px;\n          bottom: 7px;\n          margin: 0 2px;\n        }\n        .roll-result__dice-results span:after {\n          display: block;\n          content: '';\n          position: absolute;\n          left: -3px;\n          bottom: 9px;\n          border-bottom: 1px solid var(--mdc-theme-on-surface-surface);\n          width: 150%;\n          transform: rotate(-25deg);\n        }\n        .roll-result__roll {\n          color: var(--mdc-theme-on-surface-surface);\n          font-weight: bold;\n          height: 28px;\n          overflow: hidden;\n          align-items: flex-end;\n          line-height: 1;\n          text-overflow: ellipsis;\n        }\n        .roll-result[animate] .roll-result__roll {\n          transition: height 0.3s;\n        }\n        .roll-result__roll[flex] {\n          display: flex;\n        }\n        .roll-result__roll:not([flex]) {\n          line-height: 36px;\n        }\n        .roll-result__roll span {\n          font-size: 10px;\n          line-height: 1;\n          width: min-content;\n          margin-right: auto;\n          display: inline-flex;\n        }\n        .roll-result__roll .tooltip {\n          font-size: 16px;\n          color: var(--mdc-theme-on-surface-surface);\n          bottom: 0;\n          top: unset;\n        }\n        .roll-result__close {\n          position: absolute;\n          height: 20px;\n          width: 20px;\n          right: 0px;\n          top: 0px;\n          border: 0;\n          margin: 0;\n          background: none;\n          padding: 15px;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          cursor: pointer;\n          color: var(--mdc-theme-on-surface);\n        }\n\n        .roll-result[little] {\n          width: 175px;\n          height: 24px;\n          cursor: zoom-in;\n        }\n        .roll-result[little] .roll-result__dice-wrap {\n          height: 0;\n        }\n        .roll-result[little] .roll-result__roll {\n          height: 0;\n        }\n        .roll-result[little]:after {\n          opacity: 0;\n          right: 47px;\n          top: 7px;\n        }\n        .roll-result[little] .roll-result__total {\n          font-size: 18px;\n          width: 34px;\n        }\n        .roll-result[little] .roll-result__title {\n          margin: 0;\n        }\n        .roll-result[little] .roll-result__close {\n          display: none;\n        }\n\n        @media(max-width: 420px) {\n          .roll-result:not([little]) .tooltip-wrap:focus .tooltip {\n            display: block;\n          }\n        }\n\n        .roll-result:not([little]) .tooltip-wrap:hover .tooltip {\n          display: block;\n        }\n        .tooltip-wrap:focus {\n          outline: none;\n        }\n        .tooltip-wrap:not([tooltip]) .tooltip {\n          display: none !important;\n        }\n        .tooltip {\n          position: absolute;\n          background: var(--mdc-theme-surface-surface);\n          color: var(--mdc-theme-on-surface);\n          font-size: 14px;\n          font-weight: bold;\n          padding: 9.5px 12px;\n          border-radius: 6px;\n          left: 0;\n          top: 0;\n          display: none;\n          word-wrap: break-word;\n          width: calc(100% - 55px);\n          z-index: 2;\n          pointer-events: none;\n          line-height: 1.5;\n          white-space: normal;\n          box-shadow:\n            0px 3px 5px -1px rgba(0, 0, 0, 0.2),\n            0px 6px 10px 0px rgba(0, 0, 0, 0.14),\n            0px 1px 18px 0px rgba(0, 0, 0, .12);\n        }\n        .tooltip .roll-result__name {\n          white-space: normal;\n        }\n\n        @media(min-width: 420px) {\n          .roll-results__mask {\n            bottom: 0;\n            -webkit-mask-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 1));\n            mask-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 1));\n          }\n        }\n\n        @media(min-width: 921px) {\n          .roll-results {\n            bottom: -380px;\n          }\n          .roll-results__scroll-container {\n            max-height: 330px;\n          }\n          .roll-results__mask {\n            max-height: 400px;\n          }\n          .roll-results__toggle-btn {\n            right: 100px;\n          }\n          .roll-results__clear-btn {\n            right: 178px;\n          }\n          .roll-result {\n            width: min-content !important;\n          }\n        }\n      </style>\n      <div class=\"roll-results__clear-btn\" on-click=\"_clearRolls\" hidden$=[[!isOpen]]>Clear</div>\n      <button class=\"roll-results__toggle-btn mdc-icon-button mdc-button--raised\" on-click=\"_toggleOpen\" disabled$=\"[[_equals(rollResults.length, 0)]]\" open$=[[isOpen]]>\n        <i class=\"fas fa-angle-up\"></i>\n      </button>\n      <div class=\"roll-results\" open$=\"[[isOpen]]\">\n        <div class=\"roll-results__scroll-wrap\">\n          <div class=\"roll-results__scroll-container\" id=\"scrollContainer\">\n            <template is=\"dom-repeat\" items=\"[[rollResults]]\">\n              <div class=\"roll-result\" animate$=\"[[animate]]\" crit$=\"[[item.isCrit]]\" little$=\"[[!_equals(index, focusRoll)]]\" on-click=\"_setFocusRoll\" index$=\"[[index]]\">\n                <div class=\"roll-result__summary\">\n                  <div class=\"roll-result__title tooltip-wrap\" tabindex=\"0\">\n                    <span class=\"roll-result__type\">[[item.type]]</span>\n                    <span class=\"roll-result__type-separator\" hidden$=\"[[!_and(item.name, item.type)]]\">:</span>\n                    <span class=\"roll-result__name\">[[item.name]]</span>\n                    <div class=\"tooltip\">\n                      <span class=\"roll-result__type\">[[item.type]]</span>\n                      <span class=\"roll-result__type-separator\" hidden$=\"[[!_and(item.name, item.type)]]\">:</span>\n                      <span class=\"roll-result__name\">[[item.name]]</span>\n                    </div>\n                  </div>\n                  <div class=\"roll-result__dice-wrap\">\n                    <i class$=\"[[_diceIconClass(item.roll)]]\"></i>\n                    <div class=\"roll-result__dice-results tooltip-wrap\" tabindex=\"0\" inner-h-t-m-l=\"[[item.result]]\"></div>\n                  </div>\n                  <div class=\"roll-result__roll tooltip-wrap\" flex$=\"[[_or(item.adv, item.disadv, item.doubleAdv)]]\" tabindex=\"0\" inner-h-t-m-l=\"[[item.roll]]\"></div>\n                </div>\n                <div class=\"roll-result__total\">[[item.total]]</div>\n                <button class=\"roll-result__close fal fa-times\" on-click=\"_deleteRoll\"></button>\n              </div>\n            </template>\n          </div>\n        </div>\n        <div class=\"roll-results__mask\">\n          <div class=\"roll-results__background\"></div>\n        </div>\n      </div>\n    `;\n  }\n}\n\ncustomElements.define('dnd-roll-results', DndRollResults);","import {PolymerElement, html} from '@polymer/polymer';\nimport \"./styles/material-styles.js\";\nimport \"./styles/my-styles.js\";\nimport { rollMultipleDice } from '../util/roll.js';\n\nclass DndRoller extends PolymerElement {\n  \n  static get properties() {\n    return {\n      isOpen: {\n        type: Boolean,\n        value: false\n      },\n      d4: {\n        type: Number,\n        value: 0\n      },\n      d6: {\n        type: Number,\n        value: 0\n      },\n      d8: {\n        type: Number,\n        value: 0\n      },\n      d10: {\n        type: Number,\n        value: 0\n      },\n      d12: {\n        type: Number,\n        value: 0\n      },\n      d20: {\n        type: Number,\n        value: 0\n      },\n      d100: {\n        type: Number,\n        value: 0\n      }\n    };\n  }\n\n  _increaseRoll(e) {\n    const roll = e.target.closest('.roller__btn').getAttribute(\"roll\");\n    this[roll] ++;\n  }\n\n  _toggleOpen() {\n    this.isOpen = !this.isOpen;\n    if (!this.isOpen) {\n      this.d4 = 0;\n      this.d6 = 0;\n      this.d8 = 0;\n      this.d10 = 0;\n      this.d12 = 0;\n      this.d20 = 0;\n      this.d100 = 0;\n    }\n  }\n\n  _rollIt() {\n    const rolls = [];\n    if (this.d20) {\n      rolls.push(`${this.d20}d20`);\n    }\n    if (this.d12) {\n      rolls.push(`${this.d12}d12`);\n    }\n    if (this.d10) {\n      rolls.push(`${this.d10}d10`);\n    }\n    if (this.d8) {\n      rolls.push(`${this.d8}d8`);\n    }\n    if (this.d6) {\n      rolls.push(`${this.d6}d6`);\n    }\n    if (this.d4) {\n      rolls.push(`${this.d4}d4`);\n    }\n    if (this.d100) {\n      rolls.push(`${this.d100}d100`);\n    }\n    if (rolls.length) {\n      rollMultipleDice('Custom', rolls);\n    }\n    this._toggleOpen();\n  }\n\n  _equals(a, b) {\n    return a === b;\n  }\n\n  static get template() {\n    return html`\n      <style include=\"fa-styles material-styles my-styles\">\n        :host {\n          display: block;\n          margin-bottom: 12px;\n        }\n        .roller__btn {\n          border-radius: 50%;\n          z-index: 2;\n          margin-top: 8px;\n        }\n        .roller__btn-count {\n          position: absolute;\n          background: var(--mdc-theme-surface);\n          color: var(--mdc-theme-on-surface);\n          font-size: 13px;\n          z-index: 23;\n          right: 0px;\n          border-radius: 20px;\n          padding: 2px 5px;\n          bottom: -2px;\n          font-family: sans-serif;\n          box-shadow:\n            0px 3px 1px -2px rgba(0, 0, 0, 0.2), \n            0px 2px 2px 0px rgba(0, 0, 0, 0.14), \n            0px 1px 5px 0px rgba(0, 0, 0, .12);\n        }\n        .roller__expand-btn {\n          width: 48px;\n          height: 48px;\n          border-radius: 40px;\n          overflow: hidden;\n          margin-top: 12px;\n          display: flex;\n          justify-content: space-between;\n          z-index: 2;\n          position: absolute;\n          bottom: 0;\n          right: -24px;\n          background: transparent;\n          padding: 0;\n          transition: width 0.3s, right 0.3s;\n        }\n        [open] .roller__expand-btn {\n          width: 100px;\n          background: var(--mdc-theme-surface-surface);\n          right: -44px;\n        }\n        .roller__open-btn {\n          margin-top: 0;\n          background: var(--mdc-theme-primary);\n        }\n        .roller__roll-btn {\n          border: none;\n          padding: 0;\n          margin: 0;\n          background: none;\n          font-size: 16px;\n          flex-grow: 1;\n          padding-right: 8px;\n          color: var(--mdc-theme-on-surface);\n          cursor: pointer;\n          display: none;\n        }\n        [open] .roller__roll-btn {\n          display: block;\n        }\n        .roller__container {\n          display: flex;\n          flex-direction: column-reverse;\n          padding-bottom: 60px;\n          position: relative;\n        }\n        .roller__additional {\n          display: flex;\n          flex-direction: column-reverse;\n          align-items: center;\n          position: absolute;\n          right: -100px;\n          bottom: 60px;\n          transition: right 0.3s;\n        }\n        [open] .roller__additional {\n          right: -24px;\n        }\n        .d100 i {\n          font-size: 16px;\n        }\n        .d100 i:first-child {\n          margin-right: 3px;\n        }\n\n        @media(min-width: 921px) {\n          :host {\n            margin-bottom: 30px;\n          }\n        }\n      </style>\n\n      <div class=\"roller__container\" open$=\"[[isOpen]]\">\n        <div class=\"roller__expand-btn mdc-button--raised \">\n          <button class=\"roller__open-btn roller__btn mdc-icon-button material-icons\" on-click=\"_toggleOpen\">\n            <i class=\"fa fa-dice-d20\" hidden$=\"[[isOpen]]\"></i>\n            <i class=\"fal fa-times\" hidden$=\"[[!isOpen]]\"></i>\n          </button>\n          <button class=\"roller__roll-btn\" on-click=\"_rollIt\">Roll!</button>\n        </div>\n\n        <div class=\"roller__additional\">\n          <button class=\"roller__btn mdc-icon-button mdc-button--raised material-icons\" roll=\"d20\" on-click=\"_increaseRoll\">\n            <i class=\"fal fa-dice-d20\"></i>\n            <span class=\"roller__btn-count\" hidden$=\"[[_equals(d20, 0)]]\">[[d20]]</span>\n          </button>\n          <button class=\"roller__btn mdc-icon-button mdc-button--raised material-icons\" roll=\"d12\" on-click=\"_increaseRoll\">\n            <i class=\"fal fa-dice-d12\"></i>\n            <span class=\"roller__btn-count\" hidden$=\"[[_equals(d12, 0)]]\">[[d12]]</span>\n          </button>\n          <button class=\"roller__btn mdc-icon-button mdc-button--raised material-icons\" roll=\"d10\" on-click=\"_increaseRoll\">\n            <i class=\"fal fa-dice-d10\"></i>\n            <span class=\"roller__btn-count\" hidden$=\"[[_equals(d10, 0)]]\">[[d10]]</span>\n          </button>\n          <button class=\"roller__btn mdc-icon-button mdc-button--raised material-icons\" roll=\"d8\" on-click=\"_increaseRoll\">\n            <i class=\"fal fa-dice-d8\"></i>\n            <span class=\"roller__btn-count\" hidden$=\"[[_equals(d8, 0)]]\">[[d8]]</span>\n          </button>\n          <button class=\"roller__btn mdc-icon-button mdc-button--raised material-icons\" roll=\"d6\" on-click=\"_increaseRoll\">\n            <i class=\"fal fa-dice-d6\"></i>\n            <span class=\"roller__btn-count\" hidden$=\"[[_equals(d6, 0)]]\">[[d6]]</span>\n          </button>\n          <button class=\"roller__btn mdc-icon-button mdc-button--raised material-icons\" roll=\"d4\" on-click=\"_increaseRoll\">\n            <i class=\"fal fa-dice-d4\"></i>\n            <span class=\"roller__btn-count\" hidden$=\"[[_equals(d4, 0)]]\">[[d4]]</span>\n          </button>\n          <button class=\"roller__btn mdc-icon-button mdc-button--raised material-icons d100\" roll=\"d100\" on-click=\"_increaseRoll\">\n            <i class=\"fal fa-dice-d10\"></i>\n            <i class=\"fal fa-dice-d10\"></i>\n            <span class=\"roller__btn-count\" hidden$=\"[[_equals(d100, 0)]]\">[[d100]]</span>\n          </button>\n        </div>\n      </div>\n    `;\n  }\n}\n\ncustomElements.define('dnd-roller', DndRoller);","import {PolymerElement, html} from '@polymer/polymer';\nimport \"../styles/material-styles.js\";\nimport \"../styles/my-styles.js\";\nimport \"../dnd-tabs.js\";\nimport \"../dnd-character-select\";\nimport \"../dnd-spinner\";\nimport \"../dnd-icon\";\nimport \"../dnd-roll-results\";\nimport \"../dnd-roller\";\nimport { jqEmpty } from \"../../js/utils.js\";\nimport { saveAs } from 'file-saver';\nimport { getCharacterChannel, getSelectedCharacter, updateName, getClassString, getFeatureString, addCharacter, removeSelectedCharacter, getClassReferences, getClassLevelGroups, uploadCharacter, getCharacters, cloneCharacter, getTabOrder } from '../../util/charBuilder.js';\nimport registerSwipe from '../../util/swipe.js';\nimport { dispatchEditModeChange, getEditModeChannel, isEditMode } from '../../util/editMode.js';\nimport { rollEventChannel } from '../../util/roll.js';\nimport { readRouteSelection, routeEventChannel, setRouteSelection } from '../../util/routing.js';\nimport { togglePrimarySecondary } from '../../util/darkmode.js';\nimport '@vaadin/vaadin-dialog';\nimport '@vaadin/vaadin-menu-bar';\n\nclass DndCharacterBuilderView extends PolymerElement {\n  static get properties() {\n    return {\n      loading: {\n        type: Boolean,\n        value: true\n      },\n      characterName: {\n        type: String,\n        value: ''\n      },\n      initialSelectedTab: {\n        type: Number,\n        value: 0\n      },\n      indexForTabs: {\n        type: Number,\n        value: 0\n      },\n      isEditMode: {\n        type: Boolean,\n        value: false\n      },\n      routeSelection: {\n        type: String,\n        observer: 'routeSelectionChange'\n      },\n      deleteModalOpen: {\n        type: Boolean,\n        value: false\n      },\n      pulse: {\n        type: Boolean,\n        value: true\n      }\n    }\n  }\n\n  static get observers() {\n    return ['_setName(characterName)']\n  }\n\n  _setName(characterName) {\n    if (characterName) {\n      updateName(characterName);\n    }\n  }\n\n  constructor() {\n    super();\n\n    // this.tabs = [\n    //   { label: \"Attributes & Proficiencies\", icon: \"favorite\", viewId: \"attributes\" },\n    //   { label: \"Class Levels\", icon: \"class\", viewId: \"class\" },\n    //   { label: \"Race & Background\", icon: \"face\", viewId: \"background-race\" },\n    //   { label: \"Spells\", icon: \"flash_on\", viewId: \"spells\" },\n    //   { label: \"Equipment\", icon: \"local_grocery_store\", viewId: \"equipment\" },\n    // ]\n    \n    this.tabs = this.defaultTabs();\n    this.menuItems = this.defaultMenu();\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n\n    this.tabChangeHandler = (e) => {\n      let newTabIndex = e.detail.index,\n        newViewId = this.tabs[newTabIndex].viewId;\n\n      setRouteSelection(newViewId);\n\n      this.indexForTabs = newTabIndex;\n      if (newViewId !== undefined) {\n        this.loading = true;\n        import(`./character/dnd-character-builder-${newViewId}`)\n          .then(() => {\n            this.updateView(document.createElement(`dnd-character-builder-${newViewId}`));\n          });\n      }\n    };\n    this.addEventListener(\"tabChange\", this.tabChangeHandler);\n\n    this.loadingHandler = () => {\n      setTimeout(() => {\n        this.loading = false;\n      }, 0);\n    };\n    this.addEventListener(\"loadingChange\", this.loadingHandler);\n\n    this.setStateFromCharacter(getSelectedCharacter());\n    this.characterChangeHandler = (e) => {\n      console.error('character_change_handler', e.detail.character);\n      this.setStateFromCharacter(e.detail.character);\n    };\n    getCharacterChannel().addEventListener(\"character-selected\", this.characterChangeHandler);\n\n    this.fixedTabsScrollHandler = () => {\n      const isBottomFixed = this.$.tabs.matches('.fixed--bottom');\n\n      if (isBottomFixed) {\n        return;\n      }\n      \n      const heightDiff = this.$.tabWrap.getBoundingClientRect().top;\n\n      if (heightDiff <= 104) {\n        this.$.tabs.classList.add('fixed');\n      } else {\n        this.$.tabs.classList.remove('fixed');\n      }\n    };\n    window.addEventListener('scroll', this.fixedTabsScrollHandler);\n    this.$.tabs.classList.remove('fixed');\n\n    this.nameFieldFocusHandler = (e) => {\n      if (this.$.name.value === \"New Character\") {\n        this.$.name.inputElement.select();\n      }\n    }\n    this.$.name.addEventListener(\"focus\", this.nameFieldFocusHandler);\n\n    // this.fixedNameWrapScrollHandler = () => {\n    //   const clientRect = this.$.nameWrapWatch.getBoundingClientRect();\n    //   console.error(clientRect.top * -1 + 100);\n\n    //   if (clientRect.bottom <= 50) {\n    //     this.$.nameWrap.classList.add('fixed');\n    //     this.$.nameWrapWatch.classList.add('fixed');\n    //     window.document.body.children[0].shadowRoot.children[0]\n    //       .shadowRoot.getElementById(\"breadcrumbcontainer\").style.top = '-46px';\n    //   } else {\n    //     const breadcrumbAdjustment = clientRect.top * -1 + 100;\n    //     window.document.body.children[0].shadowRoot.children[0]\n    //       .shadowRoot.getElementById(\"breadcrumbcontainer\")\n    //       .style.top = breadcrumbAdjustment > 0 ? `-${breadcrumbAdjustment}px` : '0px';\n    //     this.$.nameWrap.classList.remove('fixed');\n    //     this.$.nameWrapWatch.classList.remove('fixed');\n    //   }\n    // };\n    // window.addEventListener('scroll', this.fixedNameWrapScrollHandler, {passive: true});\n\n    this.editModeHandler = (e) => {\n      this.isEditMode = e.detail.isEditMode;\n      this.pulse = false;\n      togglePrimarySecondary(this.isEditMode, this);\n    }\n    getEditModeChannel().addEventListener('editModeChange', this.editModeHandler);\n    this.isEditMode = isEditMode();\n\n    if (!this.isLoaded) {\n      this.isLoaded = true;\n      registerSwipe(this.$.tabTarget, \"right\", () => {\n        if (this.indexForTabs > 0) {\n          const newIndex = this.indexForTabs - 1;\n          if (!this.tabs[newIndex].hidden) {\n            this.$.tabs.tabBar.activateTab(newIndex);\n          } else if (this.indexForTabs > 1) {\n            const newIndex = this.indexForTabs - 2;\n            this.$.tabs.tabBar.activateTab(newIndex);\n          }\n        }\n      },null, \".table\");\n      registerSwipe(this.$.tabTarget, \"left\", () => {\n        if (this.indexForTabs < this.tabs.length - 1) {\n          const newIndex = this.indexForTabs + 1;\n          if (!this.tabs[newIndex].hidden) {\n            this.$.tabs.tabBar.activateTab(newIndex);\n          } else if (this.indexForTabs < this.tabs.length - 2) {\n            const newIndex = this.indexForTabs + 2;\n            this.$.tabs.tabBar.activateTab(newIndex);\n          }\n        }\n      }, null, \".table\");\n    }\n\n    this._selectionChangeHandler = (e) => {\n      if (e && e.detail && e.detail.selection) {\n        this.routeSelection = e.detail.selection;\n      }\n    };\n    routeEventChannel().addEventListener(\"selection-change\", this._selectionChangeHandler);\n    this.routeSelection = readRouteSelection();\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n\n    this.removeEventListener(\"tabChange\", this.tabChangeHandler);\n    this.removeEventListener(\"loadingChange\", this.loadingHandler);\n    window.removeEventListener('scroll', this.fixedTabsScrollHandler);\n    getCharacterChannel().removeEventListener(\"character-selected\", this.characterChangeHandler);\n    this.$.name.removeEventListener(\"focus\", this.nameFieldFocusHandler);\n    // window.removeEventListener('scroll', this.fixedNameWrapScrollHandler);\n    getEditModeChannel().removeEventListener('editModeChange', this.editModeHandler);\n  }\n\n  updateView(el) {\n    window.requestAnimationFrame(() => {\n      const scrollHeight = window.scrollY;\n      jqEmpty(this.$.tabTarget);\n      this.$.tabTarget.appendChild(el);\n      this.$.tabs.classList.remove('fixed');\n      window.scrollTo(0, scrollHeight);\n    });\n  }\n  \n  routeSelectionChange() {\n    if (this.tabs && this.routeSelection) {\n      const newViewId = this.tabs.findIndex((tab) => tab.viewId === this.routeSelection);\n      if (newViewId > -1) {\n        this.initialSelectedTab = newViewId;\n      } else {\n        this.initialSelectedTab = 0;\n      }\n    }\n  }\n\n  async setStateFromCharacter(character) {\n    this.characterName = character.name;\n    this.classLevel = getClassString(character);\n    this.background = getFeatureString(\"backgrounds\", character, true);\n    this.race = getFeatureString(\"races\", character, true);\n\n    // Set Tabs order based on tab order\n    let isNonCaster = true;\n    if (character) {\n      if (character.choices && Object.values(character.choices).find(c => c.additionalSpells)) {\n        isNonCaster = false;\n      } else {\n        const classRefs = await getClassReferences(character),\n          classLevels = getClassLevelGroups(character);\n\n        for (const [ className, level ] of Object.entries(classLevels)) {\n          const classRef = classRefs[className];\n\n          if (classRef.casterProgression) {\n            isNonCaster = false;\n          }\n\n          if (character.subclasses && character.subclasses[className] && classRef.subclasses && classRef.subclasses.length) {\n            const subclassDef = classRef.subclasses.find(i => character.subclasses[className].name === i.name);\n\n            if (subclassDef && subclassDef.casterProgression) {\n              isNonCaster = false;\n            }\n          }\n        }\n      }\n    }\n\n    if (this.wasNonCaster !== isNonCaster) {\n      this.wasNonCaster = isNonCaster;\n      if (isNonCaster) {\n        this.tabs = this.nonCasterTabs();\n      } else {\n        this.tabs = this.defaultTabs();\n      }\n    }\n  }\n\n  defaultTabs() {\n    const tabOrder = getTabOrder();\n    tabOrder.forEach((tab) => {\n      if (tab.viewId === \"spells\") {\n        tab.hidden = false;\n      }\n    });\n    return tabOrder;\n  }\n\n  nonCasterTabs() {\n    const tabOrder = getTabOrder();\n    tabOrder.forEach((tab) => {\n      if (tab.viewId === \"spells\") {\n        tab.hidden = true;\n      }\n    });\n    return tabOrder;\n  }\n  \n  defaultMenu() {\n    return [\n      { component: this.createMenuItem('user-plus'), key: 'add', tooltip: 'Create New Character'},\n      { component: this.createMenuItem('user-slash'), key: 'delete' , tooltip: 'Delete Character'},\n      { component: this.createMenuItem('clone'), key: 'clone' , tooltip: 'Clone Character'},\n      { component: this.createMenuItem('download'), tooltip: 'Download Character Data', children: [\n        { text: 'Download', key: 'download' },\n        { text: 'Download All', key: 'download-all' }\n      ]},\n      { component: this.createMenuItem('upload'), tooltip: 'Upload Character Data', key: 'upload' }\n    ];\n  }\n\n  _menuItemSelected(e) {\n    switch(e.detail.value.key) {\n      case 'add':\n        addCharacter();\n        break;\n\n      case 'delete':\n        this.openDeleteModal();\n        break;\n\n      case 'download':\n        this.downloadCharacter();\n        break;\n\n      case 'download-all':\n        this.downloadCharacters();\n        break;\n\n      case 'upload':\n        this.$.fileSelector.click();\n        break;\n\n      case 'clone':\n        cloneCharacter();\n        break;\n    }\n  }\n\n  createMenuItem(iconName, text, isChild = false) {\n    const item = document.createElement('vaadin-context-menu-item');\n    const icon = document.createElement('dnd-icon');\n\n    if (isChild) {\n      icon.style.width = 'var(--lumo-icon-size-s)';\n      icon.style.height = 'var(--lumo-icon-size-s)';\n      icon.style.marginRight = 'var(--lumo-space-s)';\n    }\n\n    icon.setAttribute('icon', iconName);\n    item.appendChild(icon);\n    if (text) {\n      item.appendChild(document.createTextNode(text));\n    }\n    return item;\n  }\n\n  removeCharacter() {\n    removeSelectedCharacter();\n    this.deleteModalOpen = false;\n  }\n  \n  openDeleteModal() {\n    this.deleteModalOpen = true;\n  }\n\n  closeDeleteModal() {\n    this.deleteModalOpen = false;\n  }\n\n  downloadCharacter(e) {\n    const char = getSelectedCharacter();\n    saveAs(new Blob([JSON.stringify(char, null, 2)], {type: \"application/json;charset=utf-8\"}), `${char.name} - ${new Date().toLocaleString()}`);\n  }\n  \n  downloadCharacters() {\n    const chars = getCharacters();\n    saveAs(new Blob([JSON.stringify(chars, null, 2)], {type: \"application/json;charset=utf-8\"}), `Character Export - ${new Date().toLocaleString()}`);\n  }\n\n  processUpload(event) {\n    const fileList = event.target.files;\n    console.log('upload', fileList);\n    const timestamp = new Date().toLocaleString();\n\n    for (let file of fileList) {\n      if (file && file.type === \"application/json\") {\n        const reader = new FileReader();\n        reader.addEventListener('load', (event) => {\n          const readFile = JSON.parse(event.target.result);\n          const readArray = Array.isArray(readFile) ? readFile : [readFile];\n\n          for (let readObject of readArray) {\n            readObject.name += ` ${timestamp}`;\n            uploadCharacter(readObject);\n          }\n        });\n        reader.readAsText(file);\n      }\n    }\n  }\n\n  toggleEditMode() {\n    dispatchEditModeChange(!this.isEditMode);\n  }\n\n  openDrawer() {\n    this.dispatchEvent(new CustomEvent(\"open-drawer\", { bubbles: true }));\n  }\n\n  _editIcon(isEditMode) {\n    return isEditMode ? 'check' : 'edit';\n  }\n\n  _editModeClass(isEditMode) {\n    return isEditMode ? 'edit-mode' : 'not-edit-mode';\n  }\n  \n  static get template() {\n    return html`\n      <style include=\"material-styles\"></style>\n      <style>\n        :host {\n          display: block;\n          --tab-bottom-margin: 270px;\n        }\n        .head-wrap {\n          display: flex;\n          flex-direction: column;\n        }\n\n        vaadin-text-field {\n          font-size: 24px;\n          margin: 0 8px 12px 0;\n          --vaadin-field-default-width: null;\n          flex-grow: 1;\n          max-width: 500px;\n        }\n        .char-input-wrap {\n          display: flex;\n          height: 50px;\n          margin-top: -10px;\n          /* z-index: 4; */\n        }\n        /* #nameWrapWatch.fixed {\n          height: 44px;\n          margin-top: -10px;\n        }\n        .char-input-wrap.fixed {\n          position: fixed;\n          top: 0;\n          background-color: var(--mdc-theme-header, #fff);\n          margin-top: 5px;\n          margin-right: 16px;\n        } */\n        .char-detail {\n          font-size: 16px;\n          line-height: 1.5;\n          display: flex;\n          flex-direction: column;\n        }\n        .char-detail__class {\n          font-size: 18px;\n        }\n        .char-detail__race-background {\n          font-size: 14px;\n          font-style: italic;\n          margin-bottom: 4px;\n        }\n\n        .roll-container {\n          position: relative;\n        }\n        .roll-result {\n          animation-name: fadeOutUp;\n          animation-duration: 4s;\n          animation-timing-function: ease-in;\n          position: absolute;\n          top: -80px;\n          width: calc(100vw - 50px);\n          right: 0;\n          font-weight: bold;\n          font-size: 20px;\n          color: var(--mdc-theme-secondary);\n          z-index: 1000;\n        }\n\n        @media(min-width: 921px) {\n          .roll-result {\n            top: calc(var(--vh, 1vh) * 100 - 300px);\n            right: 50px;\n          }\n        }\n\n        @keyframes fadeOutUp {\n          0% {\n            opacity: 1;\n            transform: translateY(0);\n          }\n          50% {\n            opacity: 1;\n          }\n          100% {\n            opacity: 0;\n            transform: translateY(calc(var(--vh, 1vh) * -20));\n          }\n        }\n\n        .thumb-menu {\n          position: fixed;\n          bottom: 24px;\n          right: 10px;\n          z-index: 2;\n          display: flex;\n          flex-direction: column-reverse;\n          margin-right: auto;\n          align-items: center;\n        }\n        .thumb-menu__btn {\n          border-radius: 50%;\n          z-index: 2;\n        }\n        .edit-button {\n          width: 70px;\n          height: 70px;\n          font-size: 30px;\n        }\n        .drawer-btn {\n          margin-bottom: 12px;\n        }\n\n        .tab-wrap {\n          background-color: var(--mdc-theme-surface);\n          border: 1px solid var(--mdc-theme-text-divider-on-background);\n          display: flex;\n          flex-direction: column;\n        }\n        #tabTarget {\n          flex-grow: 1;\n        }\n        #fileSelector {\n          display: none;\n        }\n\n        vaadin-menu-bar {\n          margin: 4px 0;\n        }\n\n        [pulse] {\n          box-shadow: var(--pulse-shadow);\n          animation: pulse 2s infinite;\n        }\n        @keyframes pulse {\n          0% {\n            transform: scale(0.95);\n            box-shadow: var(--pulse-shadow-0);\n          }\n          \n          70% {\n            transform: scale(1);\n            box-shadow: var(--pulse-shadow-70);\n          }\n          \n          100% {\n            transform: scale(0.95);\n            box-shadow: var(--pulse-shadow-100);\n          }\n        }\n\n        @media(max-width: 419px) {\n          .thumb-menu {\n            bottom: 75px;\n          }\n          #tabs.fixed {\n            position: fixed;\n            top: 56px;\n            z-index: 2;\n            box-shadow: 0px 0px 20px -5px var(--mdc-theme-text-primary-on-background);\n            border-bottom: 1px solid var(--mdc-theme-text-divider-on-background);\n          }\n          #tabs.fixed + .tab-wrap {\n            margin-top: 64px;\n          }\n          #tabs.fixed--bottom {\n            position: fixed;\n            bottom: 0;\n            z-index: 2;\n            box-shadow: 0px 0px 30px -10px var(--mdc-theme-text-primary-on-background);\n            height: 64px\n          }\n          #tabs.fixed--bottom + .tab-wrap {\n            margin-bottom: 94px;\n          }\n          .character-builder--tabs-wrapper {\n            margin: 0 -16px -90px;\n          }\n          .tab-wrap {\n            min-height: calc(var(--vh, 1vh) * 100 - 250px);\n          }\n\n          vaadin-menu-bar {\n            margin-right: -12px;\n          }\n        }\n\n        @media(min-width: 921px) {\n          .thumb-menu__btn {\n            margin-left: auto;\n            position: relative;\n            top: -10px;\n          }\n          .drawer-btn {\n            display: none;\n          }\n          .edit-button {\n            height: 80px;\n            width: 80px;\n            font-size: 36px;\n          }\n        }\n      </style>\n\n      <div class$=\"[[_editModeClass(isEditMode)]]\">\n        <div class=\"head-wrap\">\n          <div id=\"nameWrap\" class=\"char-input-wrap\">\n            <vaadin-text-field id=\"name\" class=\"name\" value=\"{{characterName}}\" disabled$=\"[[!isEditMode]]\"></vaadin-text-field>\n            <dnd-character-select mini></dnd-character-select>\n          </div>\n          <div id=\"nameWrapWatch\"></div>\n          <div class=\"char-detail\">\n            <span class=\"char-detail__class\">[[classLevel]]</span>\n            <span class=\"char-detail__race-background\">[[race]], [[background]]</span>\n          </div>\n        </div>\n\n        <div class=\"thumb-menu\">\n          <button class=\"edit-button thumb-menu__btn mdc-icon-button mdc-button--raised material-icons\" pulse$=\"[[pulse]]\" on-click=\"toggleEditMode\">[[_editIcon(isEditMode)]]</button>\n          <button class=\"drawer-btn thumb-menu__btn mdc-icon-button mdc-button--raised material-icons\" on-click=\"openDrawer\">logout</button>\n          <dnd-roll-results></dnd-roll-results>\n          <dnd-roller></dnd-roller>\n        </div>\n\n        <vaadin-menu-bar theme=\"end-aligned\" items=\"[[menuItems]]\" on-item-selected=\"_menuItemSelected\"></vaadin-menu-bar>\n\n        <input type=\"file\" id=\"fileSelector\" accept=\"application/JSON\" on-change=\"processUpload\" />\n\n        <div class=\"character-builder--tabs-wrapper\">\n          <dnd-tabs id=\"tabs\" class='fixed--bottom' theme=\"large\" tabs=\"[[tabs]]\" initial-selected-index=\"[[initialSelectedTab]]\"></dnd-tabs>\n\n          <div class=\"tab-wrap\" id=\"tabWrap\">\n            <div id=\"tabTarget\" hidden$=\"[[loading]]\"></div>\n            <dnd-spinner loading$=\"[[loading]]\"></dnd-spinner>\n          </div>\n        </div>\n\n        <vaadin-dialog opened=\"{{deleteModalOpen}}\">\n          <template>\n            <style>\n              .modal-content {\n                display: flex;\n                justify-content: center;\n              }\n              .modal-footer {\n                display: flex;\n                justify-content: space-between;\n                margin-top: 20px;\n              }\n              .modal-footer dnd-button:first-child {\n                margin-right: 40px;\n                --mdc-theme-primary: var(--mdc-theme-error);\n              }\n            </style>\n            <div class=\"modal-content\">Delete this character?</div>\n            <div class=\"modal-footer\">\n              <dnd-button label=\"Delete\" border on-click=\"removeCharacter\"></dnd-button>\n              <dnd-button label=\"Cancel\" border on-click=\"closeDeleteModal\"></dnd-button>\n            </div>\n          </template>\n        </vaadin-dialog>\n      </div>\n    `;\n  }\n}\ncustomElements.define('dnd-character-builder-view', DndCharacterBuilderView);\n","import { PolymerElement, html } from '@polymer/polymer';\n\nclass DndIcon extends PolymerElement {\n  static get properties() {\n    return {\n      icon: {\n        type: String,\n        value: ''\n      },\n      faType: {\n        type: String,\n        value: ''\n      }\n    }\n  }\n\n  _classString(icon, faType) {\n    return `${faType || 'fa'} fa-${icon}`;\n  }\n\n  static get template() {\n    return html`\n      <style include=\"fa-styles\"></style>\n      <i class$=\"[[_classString(icon, faType)]]\"></i>\n    `;\n  }\n\n}\ncustomElements.define('dnd-icon', DndIcon);\n","var map = {\n\t\"./dnd-character-builder-abilities\": [\n\t\t175,\n\t\t4\n\t],\n\t\"./dnd-character-builder-abilities.js\": [\n\t\t175,\n\t\t4\n\t],\n\t\"./dnd-character-builder-attributes\": [\n\t\t176,\n\t\t6\n\t],\n\t\"./dnd-character-builder-attributes.js\": [\n\t\t176,\n\t\t6\n\t],\n\t\"./dnd-character-builder-background-race\": [\n\t\t177,\n\t\t0,\n\t\t8\n\t],\n\t\"./dnd-character-builder-background-race.js\": [\n\t\t177,\n\t\t0,\n\t\t8\n\t],\n\t\"./dnd-character-builder-class\": [\n\t\t182,\n\t\t0,\n\t\t9\n\t],\n\t\"./dnd-character-builder-class.js\": [\n\t\t182,\n\t\t0,\n\t\t9\n\t],\n\t\"./dnd-character-builder-equipment\": [\n\t\t179,\n\t\t2,\n\t\t1,\n\t\t7\n\t],\n\t\"./dnd-character-builder-equipment-item-detail\": [\n\t\t172,\n\t\t2,\n\t\t1\n\t],\n\t\"./dnd-character-builder-equipment-item-detail.js\": [\n\t\t172,\n\t\t2,\n\t\t1\n\t],\n\t\"./dnd-character-builder-equipment.js\": [\n\t\t179,\n\t\t2,\n\t\t1,\n\t\t7\n\t],\n\t\"./dnd-character-builder-rolls\": [\n\t\t180,\n\t\t3\n\t],\n\t\"./dnd-character-builder-rolls.js\": [\n\t\t180,\n\t\t3\n\t],\n\t\"./dnd-character-builder-spells\": [\n\t\t181,\n\t\t5,\n\t\t10\n\t],\n\t\"./dnd-character-builder-spells.js\": [\n\t\t181,\n\t\t5,\n\t\t10\n\t],\n\t\"./dnd-character-builder-suboptions\": [\n\t\t171,\n\t\t0\n\t],\n\t\"./dnd-character-builder-suboptions.js\": [\n\t\t171,\n\t\t0\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn Promise.all(ids.slice(1).map(__webpack_require__.e)).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 185;\nmodule.exports = webpackAsyncContext;"],"sourceRoot":""}