{"version":3,"sources":["webpack:///./components/dnd-select-add.js","webpack:///./node_modules/@vaadin/vaadin-text-field/theme/lumo/vaadin-number-field-styles.js","webpack:///./node_modules/@vaadin/vaadin-text-field/src/vaadin-number-field.js","webpack:///./node_modules/@vaadin/vaadin-text-field/src/vaadin-integer-field.js","webpack:///./components/dnd-asi-select.js","webpack:///./data/choices.js","webpack:///./components/views/character/dnd-character-builder-class.js"],"names":["DndSelectAdd","test","type","Boolean","reflectToAttribute","value","options","Array","observer","model","String","addCallback","Function","choices","Number","paren","label","placeholder","multiValue","disabled","this","listBox","remove","$","select","render","isArray","choiceArray","map","v","indexOf","findIndex","o","name","source","filter","selectedValues","i","join","super","ready","setTimeout","async","renderer","root","document","createElement","setAttribute","addEventListener","e","opened","wasPreviouslySelected","srcElement","getAttribute","length","splice","selectedOptions","option","item","optionName","innerHTML","appendChild","_assignMenuElement","valueUpdated","connectedCallback","selectChangeHandler","val","selected","undefined","disconnectedCallback","removeEventListener","a","result","customElements","define","$_documentContainer","head","content","memoizedTemplate","hasControls","min","max","step","__previousValidInput","inputElement","__onInputChange","bind","preventDefault","_decreaseValue","_increaseValue","template","cloneNode","thisTemplate","import","is","decreaseButton","querySelector","increaseButton","styles","inputField","prefixSlot","insertBefore","_createMethodObserver","required","minlength","maxlength","pattern","invalid","isNumUnset","n","_constraintsChanged","validate","_incrementValue","incr","readonly","parseFloat","_getIncrement","newValue","_incrementIsInsideTheLimits","_setValue","dispatchEvent","CustomEvent","bubbles","currentValue","multiplier","Math","_getMultiplier","margin","round","number","s","isNaN","pow","_getDecimalCount","sign","__validateByStep","__stepChangedCalled","newVal","oldVal","_valueChanged","keyCode","_onKeyDown","checkValidity","window","preventInvalidInput","_enabledCharPattern","__isInteger","console","warn","__hasOnlyDigits","_stepChanged","levelIndex","checked","selectedFeat","Object","selectedAbility1","selectedAbility2","featHasAttributeChoice","featAttributeSelection","featAttributeOptions","attributeOptions","switchChangeHandler","detail","_genASICallback","characterChangeHandler","character","updateFromCharacter","asi","index","feat","ability1","ability2","isFeat","featId","featRef","ability","choose","from","toUpperCase","featAttributeSelections","asiIndex","keyForChange","linkData","push","dataLink","composed","selectedItem","viewId","classOptionsMap","class","2","count","5","10","15","20","4","7","11","19","artificer","6","14","18","barbarian","subclasses","3","bard","fighter","1","paladin","ranger","sorcerer","17","warlock","9","12","levels","classes","noContentMessage","isEditMode","editModeHandler","classGrid","notifyResize","grid","draggedItem","rowDetailsRenderer","rowData","renderStack","features","_getClassLevelFeatures","firstElementChild","feature","recursiveEntryRender","deets","draggedItems","dropMode","dropTargetItem","items","dropIndex","dropLocation","JSON","parse","stringify","classLevel","classChoices","_findLevelChoices","hitDiceMaxes","clearCache","className","classRef","classFeatures","levelsInClass","levelsInSubclass","classFeaturesForLevel","find","gainSubclassFeature","some","subclassDef","subclassFeatures","isSubclass","concat","classLevelFeatures","f","__data","data","stayClosed","detailsOpenedItems","closeItemDetails","openItemDetails","levelChoices","_findChoices","classDef","classLevelCount","subclassChoiceLevel","id","selections","classSkillOptions","startingProficiencies","skills","classSkillProficiencies","classOptions","toLowerCase","classLevelOptions","classLevelOption","level","subclassLevelOptions","subclassLevelOption","subclass","b","classs","choice","adjChoice","c","innerWidth","obj","values","replace","element","target","closest","isOpen","classList","contains","intField","parseInt","dataset","changeVal","toggle","add","focus","maxes"],"mappings":"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","file":"6.bundle.js","sourcesContent":["import { PolymerElement, html } from '@polymer/polymer';\nimport { mergeFeature } from '../util/charBuilder';\nimport { jqEmpty, util_capitalizeAll } from \"../js/utils\";\nimport \"@vaadin/vaadin-select\";\nimport {loadModel} from \"../util/data\";\n\nclass DndSelectAdd extends PolymerElement {\n  static get properties() {\n    return {\n      test: {\n        type: Boolean,\n        reflectToAttribute: true,\n        value: false\n      },\n      options: {\n        type: Array,\n        observer: \"optionsUpdated\"\n      },\n      model: {\n        type: String\n      },\n      addCallback: {\n        type: Function\n      },\n      value: {\n        type: String,\n        value: \"\",\n        observer: \"valueUpdated\"\n      },\n      choices: {\n        type: Number,\n        observer: \"choicesUpdated\"\n      },\n      paren: {\n        type: String,\n      },\n      label: {\n        type: String\n      },\n      placeholder: {\n        type: String,\n      },\n      multiValue: {\n        type: String,\n        value: \"\"\n      },\n      disabled: {\n        type: Boolean,\n        value: false,\n        reflectToAttribute: true\n      }\n    }\n  }\n\n  choicesUpdated() {\n    if (this.listBox) {\n      this.listBox.remove();\n      delete this.listBox;\n    }\n    this.$.select.render();\n  }\n\n  optionsUpdated() {\n    if (this.listBox) {\n      this.listBox.remove();\n      delete this.listBox;\n    }\n    this.$.select.render();\n  }\n\n  valueUpdated() {\n    if (this.choices) {\n      if (Array.isArray(this.value) && this.options) {\n        const choiceArray = this.value\n          .map(v => {\n            if (this.options.indexOf(v) !== -1) {\n              return this.options.indexOf(v);\n            } else {\n              return this.options.findIndex((o) => {\n                return o.name === v.name && o.source === v.source;\n              });\n            }\n          })\n          .filter(v => { return v !== -1 });\n\n        if (this.listBox) {\n          this.listBox.selectedValues = choiceArray;\n        }\n        this.multiValue = choiceArray.map(i => {\n          let value = this.options[i];\n          return value.name ? value.name : util_capitalizeAll(value) \n        }).join(\", \");\n      } else {\n        if (this.listBox) {\n          this.listBox.selectedValues = [];\n        }\n        this.multiValue = \"\";\n      }\n    } else {\n      if (this.value && this.options) {\n        if (this.value.source) {\n          this.$.select.value = this.options.findIndex(i => { return i.name === this.value.name && i.source === this.value.source || i === this.value.name }) + \"\";\n        } else if (this.value.name) {\n          this.$.select.value = this.options.findIndex(i => { return i.name === this.value.name || i === this.value.name }) + \"\";\n        } else {\n          this.$.select.value = this.options.findIndex(i => { return i.name === this.value || i === this.value }) + \"\";\n        }\n      } else {\n        this.$.select.value = \"\";\n      }\n    }\n  }\n\n  ready() {\n    super.ready();\n\n    setTimeout(async () => {\n      if (this.model) {\n        this.options = await loadModel(this.model);\n      }\n\n      this.$.select.renderer = (root, select) => {\n        if (!this.listBox) {\n          this.listBox = document.createElement('vaadin-list-box');\n\n          // setting up for multi-select\n          if (this.choices) {\n            this.listBox.setAttribute(\"multiple\", true);\n\n            this.listBox.addEventListener(\"click\", (e) => {\n              select.opened = true;\n              let wasPreviouslySelected = e.srcElement.getAttribute(\"selected\") !== null\n              setTimeout(() => {\n                if (this.listBox.selectedValues.length > this.choices\n                    && !wasPreviouslySelected) {\n                  this.listBox.selectedValues.splice(this.listBox.selectedValues.length - 2, 1)\n                }\n                let selectedOptions = this.listBox.selectedValues.map(v => { return this.options[v] });\n                this.multiValue = selectedOptions.map(o => { return o.name ? o.name : util_capitalizeAll(o) }).join(', ');\n                if (this.addCallback) {\n                  this.addCallback(selectedOptions);\n                }\n              }, 0);\n            });\n\n          }\n\n          // Adding options\n          if (this.options && this.options.length) {\n            for (let i = 0; i < this.options.length; i ++) {\n              const option = this.options[i],\n                item = document.createElement('vaadin-item');\n              const optionName = option.name || util_capitalizeAll(option);\n              item.innerHTML = `<span>${optionName}</span> ${option.name ? `<span style='font-size: 14px;color: var(--lumo-primary-color-50pct);'>${option.source}</span>` : ''}`\n              item.setAttribute(\"value\", i);\n              this.listBox.appendChild(item);\n            }\n          }\n          root.appendChild(this.listBox);\n          this.$.select._assignMenuElement();\n\n          this.valueUpdated();\n        }\n      };\n    }, 0);\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n\n    this.selectChangeHandler = () => {\n      const val = this.$.select.value;\n      if (val) {\n        if (!this.choices) {\n          const selected = this.options[val];\n          if (this.addCallback) {\n            this.addCallback(selected, this.model);\n          } else {\n            mergeFeature(undefined, selected, this.model);\n          }\n          if (!this.value) {\n            this.$.select.value = \"\";\n          }\n        }\n      }\n    };\n\n    this.$.select.addEventListener(\"change\", this.selectChangeHandler);\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n\n    this.$.select.removeEventListener(\"change\", this.selectChangeHandler);\n  }\n\n  _exists(a) {\n    return !!a;\n  }\n\n  _label(label, choices, paren) {\n    let result = '';\n    if (label) {\n      result = label;\n      if (choices && choices !== 1 && choices !== 100) {\n        result += ` (pick ${choices})`;\n      }\n      if (paren) {\n        result += ` (${paren})`;\n      }\n    }\n    return result;\n  }\n  \n  static get template() {\n    return html`\n      <style>\n        :host {\n          display: inline-block;\n        }\n        [slot=\"prefix\"] {\n          width: calc(100% - 46px);\n          padding: 12px;\n          line-height: 1.4;\n        }\n        vaadin-select {\n          width: 100%;\n        }\n        .prefix {\n          white-space: normal;\n          color: var(--lumo-body-text-color);\n        }\n      </style>\n      <vaadin-select test$=\"[[test]]\" theme=\"dark\" add id=\"select\" label=\"[[_label(label, choices, paren)]]\" placeholder=\"[[placeholder]]\" disabled$=\"[[disabled]]\">\n        <div hidden$=\"[[!_exists(multiValue)]]\" slot=\"prefix\">\n          <span class=\"prefix\">[[multiValue]]</span>\n        </div>\n      </vaadin-select>\n      \n    `;\n  }\n}\ncustomElements.define('dnd-select-add', DndSelectAdd);","import '@vaadin/vaadin-lumo-styles/font-icons.js';\nimport '@vaadin/vaadin-lumo-styles/sizing.js';\nimport '@vaadin/vaadin-lumo-styles/mixins/field-button.js';\nimport { html } from '@polymer/polymer/lib/utils/html-tag.js';\n\nconst $_documentContainer = html`<dom-module id=\"lumo-number-field\" theme-for=\"vaadin-number-field\">\n  <template>\n    <style include=\"lumo-field-button\">\n      :host {\n        width: 8em;\n      }\n\n      :host([has-controls]:not([theme~=\"align-right\"])) [part=\"value\"] {\n        text-align: center;\n      }\n\n      [part=\"decrease-button\"][disabled],\n      [part=\"increase-button\"][disabled] {\n        opacity: 0.2;\n      }\n\n      :host([has-controls]) [part=\"input-field\"] {\n        padding: 0;\n      }\n\n      [part=\"decrease-button\"],\n      [part=\"increase-button\"] {\n        cursor: pointer;\n        font-size: var(--lumo-icon-size-s);\n        width: 1.6em;\n        height: 1.6em;\n      }\n\n      [part=\"decrease-button\"]::before,\n      [part=\"increase-button\"]::before {\n        margin-top: 0.2em;\n      }\n\n      /* RTL specific styles */\n\n      :host([dir=\"rtl\"]) [part=\"value\"],\n      :host([dir=\"rtl\"]) [part=\"input-field\"] ::slotted(input) {\n        --_lumo-text-field-overflow-mask-image: linear-gradient(to left, transparent, #000 1.25em);\n      }\n    </style>\n  </template>\n</dom-module>`;\n\ndocument.head.appendChild($_documentContainer.content);\n","/**\n@license\nCopyright (c) 2017 Vaadin Ltd.\nThis program is available under Apache License Version 2.0, available at https://vaadin.com/license/\n*/\nimport '@polymer/polymer/polymer-element.js';\n\nimport '@polymer/polymer/lib/elements/custom-style.js';\nimport { TextFieldElement } from './vaadin-text-field.js';\nimport { DomModule } from '@polymer/polymer/lib/elements/dom-module.js';\nconst $_documentContainer = document.createElement('template');\n\n$_documentContainer.innerHTML = `<dom-module id=\"vaadin-number-field-template\">\n  <template>\n    <style>\n      :host([readonly]) [part\\$=\"button\"] {\n        pointer-events: none;\n      }\n\n      [part=\"decrease-button\"]::before {\n        content: \"−\";\n      }\n\n      [part=\"increase-button\"]::before {\n        content: \"+\";\n      }\n\n      [part=\"decrease-button\"],\n      [part=\"increase-button\"] {\n        -webkit-user-select: none;\n        -moz-user-select: none;\n        -ms-user-select: none;\n        user-select: none;\n      }\n\n      /* Hide the native arrow icons */\n      [part=\"value\"]::-webkit-outer-spin-button,\n      [part=\"value\"]::-webkit-inner-spin-button {\n        -webkit-appearance: none;\n        margin: 0;\n      }\n\n      [part=\"value\"] {\n        /* Older Firefox versions (v47.0) requires !important */\n        -moz-appearance: textfield !important;\n      }\n\n      :host([dir=\"rtl\"]) [part=\"input-field\"] {\n        direction: ltr;\n      }\n\n      :host([dir=\"rtl\"]) [part=\"value\"]::placeholder {\n        direction: rtl;\n      }\n\n      :host([dir=\"rtl\"]) [part=\"input-field\"] ::slotted(input)::placeholder {\n        direction: rtl;\n      }\n\n      :host([dir=\"rtl\"]) [part=\"value\"]:-ms-input-placeholder,\n      :host([dir=\"rtl\"]) [part=\"input-field\"] ::slotted(input):-ms-input-placeholder {\n        direction: rtl;\n      }\n\n      :host([dir=\"rtl\"]:not([has-controls])) [part=\"value\"]::placeholder {\n        text-align: left;\n      }\n\n      :host([dir=\"rtl\"]:not([has-controls])) [part=\"input-field\"] ::slotted(input)::placeholder {\n        text-align: left;\n      }\n\n      :host([dir=\"rtl\"]:not([has-controls])) [part=\"value\"]:-ms-input-placeholder,\n      :host([dir=\"rtl\"]:not([has-controls])) [part=\"input-field\"] ::slotted(input):-ms-input-placeholder {\n        text-align: left;\n      }\n    </style>\n\n    <div disabled\\$=\"[[!_allowed(-1, value, min, max, step)]]\" part=\"decrease-button\" on-click=\"_decreaseValue\" on-touchend=\"_decreaseButtonTouchend\" hidden\\$=\"[[!hasControls]]\">\n    </div>\n\n    <div disabled\\$=\"[[!_allowed(1, value, min, max, step)]]\" part=\"increase-button\" on-click=\"_increaseValue\" on-touchend=\"_increaseButtonTouchend\" hidden\\$=\"[[!hasControls]]\">\n    </div>\n  </template>\n\n  \n</dom-module>`;\n\ndocument.head.appendChild($_documentContainer.content);\nlet memoizedTemplate;\n\n/**\n* `<vaadin-number-field>` is a Web Component for number field control in forms.\n*\n* ```html\n* <vaadin-number-field label=\"Number\">\n* </vaadin-number-field>\n* ```\n*\n* @extends PolymerElement\n* @demo demo/index.html\n*/\nclass NumberFieldElement extends TextFieldElement {\n  static get is() {\n    return 'vaadin-number-field';\n  }\n\n  static get version() {\n    return '2.6.2';\n  }\n\n  static get properties() {\n    return {\n      /**\n      * Set to true to display value increase/decrease controls.\n      */\n      hasControls: {\n        type: Boolean,\n        value: false,\n        reflectToAttribute: true\n      },\n\n      /**\n      * The minimum value of the field.\n      */\n      min: {\n        type: Number,\n        reflectToAttribute: true,\n        observer: '_minChanged'\n      },\n\n      /**\n       * The maximum value of the field.\n       */\n      max: {\n        type: Number,\n        reflectToAttribute: true,\n        observer: '_maxChanged'\n      },\n\n      /**\n       * Specifies the allowed number intervals of the field.\n       */\n      step: {\n        type: Number,\n        value: 1,\n        observer: '_stepChanged'\n      }\n\n    };\n  }\n\n  ready() {\n    super.ready();\n    this.__previousValidInput = this.value || '';\n    this.inputElement.type = 'number';\n    this.inputElement.addEventListener('change', this.__onInputChange.bind(this));\n  }\n\n  _decreaseButtonTouchend(e) {\n    // Cancel the following click and focus events\n    e.preventDefault();\n    this._decreaseValue();\n  }\n\n  _increaseButtonTouchend(e) {\n    // Cancel the following click and focus events\n    e.preventDefault();\n    this._increaseValue();\n  }\n\n  static get template() {\n    if (!memoizedTemplate) {\n      // Clone the superclass template\n      memoizedTemplate = super.template.cloneNode(true);\n\n      // Retrieve this element's dom-module template\n      const thisTemplate = DomModule.import(this.is + '-template', 'template');\n      const decreaseButton = thisTemplate.content.querySelector('[part=\"decrease-button\"]');\n      const increaseButton = thisTemplate.content.querySelector('[part=\"increase-button\"]');\n      const styles = thisTemplate.content.querySelector('style');\n\n      // Add the buttons and styles to the text-field template\n      const inputField = memoizedTemplate.content.querySelector('[part=\"input-field\"]');\n      const prefixSlot = memoizedTemplate.content.querySelector('[name=\"prefix\"]');\n      inputField.insertBefore(decreaseButton, prefixSlot);\n      inputField.appendChild(increaseButton);\n      memoizedTemplate.content.appendChild(styles);\n    }\n\n    return memoizedTemplate;\n  }\n\n  _createConstraintsObserver() {\n    // NOTE: do not call \"super\" but instead override the method to add extra arguments\n    this._createMethodObserver('_constraintsChanged(required, minlength, maxlength, pattern, min, max, step)');\n  }\n\n  _constraintsChanged(required, minlength, maxlength, pattern, min, max, step) {\n    if (!this.invalid) {\n      return;\n    }\n\n    const isNumUnset = n => (!n && n !== 0);\n\n    if (!isNumUnset(min) || !isNumUnset(max)) {\n      this.validate();\n    } else {\n      super._constraintsChanged(required, minlength, maxlength, pattern);\n    }\n  }\n\n  _decreaseValue() {\n    this._incrementValue(-1);\n  }\n\n  _increaseValue() {\n    this._incrementValue(1);\n  }\n\n  _incrementValue(incr) {\n    if (this.disabled || this.readonly) {\n      return;\n    }\n\n    let value = parseFloat(this.value);\n\n    if (!this.value) {\n      if (this.min == 0 && incr < 0 ||\n          this.max == 0 && incr > 0 ||\n          this.max == 0 && this.min == 0) {\n        incr = 0;\n        value = 0;\n      } else if ((this.max == null || this.max >= 0) &&\n                 (this.min == null || this.min <= 0)) {\n        value = 0;\n      } else if (this.min > 0) {\n        value = this.min;\n        if (this.max < 0 && incr < 0) {\n          value = this.max;\n        }\n        incr = 0;\n      } else if (this.max < 0) {\n        value = this.max;\n        if (incr < 0) {\n          incr = 0;\n        } else {\n          // FIXME(yuriy): find a proper solution to make correct step back\n          if (this._getIncrement(1, value - this.step) > this.max) {\n            value -= 2 * this.step;\n          } else {\n            value -= this.step;\n          }\n        }\n      }\n    } else if (value < this.min) {\n      incr = 0;\n      value = this.min;\n    } else if (value > this.max) {\n      incr = 0;\n      value = this.max;\n    }\n\n    const newValue = this._getIncrement(incr, value);\n    if (!this.value || incr == 0 || this._incrementIsInsideTheLimits(incr, value)) {\n      this._setValue(newValue);\n    }\n  }\n\n  _setValue(value) {\n    this.value = this.inputElement.value = String(parseFloat(value));\n    this.dispatchEvent(new CustomEvent('change', {bubbles: true}));\n  }\n\n  _getIncrement(incr, currentValue) {\n    let step = this.step || 1,\n      min = this.min || 0;\n\n    // To avoid problems with decimal math, multiplying to operate with integers.\n    const multiplier = Math.max(this._getMultiplier(currentValue),\n      this._getMultiplier(step),\n      this._getMultiplier(min));\n\n    step *= multiplier;\n    currentValue = Math.round(currentValue * multiplier);\n    min *= multiplier;\n\n    const margin = (currentValue - min) % step;\n\n    if (incr > 0) {\n      return (currentValue - margin + step) / multiplier;\n    } else if (incr < 0) {\n      return (currentValue - (margin || step)) / multiplier;\n    } else {\n      return currentValue / multiplier;\n    }\n  }\n\n  _getDecimalCount(number) {\n    const s = String(number);\n    const i = s.indexOf('.');\n    return i === -1 ? 1 : s.length - i - 1;\n  }\n\n  _getMultiplier(number) {\n    if (!isNaN(number)) {\n      return Math.pow(10, this._getDecimalCount(number));\n    }\n  }\n\n  _incrementIsInsideTheLimits(incr, value) {\n    if (incr < 0) {\n      return this.min == null || this._getIncrement(incr, value) >= this.min;\n    } else if (incr > 0) {\n      return this.max == null || this._getIncrement(incr, value) <= this.max;\n    } else {\n      return this._getIncrement(incr, value) <= this.max && this._getIncrement(incr, value) >= this.min;\n    }\n  }\n\n  _allowed(sign) {\n    const incr = sign * (this.step || 1);\n    const value = parseFloat(this.value);\n    return !this.value || (!this.disabled && this._incrementIsInsideTheLimits(incr, value));\n  }\n\n  _stepChanged(step) {\n    // Avoid using initial value in validation\n    this.__validateByStep = this.__stepChangedCalled || this.getAttribute('step') !== null;\n    this.inputElement.step = this.__validateByStep ? step : 'any';\n\n    this.__stepChangedCalled = true;\n    this.setAttribute('step', step);\n  }\n\n  _minChanged(min) {\n    this.inputElement.min = min;\n  }\n\n  _maxChanged(max) {\n    this.inputElement.max = max;\n  }\n\n  _valueChanged(newVal, oldVal) {\n    // Validate value to be numeric\n    if (newVal && isNaN(parseFloat(newVal))) {\n      this.value = '';\n    } else if (typeof this.value !== 'string') {\n      this.value = String(this.value);\n    }\n\n    super._valueChanged(this.value, oldVal);\n  }\n\n  _onKeyDown(e) {\n    if (e.keyCode == 38) {\n      e.preventDefault();\n      this._increaseValue();\n    } else if (e.keyCode == 40) {\n      e.preventDefault();\n      this._decreaseValue();\n    }\n    super._onKeyDown(e);\n  }\n\n  __onInputChange() {\n    this.validate();\n  }\n\n  checkValidity() {\n    // text-field mixin does not check against `min`, `max` and `step`\n    if (this.min !== undefined || this.max !== undefined || this.__validateByStep) {\n      return this.inputElement.checkValidity();\n    }\n\n    return super.checkValidity();\n  }\n}\n\nwindow.customElements.define(NumberFieldElement.is, NumberFieldElement);\n\nexport { NumberFieldElement };\n","/**\n@license\nCopyright (c) 2019 Vaadin Ltd.\nThis program is available under Apache License Version 2.0, available at https://vaadin.com/license/\n*/\nimport '@polymer/polymer/polymer-element.js';\n\nimport '@polymer/polymer/lib/elements/custom-style.js';\nimport { NumberFieldElement } from './vaadin-number-field.js';\nconst $_documentContainer = document.createElement('template');\n\n$_documentContainer.innerHTML = `<dom-module id=\"vaadin-integer-field-template\">\n\n  \n</dom-module>`;\n\ndocument.head.appendChild($_documentContainer.content);\n\n/**\n* `<vaadin-integer-field>` is a Web Component for integer field control in forms.\n*\n* ```html\n* <vaadin-integer-field label=\"Number\">\n* </vaadin-integer-field>\n* ```\n*\n* @extends PolymerElement\n* @demo demo/index.html\n*/\nclass IntegerFieldElement extends NumberFieldElement {\n  static get is() {\n    return 'vaadin-integer-field';\n  }\n\n  static get version() {\n    return '2.6.2';\n  }\n\n  static get properties() {\n    // Hide inherited props that don't work with <input type=\"number\"> from JSDoc.\n    return {\n      /**\n       * @private\n       */\n      pattern: String,\n      /**\n       * @private\n       */\n      preventInvalidInput: Boolean,\n      /**\n       * @private\n       */\n      minlength: Number,\n      /**\n       * @private\n       */\n      maxlength: Number\n    };\n  }\n\n  ready() {\n    super.ready();\n    this._enabledCharPattern = '[-+\\\\d]';\n  }\n\n  _valueChanged(newVal, oldVal) {\n    if (newVal !== '' && !this.__isInteger(newVal)) {\n      console.warn(`Trying to set non-integer value \"${newVal}\" to <vaadin-integer-field>.`\n        + ` Clearing the value.`);\n      this.value = '';\n      return;\n    }\n    super._valueChanged(newVal, oldVal);\n  }\n\n  _stepChanged(newVal, oldVal) {\n    if (!this.__hasOnlyDigits(newVal)) {\n      console.warn(`Trying to set invalid step size \"${newVal}\",`\n        + ` which is not a positive integer, to <vaadin-integer-field>.`\n        + ` Resetting the default value 1.`);\n      this.step = 1;\n      return;\n    }\n    super._stepChanged(newVal, oldVal);\n  }\n\n  __isInteger(value) {\n    return /^(-\\d)?\\d*$/.test(String(value));\n  }\n\n  __hasOnlyDigits(value) {\n    return /^\\d*$/.test(String(value));\n  }\n}\n\nwindow.customElements.define(IntegerFieldElement.is, IntegerFieldElement);\n\nexport { IntegerFieldElement };\n","import { PolymerElement, html } from \"@polymer/polymer\";\nimport { encodeForHash } from \"../js/utils\";\nimport { getSelectedCharacter, getASIForLevel, getCharacterChannel, setASI, getFeatReference, setFeatAttributeSelection } from \"../util/charBuilder\";\n\nclass DndAsiSelect extends PolymerElement {\n  \n  static get properties() {\n    return {\n      levelIndex: {\n        type: Number\n      },\n      checked: {\n        type: Boolean,\n        value: false\n      },\n      selectedFeat: {\n        type: Object\n      },\n      selectedAbility1: {\n        type: String,\n        value: ''\n      },\n      selectedAbility2: {\n        type: String,\n        value: ''\n      },\n      featHasAttributeChoice: {\n        type: Boolean,\n        value: false\n      },\n      featAttributeSelection: {\n        type: String,\n        value: ''\n      },\n      featAttributeOptions: {\n        type: Array,\n        value: []\n      },\n      disabled: {\n        type: Boolean,\n        value: false,\n        reflectToAttribute: true\n      }\n    };\n  }\n\n  constructor() {\n    super();\n    this.attributeOptions = [\n      \"STR\",\n      \"DEX\",\n      \"CON\",\n      \"INT\",\n      \"WIS\",\n      \"CHA\"\n    ]\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n\n    this.switchChangeHandler = (e) => {\n      this.checked = e.detail.checked;\n      this._genASICallback()();\n    }\n    this.addEventListener(\"switch-change\", this.switchChangeHandler);\n\n    this.characterChangeHandler = (e) => {\n      let character = e.detail.character;\n      this.updateFromCharacter(character);\n    };\n    \n    this.updateFromCharacter(getSelectedCharacter());\n    getCharacterChannel().addEventListener(\"character-selected\", this.characterChangeHandler);\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n\n    this.removeEventListener(\"switch-change\", this.switchChangeHandler);\n    getCharacterChannel().removeEventListener(\"character-selected\", this.characterChangeHandler);\n  }\n\n  async updateFromCharacter(character) {\n    const { asi, index } = await getASIForLevel(this.levelIndex, character);\n\n    this.featHasAttributeChoice = false;\n    if (asi) {\n      this.selectedFeat = asi.feat;\n      this.selectedAbility1 = asi.ability1;\n      this.selectedAbility2 = asi.ability2;\n      this.checked = asi.isFeat;\n\n      if (asi.isFeat && asi.feat && asi.feat.name && asi.feat.source) {\n        const featId = `${asi.feat.name}_${asi.feat.source}`;\n        const featRef = await getFeatReference(featId);\n\n        if (featRef.ability && featRef.ability.length && featRef.ability[0].choose) {\n          this.featHasAttributeChoice = true;\n          this.featAttributeOptions = featRef.ability[0].choose.from.map(i => { return i.toUpperCase() });\n          this.featAttributeSelection = character.featAttributeSelections && character.featAttributeSelections[featId] \n            ? character.featAttributeSelections[featId] : '';\n        }\n      }\n    } else {\n      this.selectedFeat = { name: '', source: '' };\n      this.selectedAbility1 = '';\n      this.selectedAbility2 = '';\n      this.checked = false;\n    }\n    this.asiIndex = index;\n  }\n\n  _genASICallback(keyForChange) {\n    return (newVal) => {\n      setASI({\n        feat: keyForChange === 'feat' ? { name: newVal.name, source: newVal.source } : this.selectedFeat,\n        ability1: keyForChange === 'ability1' ? newVal : this.selectedAbility1,\n        ability2: keyForChange === 'ability2' ? newVal : this.selectedAbility2,\n        isFeat: this.checked\n      }, this.asiIndex);\n    }\n  }\n\n  _genFeatAbilityCallback() {\n    return (newVal) => {\n      if (this.selectedFeat && this.selectedFeat.name && this.selectedFeat.source) {\n        const featId = `${this.selectedFeat.name}_${this.selectedFeat.source}`;\n        setFeatAttributeSelection(featId, newVal);\n      }\n    }\n  }\n\n  _disableLabel(checked) {\n    return checked ? 'Feat' : 'ASI';\n  }\n\n  _getFeatLink(feat) {\n    let linkData = [feat.name];\n    if (feat.source) {\n      linkData.push(feat.source);\n    }\n    let dataLink = encodeForHash(linkData);\n    return dataLink ? `#/feats/${dataLink}` : '#/feats';\n  }\n\n  _linkClick() {\n    this.dispatchEvent(new CustomEvent(\"open-drawer\", {\n      bubbles: true,\n      composed: true,\n      detail: {\n        selectedItem: this.selectedFeat,\n        viewId: 'feats'\n      }\n    }));\n  }\n\n  static get template() {\n    return html`\n      <style include=\"material-styles\">\n        :host {\n          display: flex;\n          flex-direction: column;\n          max-width: 192px;\n        }\n        [hidden] {\n          display: none !important;\n        }\n        .abilities {\n          display: flex;\n          flex-wrap: wrap;\n        }\n        .abilities dnd-select-add {\n          width: calc(50% - 8px);\n        }\n        dnd-select-add + dnd-select-add {\n          margin-left: 16px;\n        }\n        dnd-select-add {\n          display: block;\n        }\n        .disable-label {\n          font-size: 14px;\n          font-weight: 500;\n          color: var(--mdc-theme-primary);\n        }\n        .reference-link {\n          color: var(--lumo-body-text-color);\n        }\n        .reference-link:hover {\n          color: var(--mdc-theme-secondary);\n        }\n        .feat-pick-wrap {\n          display: flex;\n        }\n      </style>\n\n      <div class=\"disable-label\" hidden$=\"[[!disabled]]\">[[_disableLabel(checked)]]</div>\n      <dnd-switch initial-value=[[checked]] label=\"ASI\" secondary-label=\"Feat\" disabled$=\"[[disabled]]\" hidden$=\"[[disabled]]\"></dnd-switch>\n      <div class=\"abilities\" hidden$=[[checked]]>\n        <dnd-select-add add-callback=\"[[_genASICallback('ability1')]]\" value=\"[[selectedAbility1]]\" options=\"[[attributeOptions]]\" placeholder=\"<ASI>\" disabled$=\"[[disabled]]\"></dnd-select-add>\n        <dnd-select-add add-callback=\"[[_genASICallback('ability2')]]\" value=\"[[selectedAbility2]]\" options=\"[[attributeOptions]]\" placeholder=\"<ASI>\" disabled$=\"[[disabled]]\"></dnd-select-add>\n      </div>\n      <div class=\"feat-pick-wrap\" hidden$=[[!checked]]>\n        <dnd-select-add add-callback=\"[[_genASICallback('feat')]]\" model=\"feats\" value=\"[[selectedFeat.name]]\" placeholder=\"<Choose Feat>\" disabled$=\"[[disabled]]\"></dnd-select-add>\n        <button class=\"reference-link mdc-icon-button material-icons\" on-click=\"_linkClick\">logout</button>\n      </div>\n      <div hidden$=[[!featHasAttributeChoice]]>\n        <dnd-select-add test add-callback=\"[[_genFeatAbilityCallback()]]\" value=\"[[featAttributeSelection]]\" options=\"[[featAttributeOptions]]\" placeholder=\"<Choose Attribute>\" disabled$=\"[[disabled]]\"></dnd-select-add>\n      </div>\n    `;\n  }\n}\n\ncustomElements.define(\"dnd-asi-select\", DndAsiSelect);","export const classOptionsMap = {\n  \"artificer(ua)\": {\n    class: {\n      2: {\n        name: \"Wonderous Invention\",\n        count: 1,\n        options: [\"{@item Bag of holding}\", \"{@item cap of water breathing}\", \"{@item driftglobe}\", \"{@item goggles of night}\", \"{@item sending stones}\"]\n      },\n      5: {\n        name: \"Wonderous Invention\",\n        count: 1,\n        options: [\"{@item Alchemy jug}\", \"{@item helm of comprehending languages}\", \"{@item lantern of revealing}\", \"{@item ring of swimming}\", \"{@item robe of useful items}\", \"{@item rope of climbing}\", \"{@item wand of magic detection}\", \"{@item wand of secrets}\", \"{@item Bag of holding}\", \"{@item cap of water breathing}\", \"{@item driftglobe}\", \"{@item goggles of night}\", \"{@item sending stones}\"]\n      },\n      10: {\n        name: \"Wonderous Invention\",\n        count: 1,\n        options: [\"{@item Bag of beans}\", \"{@item chime of opening}\", \"{@item decanter of endless water}\", \"{@item eyes of minute seeing}\", \"{@item folding boat}\", \"{@item Heward's handy haversack}\", \"{@item Alchemy jug}\", \"{@item helm of comprehending languages}\", \"{@item lantern of revealing}\", \"{@item ring of swimming}\", \"{@item robe of useful items}\", \"{@item rope of climbing}\", \"{@item wand of magic detection}\", \"{@item wand of secrets}\", \"{@item Bag of holding}\", \"{@item cap of water breathing}\", \"{@item driftglobe}\", \"{@item goggles of night}\", \"{@item sending stones}\"]\n      },\n      15: {\n        name: \"Wonderous Invention\",\n        count: 1,\n        options: [\"{@item Boots of striding and springing}\", \"{@item bracers of archery}\", \"{@item brooch of shielding}\", \"{@item broom of flying}\", \"{@item hat of disguise}\", \"{@item slippers of spider climbing}\", \"{@item Bag of beans}\", \"{@item chime of opening}\", \"{@item decanter of endless water}\", \"{@item eyes of minute seeing}\", \"{@item folding boat}\", \"{@item Heward's handy haversack}\", \"{@item Alchemy jug}\", \"{@item helm of comprehending languages}\", \"{@item lantern of revealing}\", \"{@item ring of swimming}\", \"{@item robe of useful items}\", \"{@item rope of climbing}\", \"{@item wand of magic detection}\", \"{@item wand of secrets}\", \"{@item Bag of holding}\", \"{@item cap of water breathing}\", \"{@item driftglobe}\", \"{@item goggles of night}\", \"{@item sending stones}\"]\n      },\n      20: {\n        name: \"Wonderous Invention\",\n        count: 1,\n        options: [\"{@item Eyes of the eagle}\", \"{@item gem of brightness}\", \"{@item gloves of missile snaring}\", \"{@item gloves of swimming and climbing}\", \"{@item ring of jumping}\", \"{@item ring of mind shielding}\", \"{@item wings of flying}\", \"{@item Boots of striding and springing}\", \"{@item bracers of archery}\", \"{@item brooch of shielding}\", \"{@item broom of flying}\", \"{@item hat of disguise}\", \"{@item slippers of spider climbing}\", \"{@item Bag of beans}\", \"{@item chime of opening}\", \"{@item decanter of endless water}\", \"{@item eyes of minute seeing}\", \"{@item folding boat}\", \"{@item Heward's handy haversack}\", \"{@item Alchemy jug}\", \"{@item helm of comprehending languages}\", \"{@item lantern of revealing}\", \"{@item ring of swimming}\", \"{@item robe of useful items}\", \"{@item rope of climbing}\", \"{@item wand of magic detection}\", \"{@item wand of secrets}\", \"{@item Bag of holding}\", \"{@item cap of water breathing}\", \"{@item driftglobe}\", \"{@item goggles of night}\", \"{@item sending stones}\"]\n      }\n    }\n  },\n  \"artificer (revisited)\": {\n    class: {\n      2: {\n        name: \"Infuse Item\",\n        count: 3,\n        type: \"featureType=ai|source=UAArtificerRevisited\"\n      },\n      4: {\n        name: \"Infuse Item\",\n        count: 1,\n        type: \"featureType=ai|source=UAArtificerRevisited\"\n      },\n      7: {\n        name: \"Infuse Item\",\n        count: 1,\n        type: \"featureType=ai|source=UAArtificerRevisited\"\n      },\n      11: {\n        name: \"Infuse Item\",\n        count: 1,\n        type: \"featureType=ai|source=UAArtificerRevisited\"\n      },\n      15: {\n        name: \"Infuse Item\",\n        count: 1,\n        type: \"featureType=ai|source=UAArtificerRevisited\"\n      },\n      19: {\n        name: \"Infuse Item\",\n        count: 1,\n        type: \"featureType=ai|source=UAArtificerRevisited\"\n      }\n    }\n  },\n  artificer: {\n    class: {\n      2: {\n        name: \"Infuse Item\",\n        count: 4,\n        type: \"featureType=ai|source=TCE\"\n      },\n      6: {\n        name: \"Infuse Item\",\n        count: 2,\n        type: \"featureType=ai|source=TCE\"\n      },\n      10: {\n        name: \"Infuse Item\",\n        count: 2,\n        type: \"featureType=ai|source=TCE\"\n      },\n      14: {\n        name: \"Infuse Item\",\n        count: 2,\n        type: \"featureType=ai|source=TCE\"\n      },\n      18: {\n        name: \"Infuse Item\",\n        count: 2,\n        type: \"featureType=ai|source=TCE\"\n      }\n    }\n  },\n  barbarian: {\n    subclasses: {\n      \"Path of the Totem Warrior\": {\n        3: {\n          name: \"Totem Spirit\",\n          count: 1,\n          options: [\"Bear\", \"Eagle\", \"Elk\", \"Tiger\", \"Wolf\"]\n        },\n        6: {\n          name: \"Aspect of the Beast\",\n          count: 1,\n          options: [\"Bear\", \"Eagle\", \"Elk\", \"Tiger\", \"Wolf\"]\n        },\n        14: {\n          name: \"Totemic Attunement\",\n          count: 1,\n          options: [\"Bear\", \"Eagle\", \"Elk\", \"Tiger\", \"Wolf\"]\n        }\n      }\n    }\n  },\n  bard: {\n    subclasses: {\n      \"College of Swords\": {\n        3: {\n          name: \"Fighting Style\",\n          count: 1,\n          type: \"fs:b\"\n        }\n      }\n    }\n  },\n  fighter: {\n    class: {\n      1: {\n        name: \"Fighting Style\",\n        type: \"fs:f\",\n        count: 1\n      }\n    }\n  },\n  paladin: {\n    class: {\n      2: {\n        name: \"Fighting Style\",\n        type: \"fs:p\",\n        count: 1\n      },\n    }\n  },\n  ranger: {\n    class: {\n      2: {\n        name: \"Fighting Style\",\n        type: \"fs:r\",\n        count: 1\n      },\n    }\n  },\n  sorcerer: {\n    class: {\n      3: {\n        name: \"Metamagic\",\n        type: \"mm\",\n        count: 2\n      },\n      10: {\n        name: \"Metamagic\",\n        type: \"mm\",\n        count: 1\n      },\n      17: {\n        name: \"Metamagic\",\n        type: \"mm\",\n        count: 1\n      }\n    },\n    subclasses: {\n      \"Divine Soul\": {\n        1: [\n          {\n            name: \"Divine Magic Affinity\",\n            options: [\"Good (Cure Wounds)\", \"Evil (Inflict Wounds)\", \"Law (Bless)\", \"Chaos (Bane)\", \"Neutrality (Protection From Good and Evil\"],\n            count: 1\n          }\n        ]\n      }\n    }\n  },\n  warlock: {\n    class: {\n      2: {\n        name: \"Eldritch Invocations\",\n        type: \"ei\",\n        count: 2\n      },\n      3: {\n        name: \"Pact Boon\",\n        type: \"pb\",\n        count: 1\n      },\n      5: {\n        name: \"Eldritch Invocations\",\n        type: \"ei\",\n        count: 1\n      },\n      7: {\n        name: \"Eldritch Invocations\",\n        type: \"ei\",\n        count: 1\n      },\n      9: {\n        name: \"Eldritch Invocations\",\n        type: \"ei\",\n        count: 1\n      },\n      12: {\n        name: \"Eldritch Invocations\",\n        type: \"ei\",\n        count: 1\n      },\n      15: {\n        name: \"Eldritch Invocations\",\n        type: \"ei\",\n        count: 1\n      },\n      18: {\n        name: \"Eldritch Invocations\",\n        type: \"ei\",\n        count: 1\n      }\n    }\n  }\n};\n\nexport const proficiencyGains = {\n  classes: {\n    \"artificer(ua)\": {\n      subclasses: {\n        \"Gunsmith\": {\n          1: {\n            name: \"Master Smith\",\n            value: \"{@item smith's tools|phb}\"\n          }\n        }\n      }\n    },\n    \"Artificer (Revisited)\": {\n      subclasses: {\n        \"Alchemist\": {\n          3: {\n            name: \"Tools of the Trade\",\n            value: [\"{@item alchemist's supplies|phb}\", \"{@item herbalism kit|phb}\"]\n          }\n        },\n        \"Archivist\": {\n          3: {\n            name: \"Tools of the Trade\",\n            value: [\"{@item calligrapher's supplies|phb}\", \"{@item forgery kit|phb}\"]\n          }\n        },\n        \"Artillerist\": {\n          3: {\n            name: \"Tools of the Trade\",\n            value: [\"{@item smith's tools|phb}\", \"{@item woodcarver's tools|phb}\"]\n          }\n        },\n        \"Battle Smith\": {\n          3: [\n            {\n              name: \"Tools of the Trade\",\n              value: [\"{@item leatherworker's tools|phb}\", \"{@item smith's tools|phb}\"]\n            }, \n            {\n              name: \"Battle Ready\",\n              value: \"martial weapons\"\n            }\n          ]\n        }\n      }\n    },\n    artificer: {\n      subclasses: {\n        \"Alchemist\": {\n          3: {\n            name: \"Tool Proficiency\",\n            value: \"alchemist's supplies\",\n            orOther: true,\n            type: \"artisan's tools\"\n          }\n        },\n        \"Artillerist\": {\n          3: {\n            name: \"Tool Proficiency\",\n            value: \"woodcarver's supplies\"\n          }\n        },\n        \"Battle Smith\": {\n          3: [\n            {\n              name: \"Tool Proficiency\",\n              value: \"smith's supplies\"\n            },\n            {\n              name: \"Battle Ready\",\n              value: \"martial weapons\"\n            }\n          ]\n        },\n        \"Armorer (UA)\": {\n          3: {\n            name: \"Tricks of the Trade\",\n            value: [\"heavy armor\", \"smith's tools\"]\n          }\n        }\n      }\n    }\n  }\n};\n\nexport const spellGains = {\n  classes: {\n    \"artificer(ua)\": {\n      subclasses: {\n        \"Gunsmith\": {\n          1: {\n            name: \"\",\n            value: \"mending\"\n          }\n        }\n      }\n    },\n    \"Artificer (Revisited)\": {\n      subclasses: {\n        \"Alchemist\": {\n          14: {\n            name: \"Chemical Savant\",\n            value: \"greater restoration\",\n            noSlot: true,\n            noMaterial: true,\n            recharge: \"long rest\"\n          }\n        }\n      }\n    },\n    \"artificer\": {\n      subclasses: {\n        \"Alchemist\": {\n          14: {\n            name: \"Chemical Mastery\",\n            value: [\"greater restoration\", \"heal\"],\n            noSlot: true,\n            noMaterial: true,\n            recharge: \"long rest\"\n          }\n        }\n      }\n    },\n    barbarian: {\n      subclasses: {\n        \"Path of the Totem Warrior\": {\n          3: {\n            name: \"Spirit Seeker\",\n            value: [\"beast sense\", \"speak with animals\"],\n            ritualOnly: true,\n            noSlot: true\n          }\n        },\n        \"Path of the Ancestral Guardian v2 (UA)\": {\n          10: {\n            name: \"Consult the Spirits\",\n            value: \"clairvoyance\",\n            noSlot: true\n          }\n        },\n        \"Path of the Ancestral Guardian\": {\n          10: {\n            name: \"Consult the Spirits\",\n            value: [\"augury\", \"clairvoyance\"],\n            noSlot: true,\n            noMaterial: true,\n            recharge: \"short rest\"\n          }\n        },\n        \"Path of the Wild Soul (UA)\": {\n          3: {\n            name: \"Lingering Magic\",\n            value: \"detect magic\",\n            noSlot: true,\n            noMaterial: true,\n            recharge: \"long rest\",\n            charges: \"con\"\n          }\n        }\n      }\n    },\n    bard: {\n      subclasses: {\n        \"College of Lore\": {\n          6: {\n            name: \"\",\n            count: 2,\n            list: \"any\"\n          }\n        }\n      },\n      class: {\n        10: {\n          name: \"Magical Secrets\",\n          count: 2,\n          list: \"any\"\n        },\n        14: {\n          name: \"\",\n          count: 2,\n          list: \"any\"\n        },\n        18: {\n          name: \"\",\n          count: 2,\n          list: \"any\"\n        }\n      }\n    }\n  }\n};\n\nexport const expertiseClasses = {\n  \"artificer(ua)\": {\n    2: {\n      name: \"Tool Expertise\",\n      type: \"artificier-tools\"\n    }\n  },\n  \"Artificer (Revisited)\": {\n    3: {\n      name: \"Tool Expertise\",\n      type: \"artificier-tools\"\n    }\n  },\n  \"Artificer\": {\n    6: {\n      name: \"Tool Expertise\",\n      type: \"artificier-tools\"\n    }\n  },\n  bard: {\n    3: 2,\n    10: 2\n  }\n};\n\nexport const itemGains = {\n  \"Artificer (Revisited)\": {\n    subclasses: {\n      \"Alchemist\": {\n        3: {\n          name: \"Tools of the Trade\",\n          value: [\"{@item alchemist's supplies|phb}\", \"{@item herbalism kit|phb}\"]\n        }\n      },\n      \"Archivist\": {\n        3: {\n          name: \"Tools of the Trade\",\n          value: [\"{@item calligrapher's supplies|phb}\", \"{@item forgery kit|phb}\"]\n        }\n      },\n      \"Artillerist\": {\n        3: {\n          name: \"Tools of the Trade\",\n          value: [\"{@item smith's tools|phb}\", \"{@item woodcarver's tools|phb}\", \"a nonmagical, wooden wand\"]\n        }\n      },\n      \"Battle Smith\": {\n        3: {\n          name: \"Tools of the Trade\",\n          value: [\"{@item leatherworker's tools|phb}\", \"{@item smith's tools|phb}\"]\n        }\n      }\n    }\n  }\n};\n\nexport const resistanceGains = {\n  class: {\n    \"Artificer (Revisited)\": {\n      subclasses: {\n        \"Alchemist\": {\n          14: [\n            {\n              name: \"Chemical Savant\",\n              level: \"resistance\",\n              type: \"damage\",\n              value: \"acid\"\n            },\n            {\n              name: \"Chemical Savant\",\n              level: \"resistance\",\n              type: \"damage\",\n              value: \"poison\"\n            },\n            {\n              name: \"Chemical Savant\",\n              level: \"immunity\",\n              type: \"condition\",\n              value: \"poisoned\"\n            }\n          ]\n        }\n      }\n    }\n  },\n  artificer: {\n    subclasses: {\n      \"Alchemist\": {\n        15: [\n          {\n            name: \"Chemical Mastery\",\n            level: \"resistance\",\n            type: \"damage\",\n            value: \"acid\"\n          },\n          {\n            name: \"Chemical Mastery\",\n            level: \"resistance\",\n            type: \"damage\",\n            value: \"poison\"\n          },\n          {\n            name: \"Chemical Mastery\",\n            level: \"immunity\",\n            type: \"condition\",\n            value: \"poisoned\"\n          }\n        ]\n      }\n    }\n  }\n};\n","import { PolymerElement, html } from \"@polymer/polymer\";\nimport { MutableData } from '@polymer/polymer/lib/mixins/mutable-data.js';\nimport { getCharacterChannel, getSelectedCharacter, getClassReferences, setClassLevels, mergeSubclass, setClassSkillProficiencies, getSubclassChoiceLevel, mergeFeature, setSubclassChoice, setClassChoice, getSubclassChoice, getClassChoice, getHPRollForClassLevel, getHPDiceForLevel, setHpRoll, getClassString } from \"../../../util/charBuilder\";\nimport \"@vaadin/vaadin-grid\";\nimport \"../../dnd-select-add\";\nimport \"../../dnd-switch\";\nimport \"../../dnd-button\";\nimport \"../../dnd-asi-select\";\nimport \"../../dnd-svg\";\nimport { jqEmpty, getEntryName } from \"../../../js/utils\";\nimport { classOptionsMap } from \"../../../data/choices\";\nimport EntryRenderer from \"../../../util/entryrender\";\nimport { } from '@polymer/polymer/lib/elements/dom-if.js';\nimport { } from '@polymer/polymer/lib/elements/dom-repeat.js';\nimport { getEditModeChannel, isEditMode } from \"../../../util/editMode\";\nimport {filterModel} from \"../../../util/data\";\nimport '@vaadin/vaadin-text-field/vaadin-integer-field'\n\nclass DndCharacterBuilderClass extends MutableData(PolymerElement) {\n  \n  static get properties() {\n    return {\n      levels: {\n        type: Array,\n        value: []\n      },\n      classes: {\n        type: Object,\n      },\n      subclasses: {\n        type: Object,\n        value: undefined\n      },\n      noContentMessage: {\n        type: Boolean,\n        value: false\n      },\n      isEditMode: {\n        type: Boolean,\n        value: false\n      }\n    };\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n\n    this.characterChangeHandler = (e) => {\n      let character = e.detail.character;\n      this.updateFromCharacter(character);\n    };\n    \n    this.updateFromCharacter(getSelectedCharacter());\n    getCharacterChannel().addEventListener(\"character-selected\", this.characterChangeHandler);\n\n    this.editModeHandler = (e) => {\n      this.isEditMode = e.detail.isEditMode;\n      this.$.classGrid.notifyResize();\n    }\n    getEditModeChannel().addEventListener('editModeChange', this.editModeHandler);\n    this.isEditMode = isEditMode();\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n\n    getCharacterChannel().removeEventListener(\"character-selected\", this.characterChangeHandler);\n    getEditModeChannel().removeEventListener('editModeChange', this.editModeHandler);\n  }\n\n  ready() {\n    super.ready();\n\n    const renderer = new EntryRenderer();\n\n    setTimeout(() => {\n      const grid = this.$.classGrid;\n      let draggedItem;\n\n      grid.rowDetailsRenderer = ((root, grid, rowData) => {\n        let renderStack = [],\n          features = this._getClassLevelFeatures(this.levels, rowData.index, this.classes, this.subclasses);\n        \n        if (features && features.length) {\n          if (!root.firstElementChild) {\n            root.innerHTML = '<div class=\"details stats-wrapper \"></div>';\n          }\n\n          for (let feature of features) {\n            renderer.recursiveEntryRender(\n              feature,\n              renderStack,\n              0,\n              undefined,\n              true\n            );\n          }\n          const deets = root.querySelector('.details');\n          jqEmpty(deets);\n          deets.innerHTML = renderStack.join(\"\");\n        }\n      }).bind(this);\n\n      grid.addEventListener('grid-dragstart', function(e) {\n        draggedItem = e.detail.draggedItems[0];\n        grid.dropMode = 'between';\n      });\n\n      grid.addEventListener('grid-dragend', function(e) {\n        draggedItem = grid.dropMode = null;\n      });\n\n      grid.addEventListener('grid-drop', function(e) {\n        const dropTargetItem = e.detail.dropTargetItem;\n        if (draggedItem && draggedItem !== dropTargetItem) {\n          // Reorder the items\n          const items = grid.items.filter(function(i) {\n            return i !== draggedItem;\n          });\n          const dropIndex = items.indexOf(dropTargetItem)\n            + (e.detail.dropLocation === 'below' ? 1 : 0);\n          items.splice(dropIndex, 0, draggedItem);\n          setClassLevels(items);\n        }\n      });\n    }, 0);\n  }\n\n  async updateFromCharacter(character) {\n    if (character && character.levels && character.levels.length) {\n      this.noContentMessage = false;\n      this.character = character;\n      this.classes = await getClassReferences(character);\n      this.subclasses = JSON.parse(JSON.stringify(character.subclasses));\n      this.classLevel = getClassString(character);\n      this.classChoices = await this._findLevelChoices(character, this.classes);\n\n      this.dispatchEvent(new CustomEvent(\"loadingChange\", { bubbles: true, composed: true }));\n\n      this.levels = character.levels;\n\n      const hitDiceMaxes = [];\n      for (let i = 0; i < character.levels.length; i++) {\n        hitDiceMaxes.push(await getHPDiceForLevel(i));\n      }\n      this.hitDiceMaxes = hitDiceMaxes;\n\n      this.$.classGrid.clearCache();\n    } else {\n      this.noContentMessage = true;\n      this.dispatchEvent(new CustomEvent(\"loadingChange\", { bubbles: true, composed: true }));\n      this.$.classGrid.clearCache();\n    }\n  }\n\n  _getClassLevelFeatures(levels, index, classes, subclasses) {\n    if (classes && levels[index] && subclasses) {\n      const className = levels[index].name;\n      const classRef = classes[className];\n\n      if (classRef) {\n        const classFeatures = classRef.classFeatures;\n        let levelsInClass = -1;\n        let levelsInSubclass = -1;\n\n        if (levels.length >= index + 1) {\n          for (let i = 0; i <= index; i ++) {\n            if (levels[i].name === className) {\n              levelsInClass ++;\n\n              const classFeaturesForLevel = classFeatures[levelsInClass];\n              if (classFeaturesForLevel) {\n                const hasSubclassFeature = classFeaturesForLevel.find(i => i.gainSubclassFeature);\n                if (hasSubclassFeature) {\n                  levelsInSubclass ++;\n                }\n              }\n            }\n          }\n\n          const classFeaturesForLevel = classFeatures[levelsInClass];\n          if (classFeaturesForLevel) {\n            const hasSubclassFeature = classFeaturesForLevel.some(i => i.gainSubclassFeature);\n            if (hasSubclassFeature && subclasses && subclasses[className] && classRef.subclasses && classRef.subclasses.length) {\n              const subclassDef = classRef.subclasses.find(i => subclasses[className].name === i.name);\n              if (subclassDef && subclassDef.subclassFeatures[levelsInSubclass]) {\n                subclassDef.subclassFeatures[levelsInSubclass].map((i) => { i.isSubclass = true; return i; })\n                return [...classFeaturesForLevel].concat(subclassDef.subclassFeatures[levelsInSubclass]);\n              }\n            }\n            return classFeaturesForLevel.filter((feature) => { \n              const name = getEntryName(feature);\n              return name !== 'Proficiency Versatility' && name !== 'Martial Versatility';\n            });\n          }\n        }\n      }\n    }\n  }\n\n  _getClassLevelFeatureStringArray(levels, index, classes, subclasses) {\n    if (levels && index !== undefined && classes && subclasses) {\n      const classLevelFeatures = this._getClassLevelFeatures(levels, index, classes, subclasses);\n\n      if (classLevelFeatures) {\n        return classLevelFeatures.map(f => {\n          return { name: getEntryName(f), isSubclass: f.isSubclass };\n        });\n      }\n    }\n  }\n\n  _level(index) {\n    return index + 1;\n  }\n\n  _deleteLevel(e) {\n    let index = e.model.__data.index;\n    this.levels.splice(index, 1);\n    setClassLevels(this.levels);\n  }\n\n  _expandDetails(e) {\n    let data = e.model.__data.item,\n      stayClosed = this.$.classGrid.detailsOpenedItems.indexOf(data) > -1;\n\n    for (let item of this.$.classGrid.detailsOpenedItems) {\n      this.$.classGrid.closeItemDetails(item);\n    }\n\n    if (stayClosed) {\n      this.$.classGrid.closeItemDetails(data);\n    } else {\n      this.$.classGrid.openItemDetails(data);\n    }\n    this.$.classGrid.notifyResize();\n  }\n\n  async _findLevelChoices(character, classes) {\n    const levelChoices = [];\n    if (character && character.levels && character.levels.length) {\n      for (let i = 0; i < character.levels.length; i++) {\n        levelChoices.push(await this._findChoices(character, classes, i));\n      }\n    }\n    return levelChoices;\n  }\n\n  async _findChoices(character, classes, levelIndex) {\n    if (classes && character.levels && character.levels.length && character.levels.length > levelIndex) {\n      let levels = character.levels,\n        subclasses = character.subclasses,\n        name = levels[levelIndex].name,\n        classDef = classes[name];\n\n      if (classDef) {\n        let choices = [],\n          classLevelCount = 0,\n          subclassChoiceLevel = getSubclassChoiceLevel(classDef);\n\n        for (let i = 0; i <= levelIndex; i++) {\n          let level = levels[i]\n          if (level.name === name) {\n            classLevelCount ++;\n          }\n        }\n\n        if (subclassChoiceLevel !== undefined && classLevelCount === subclassChoiceLevel) {\n          choices.push({\n            id: \"subclass\",\n            from: classDef.subclasses,\n            selections: character.subclasses[name]\n          });\n        }\n\n        let features = this._getClassLevelFeatures(levels, levelIndex, classes, subclasses);\n        if (features && features.length\n            && features.find((f) => { return f.name === \"Ability Score Improvement\"; })) {\n          choices.push({\n            id: \"asi\"\n          });\n        }\n\n        if (levelIndex === 0) {\n          const classSkillOptions = classDef.startingProficiencies.skills[0].choose;\n          choices.push({\n            id: \"profs\",\n            count: classSkillOptions.count,\n            from: classSkillOptions.from,\n            selections: character.classSkillProficiencies\n          });\n        }\n\n        if (classLevelCount) {\n          const classOptions = classOptionsMap[name.toLowerCase()];\n\n          if (classOptions && classOptions.class && classOptions.class[classLevelCount]) {\n            const classLevelOptions = [].concat(classOptions.class[classLevelCount]);\n            \n            for (const classLevelOption of classLevelOptions) {\n              if (classLevelOption.options) {\n                choices.push({\n                  id: \"classFeature\",\n                  name: classLevelOption.name,\n                  from: classLevelOption.options,\n                  count: classLevelOption.count > 1 ? classLevelOption.count : undefined,\n                  class: name.toLowerCase(),\n                  feature: classLevelOption.name,\n                  level: classLevelCount,\n                  selections: getClassChoice(name.toLowerCase(), classLevelCount, classLevelOption.name)\n                });\n              } else if (classLevelOption.type) {\n                const options = await filterModel(\"features\", classLevelOption.type);\n                choices.push({\n                  id: \"classFeature\",\n                  name: classLevelOption.name,\n                  from: options,\n                  count: classLevelOption.count > 1 ? classLevelOption.count : undefined,\n                  class: name.toLowerCase(),\n                  feature: classLevelOption.name,\n                  level: classLevelCount,\n                  selections: getClassChoice(name.toLowerCase(), classLevelCount, classLevelOption.name)\n                });\n              }\n            }\n          }\n\n          if (classOptions && classOptions.subclasses && subclasses[name] && classOptions.subclasses[subclasses[name].name] && classOptions.subclasses[subclasses[name].name][classLevelCount]) {\n            const subclassLevelOptions = [].concat(classOptions.subclasses[subclasses[name].name][classLevelCount]);\n            \n            for (const subclassLevelOption of subclassLevelOptions) {\n              if (subclassLevelOption.options) {\n                choices.push({\n                  id: \"subclassFeature\",\n                  name: subclassLevelOption.name,\n                  from: subclassLevelOption.options,\n                  count: subclassLevelOption.count > 1 ? subclassLevelOption.count : undefined,\n                  class: name.toLowerCase(),\n                  subclass: subclasses[name],\n                  feature: subclassLevelOption.name,\n                  level: classLevelCount,\n                  selections: getSubclassChoice(name.toLowerCase(), subclasses[name].name.toLowerCase(), classLevelCount, subclassLevelOption.name)\n                });\n              } else if (subclassLevelOption.type) {\n                const options = await filterModel(\"features\", subclassLevelOption.type);\n                choices.push({\n                  id: \"subclassFeature\",\n                  name: subclassLevelOption.name,\n                  from: options,\n                  count: subclassLevelOption.count > 1 ? subclassLevelOption.count : undefined,\n                  class: name.toLowerCase(),\n                  subclass: subclasses[name],\n                  feature: subclassLevelOption.name,\n                  level: classLevelCount,\n                  selections: getSubclassChoice(name.toLowerCase(), subclasses[name].name.toLowerCase(), classLevelCount, subclassLevelOption.name)\n                });\n              }\n            }\n          }\n        }\n\n        return choices;\n      }\n    }\n    return [];\n  }\n\n  _equal(a, b) {\n    return a === b;\n  }\n\n  _genSubclassCallback(level) {\n    return (subclass) => {\n      mergeSubclass(undefined, level.name, subclass);\n    }\n  }\n\n  _genSubclassOptions(level) {\n    return this.classes[level.name].subclasses;\n  }\n\n  _getSubclassSelection(level, subclasses) {\n    return subclasses[level.name];\n  }\n\n  _classFeatureOptionAddCallback(classs, level, feature) {\n    return (choice) => {\n      let adjChoice;\n      if (Array.isArray(choice)) {\n        adjChoice = choice.map(c => {\n          if (c.name) {\n            return { name: c.name, source: c.source }\n          } else {\n            return c;\n          }\n        });\n      } else if (choice.name) {\n        adjChoice = { name: choice.name, source: choice.source };\n      } else {\n        adjChoice = choice;\n      }\n      setClassChoice(classs, level, feature, adjChoice);\n    };\n  }\n\n  _subclassFeatureOptionAddCallback(classs, subclass, level, feature) {\n    return (choice) => {\n      let adjChoice;\n      if (Array.isArray(choice)) {\n        adjChoice = choice.map(c => {\n          if (c.name) {\n            return { ...c }\n          } else {\n            return c;\n          }\n        });\n      } else if (choice.name) {\n        adjChoice = { ...choice };\n      } else {\n        adjChoice = choice;\n      }\n      setSubclassChoice(classs, subclass.name.toLowerCase(), level, feature, adjChoice);\n    };\n  }\n\n  _indexOfLevel(level, levels) {\n    return levels.indexOf(level);\n  }\n\n  _isMobile() {\n    return window.innerWidth < 921;\n  }\n\n  _objArray(obj) {\n    return Object.values(obj);\n  }\n\n  _atIndex(data, index) {\n    return data ? data[index] : null;\n  }\n\n  _svgFromClass(className) {\n    return className ? className.replace(/(\\s|\\(|\\))/g, \"\") : '';\n  }\n\n  _addClassLevel(e) {\n    mergeFeature(undefined, e.model.item, \"classes\");\n  }\n\n  _classSkillAddCallback(skills) {\n    setClassSkillProficiencies(skills);\n  }\n\n  _levelHp(className, index) {\n    return getHPRollForClassLevel(className, index + 1);\n  }\n\n  _editModeClass(isEditMode) {\n    return isEditMode ? 'edit-mode' : 'not-edit-mode';\n  }\n\n  _toggleHpField(e) {\n    const element = e.target.closest('.btn-field');\n    const isOpen = element.classList.contains('btn-field--open');\n    const intField = element.querySelector('vaadin-integer-field');\n    const level = parseInt(element.dataset.level) + 1;\n    const className = element.dataset.className;\n    const max = parseInt(element.dataset.max);\n  \n    if (isOpen) {\n      const changeVal = parseInt(intField.value);\n      if (changeVal && changeVal <= max && changeVal > 0) {\n        setHpRoll(className, level, changeVal);\n        intField.value = '';\n        element.classList.toggle('btn-field--open');\n      } else {\n        element.classList.add('btn-field--error');\n        setTimeout(() => {\n          element.classList.remove('btn-field--error');\n        }, 500);\n      }\n    } else {\n      element.classList.toggle('btn-field--open');\n      intField.focus();\n    }\n  }\n\n  _levelHitDice(index, maxes) {\n    if (maxes && index !== undefined && maxes[index]) {\n      return maxes[index];\n    }\n  }\n\n  static get template() {\n    return html`\n      <style include=\"material-styles my-styles\">\n        .something {\n          display: block;\n        }\n\n        #classGrid {\n          margin-bottom: 144px;\n        }\n\n        .heading-wrap {\n          display: flex;\n          justify-content: space-between;\n          margin: 22px 14px 12px;\n          align-items: center;\n          border-bottom: 1px solid var(--lumo-contrast-10pct);\n          flex-wrap: wrap;\n        }\n        .heading {\n          width: 100%;\n          display: flex;\n          flex-direction: row;\n          align-items: center;\n          justify-content: space-between;\n        }\n        .class-levels {\n          font-size: 16px;\n          padding-left: 8px;\n          font-weight: normal;\n          display: none;\n        }\n\n        h2 {\n          margin-bottom: 24px;\n          display: block;\n          font-size: 1.5em;\n          margin: 20px 0;\n          font-weight: bold;\n        }\n\n        .not-edit-mode .button-wrap {\n          display: none;\n        }\n\n        .button-wrap {\n          display: flex;\n          flex-wrap: wrap;\n          align-items: center;\n          padding: 10px;\n          width: 100%;\n        }\n        .button-wrap > * {\n          margin: 4px;\n        }\n\n        .row {\n          position: relative;\n          min-height: 80px;\n          padding: 12px 0 12px;\n        }\n        .row:after {\n          content: \"\";\n          display: table;\n          clear: both;\n        }\n\n        .open-details {\n          cursor: pointer;\n          display: flex;\n          align-items: flex-start;\n          flex-wrap: wrap;\n        }\n        .open-details:hover .level-col {\n          color: var(--mdc-theme-secondary);\n        }\n\n        .level-col {\n          width: calc(100% - 70px);\n          text-overflow: ellipsis;\n          white-space: nowrap;\n          overflow: hidden;\n          flex-shrink: 0;\n          padding: 6px 0;\n        }\n        .level-col__level {\n          margin-right: 10px;\n          font-size: 20px;\n          font-weight: bold;\n        }\n        .level-col__image-wrap {\n          width: 30px;\n          position: relative;\n          height: 21px;\n          display: inline-block;\n        }\n        .level-col__image {\n          width: 30px;\n          height: 30px;\n          display: block;\n          position: absolute;\n          top: -1px;\n        }\n        .level-col__class {\n          font-size: 20px;\n          font-weight: bold;\n        }\n\n        .features-col {\n          white-space: normal;\n          width: 100%;\n          margin: 0;\n          padding: 16px 0 8px;\n          font-size: 15px;\n        }\n        .class-feature:not(:last-of-type)::after {\n          content: ', ';\n        }\n        .class-feature[subclass] {\n          color: var(--mdc-theme-secondary);\n        }\n\n        .choices-col {\n          display: flex;\n          float: left;\n          flex-wrap: wrap;\n          width: 100%;\n          padding-left: 30px;\n        }\n        .choices-col__choice {\n          margin-right: 16px;\n          width: 100%;\n        }\n        .choices-col__choice dnd-select-add {\n          min-width: 250px;\n          width: calc(100% - 20px);\n        }\n\n        @media(min-width: 420px) {\n          .choices-col__choice dnd-select-add {\n            width: calc(50% - 20px);\n          }\n        }\n\n        .choices-col__subclass-choice {\n          display: block;\n        }\n\n        .delete-col {\n          margin-right: 16px;\n        }\n        .delete-btn {\n          height: 24px;\n          width: 24px;\n          font-size: 18px;\n          padding: 0;\n          margin-right: 16px;\n          background: none !important;\n        }\n        .delete-btn:before,\n        .delete-btn:after {\n          background: none !important;\n        }\n        .delete-btn:hover {\n          color: var(--mdc-theme-secondary);\n        }\n        .not-edit-mode .delete-btn {\n          display: none;\n        }\n        \n\n        .btn-field {\n          display: inline-flex;\n          flex-direction: row;\n          flex-wrap: nowrap;\n          margin-bottom: 16px;\n          width: 80px;\n          height: 36px;\n          background: var(--lumo-contrast-10pct);\n          border-radius: 4px;\n        }\n        .btn-field--error {\n          background: var(--lumo-error-color-50pct);\n        }\n        .btn-field__btn {\n          display: block;\n          width: 100%;\n        }\n        .btn-field__input {\n          display: none;\n        }\n        .btn-field--open .btn-field__btn {\n          width: 40px;\n        }\n        .btn-field__btn-label-text {\n          position: relative;\n          left: 4px;\n          bottom: 2px;\n        }\n        .btn-field--open .btn-field__btn-label-text {\n          display: none;\n        }\n        .btn-field--open .btn-field__input {\n          display: block;\n          width: 40px;\n          margin-top: -40px;\n        }\n        .btn-field--open .btn-field__btn-label {\n          margin-left: -20px;\n        }\n        .btn-field vaadin-integer-field {\n          --lumo-contrast-10pct: transparent;\n        }\n\n\n        .hp-col {\n          position: absolute;\n          right: 0;\n          top: 8px;\n          overflow: hidden;\n          display: flex;\n        }\n        .not-edit-mode .hp-col {\n          right: 0px;\n        }\n        .hp-col .material-icons {\n          font-size: 20px;\n          position: relative;\n          margin-right: 8px;\n          top: 3px;\n        }\n        .hp-col__non-edit {\n          display: block;\n        }\n        .hp-col .hp-col__non-edit .hp-roll-icon {\n          left: 33px;\n        }\n        .edit-mode .hp-col__non-edit {\n          display: none;\n        }\n        .hp-col__edit {\n          display: none;\n        }\n        .edit-mode .hp-col__edit {\n          display: inline-flex;\n        }\n        .hp-col .hp-roll-icon {\n          position: absolute;\n          left: 18px;\n          font-size: 11px;\n          top: 1px;\n        }\n        .edit-mode .hp-roll-icon {\n          left: 36px;\n          top: 5px;\n        }\n        .btn-field--open .hp-roll-icon {\n          left: 26px;\n        }\n\n        .details {\n          font-size: 15px;\n          width: calc(100% - 30px);\n          margin: 0 auto 13px !important;\n          background: var(--lumo-contrast-10pct);\n          border-radius: 4px;\n          white-space: pre-line;\n          padding: 14px 14px 1px;\n        }\n        .details > .statsBlockHead:first-child > .stat-name {\n          margin-top: 0;\n        }\n\n        @media(min-width: 921px) {\n          .features-col {\n            margin: 0 30px 0 12px;\n            width: unset;\n            font-size: 16px;\n          }\n          #classGrid {\n            margin-bottom: 0;\n          }\n          .class-levels {\n            display: inline;\n          }\n        }\n\n        .no-content-message {\n          padding: 20px;\n          font-size: 14px;\n          font-style: italic;\n        }\n      </style>\n\n      <div class$=\"[[_editModeClass(isEditMode)]]\">\n        <div class=\"heading-wrap\">\n          <h2>Levels <span class=\"class-levels\">[[classLevel]]</span></h2> \n          <dnd-select-add model=\"class-all\" placeholder=\"Add a Class\"></dnd-select-add>\n\n          <div class=\"button-wrap\">\n            <template is=\"dom-repeat\" items=\"[[_objArray(classes)]]\">\n              <dnd-button icon=\"add\" label=\"[[item.name]]\" on-click=\"_addClassLevel\"></dnd-button>\n            </template>\n          </div>\n        </div>\n\n        <div>\n          <div class=\"no-content-message\" hidden$=\"[[!noContentMessage]]\">Enter edit mode to add classes and levels.</div>\n\n          <vaadin-grid id=\"classGrid\" items=[[levels]] theme=\"no-border\" height-by-rows>\n            <vaadin-grid-column flex-grow=\"1\">\n              <template>\n                <div class=\"row\">\n                  <div class=\"open-details\" on-click=\"_expandDetails\">\n                    <div class=\"level-col\">\n                      <span class=\"level-col__level\">[[_level(index)]]</span>\n                      <span class=\"level-col__image-wrap\" ><dnd-svg class=\"level-col__image\" default-color id=\"[[_svgFromClass(item.name)]]\"></dnd-svg></span>\n                      <span class=\"level-col__class\">[[item.name]]</span>\n                    </div>\n\n                    <div class=\"features-col\">\n                      <template is=\"dom-repeat\" items=\"[[_getClassLevelFeatureStringArray(levels, index, classes, subclasses)]]\">\n                        <span class=\"class-feature\" subclass$=\"[[item.isSubclass]]\">[[item.name]]</span>\n                      </template>\n                    </div>\n                  </div>\n\n                  <div class=\"choices-col\">\n                    <template is=\"dom-repeat\" items=\"[[_atIndex(classChoices, index)]]\" as=\"choice\">\n                      <div class=\"choices-col__choice\">\n                        <template is=\"dom-if\" if=\"[[_equal(choice.id, 'subclass')]]\">\n                          <dnd-select-add class=\"choices-col__subclass-choice\" label=\"Subclass\" placeholder=\"<Choose Subclass>\" disabled$=\"[[!isEditMode]]\"\n                            options=\"[[choice.from]]\" value=\"[[choice.selections]]\" add-callback=\"[[_genSubclassCallback(item)]]\"></dnd-select-add>\n                        </template>\n                        <template is=\"dom-if\" if=\"[[_equal(choice.id, 'asi')]]\">\n                          <dnd-asi-select level-index=\"[[_indexOfLevel(item, levels)]]\" character=\"[[character]]\" disabled$=\"[[!isEditMode]]\"></dnd-asi-select>\n                        </template>\n                        <template is=\"dom-if\" if=\"[[_equal(choice.id, 'profs')]]\">\n                          <dnd-select-add choices=\"[[choice.count]]\" label=\"Skill Proficiency\" placeholder=\"<Choose Skills>\" disabled$=\"[[!isEditMode]]\"\n                            options=\"[[choice.from]]\" value=\"[[choice.selections]]\" add-callback=\"[[_classSkillAddCallback]]\"></dnd-select-add>\n                        </template>\n                        <template is=\"dom-if\" if=\"[[_equal(choice.id, 'classFeature')]]\">\n                          <dnd-select-add choices=\"[[choice.count]]\" label=\"[[choice.name]]\" placeholder=\"<Choose Option>\" disabled$=\"[[!isEditMode]]\"\n                            options=\"[[choice.from]]\" value=\"[[choice.selections]]\" add-callback=\"[[_classFeatureOptionAddCallback(choice.class, choice.level, choice.feature)]]\"></dnd-select-add>\n                        </template>\n                        <template is=\"dom-if\" if=\"[[_equal(choice.id, 'subclassFeature')]]\">\n                          <dnd-select-add choices=\"[[choice.count]]\" label=\"[[choice.name]]\" placeholder=\"<Choose Option>\" disabled$=\"[[!isEditMode]]\"\n                            options=\"[[choice.from]]\" value=\"[[choice.selections]]\" add-callback=\"[[_subclassFeatureOptionAddCallback(choice.class, choice.subclass, choice.level, choice.feature)]]\"></dnd-select-add>\n                        </template>\n                      </div>\n                    </template>\n                  </div>\n\n                  <div class=\"hp-col\">\n                    <div class=\"delete-col\">\n                      <button class=\"delete-btn mdc-icon-button material-icons \"on-click=\"_deleteLevel\">delete</button>\n                    </div>\n                    <div class=\"hp-col__non-edit\">\n                      <span class=\"material-icons \" aria-hidden=\"true\">casino</span>\n                      <span class=\"material-icons hp-roll-icon\" aria-hidden=\"true\">favorite</span>\n                      [[_levelHp(item.name, index)]]\n                    </div>\n                    <div class=\"hp-col__edit btn-field\" data-max$=\"[[_levelHitDice(index, hitDiceMaxes)]]\" data-level$=\"[[index]]\" data-class-name$=\"[[item.name]]\">\n                      <dnd-button background=\"none\" class=\"btn-field__btn\" on-click=\"_toggleHpField\">\n                        <span class=\"btn-field__btn-label\" slot=\"label\">\n                          <span class=\"material-icons \" aria-hidden=\"true\">casino</span>\n                          <span class=\"material-icons hp-roll-icon\" aria-hidden=\"true\">favorite</span>\n                          <span class=\"btn-field__btn-label-text\">[[_levelHp(item.name, index)]]</span>\n                        </span>\n                      </dnd-button>\n                      <vaadin-integer-field class=\"btn-field__input\" min=\"1\" max=\"[[_levelHitDice(index, hitDiceMaxes)]]\"></vaadin-integer-field>\n                    </div>\n                  </div>\n                </div>\n              </template>\n            </vaadin-grid-column>\n          </vaadin-grid>\n        </div>\n      </div>\n    `;\n  }\n}\n\ncustomElements.define(\"dnd-character-builder-class\", DndCharacterBuilderClass);"],"sourceRoot":""}